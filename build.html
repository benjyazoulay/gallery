<!DOCTYPE html>
<html>
  <head>
    <title>Babel Virtual Gallery</title>
    <meta name="description" content="Explore the Gallery of Babel">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <script>!function(){var t=function(t){var e;return function(n){return e||t(e={exports:{},parent:n},e.exports),e.exports}},e=t((function(t,e){"use strict";var n=u(h),r=u(l);console.log("auth.js charg\xe9");var i,o=Ln.auth,a=(i=(0,r.default)(n.default.mark((function t(){var e,r,i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Tentative de connexion..."),e=new dt.auth.GoogleAuthProvider,t.prev=2,t.next=5,o.signInWithPopup(e);case 5:r=t.sent,console.log("Utilisateur connect\xe9 !"),(i=r.user)&&console.log("Email de l'utilisateur:",i.email),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error("Erreur de connexion:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[2,11]])}))),function(){return i.apply(this,arguments)});t.exports={handleLogin:a}})),n=t((function(t,e){(function(e,n){(function(){"use strict";var o;t.exports=d,d.ReadableState=p,Xr.EventEmitter;var a=function(t,e){return t.listeners(e).length},s=Ti.Buffer,u=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},c=Object.create(Ni);c.inherits=ci;var f,h=void 0;h=Li&&Li.debuglog?Li.debuglog("stream"):function(){},c.inherits(d,pi);var l=["error","close","destroy","pause","resume"];function p(t,e){t=t||{};var n=e instanceof(o=o||i({}));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var a=t.highWaterMark,s=t.readableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:n&&(s||0===s)?s:u,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new Ri,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=r({}).StringDecoder),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function d(t){if(o=o||i({}),!(this instanceof d))return new d(t);this._readableState=new p(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),pi.call(this)}function v(t,e,n,r,i){var o,a=t._readableState;return null===e?(a.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,m(t)}}(t,a)):(i||(o=function(t,e){var n,r;return r=e,s.isBuffer(r)||r instanceof u||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===s.prototype||(e=function(t){return s.from(t)}(e)),r?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):g(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?g(t,a,e,!1):w(t,a)):g(t,a,e,!1))):r||(a.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function g(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&m(t)),w(t,e)}Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),d.prototype.destroy=Pi.destroy,d.prototype._undestroy=Pi.undestroy,d.prototype._destroy=function(t,e){this.push(null),e(t)},d.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=s.from(t,e),e=""),n=!0),v(this,t,e,!1,n)},d.prototype.unshift=function(t){return v(this,t,null,!0,!1)},d.prototype.isPaused=function(){return!1===this._readableState.flowing},d.prototype.setEncoding=function(t){return f||(f=r({}).StringDecoder),this._readableState.decoder=new f(t),this._readableState.encoding=t,this};function y(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function m(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(h("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?fi.nextTick(b,t):b(t))}function b(t){h("emit readable"),t.emit("readable"),T(t)}function w(t,e){e.readingMore||(e.readingMore=!0,fi.nextTick(_,t,e))}function _(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(h("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function E(t){h("readable nexttick read 0"),t.read(0)}function I(t,e){e.reading||(h("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),T(t),e.flowing&&!e.reading&&t.read(0)}function T(t){var e=t._readableState;for(h("flow",e.flowing);e.flowing&&null!==t.read(););}function A(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;for(t-=i.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?i+=o:i+=o.slice(0,t),0==(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=s.allocUnsafe(t),r=e.head,i=1;for(r.data.copy(n),t-=r.data.length;r=r.next;){var o=r.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0==(t-=a)){a===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(a));break}++i}return e.length-=i,n}(t,e),r}(t,e.buffer,e.decoder),n);var n}function x(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,fi.nextTick(S,e,t))}function S(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function k(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}d.prototype.read=function(t){h("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return h("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?x(this):m(this),null;if(0===(t=y(t,e))&&e.ended)return 0===e.length&&x(this),null;var r,i=e.needReadable;return h("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&h("length less than watermark",i=!0),e.ended||e.reading?h("reading or ended",i=!1):i&&(h("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=y(n,e))),null===(r=t>0?A(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&x(this)),null!==r&&this.emit("data",r),r},d.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},d.prototype.pipe=function(t,n){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,h("pipe count=%d opts=%j",i.pipesCount,n);var o=n&&!1===n.end||t===e.stdout||t===e.stderr?g:s;function s(){h("onend"),t.end()}i.endEmitted?fi.nextTick(o):r.once("end",o),t.on("unpipe",(function e(n,o){h("onunpipe"),n===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,h("cleanup"),t.removeListener("close",d),t.removeListener("finish",v),t.removeListener("drain",u),t.removeListener("error",p),t.removeListener("unpipe",e),r.removeListener("end",s),r.removeListener("end",g),r.removeListener("data",l),c=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||u())}));var u=function(t){return function(){var e=t._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,T(t))}}(r);t.on("drain",u);var c=!1,f=!1;function l(e){h("ondata"),f=!1,!1!==t.write(e)||f||((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==k(i.pipes,t))&&!c&&(h("false write response, pause",i.awaitDrain),i.awaitDrain++,f=!0),r.pause())}function p(e){h("onerror",e),g(),t.removeListener("error",p),0===a(t,"error")&&t.emit("error",e)}function d(){t.removeListener("finish",v),g()}function v(){h("onfinish"),t.removeListener("close",d),g()}function g(){h("unpipe"),r.unpipe(t)}return r.on("data",l),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener("error",n);t._events&&t._events.error?li(t._events.error)?t._events.error.unshift(n):t._events.error=[n,t._events.error]:t.on("error",n)}(t,0,p),t.once("close",d),t.once("finish",v),t.emit("pipe",r),i.flowing||(h("pipe resume"),r.resume()),t},d.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=k(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},d.prototype.on=function(t,e){var n=pi.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&m(this):fi.nextTick(E,this))}return n},d.prototype.addListener=d.prototype.on,d.prototype.resume=function(){var t=this._readableState;return t.flowing||(h("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,fi.nextTick(I,t,e))}(this,t)),this},d.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},d.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){h("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<l.length;o++)t.on(l[o],this.emit.bind(this,l[o]));return this._read=function(e){h("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(d.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),d._fromList=A}).call(this)}).call(this,bt,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})})),r=t((function(t,e){"use strict";var n=Ti.Buffer,r=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=s,this.end=u,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=c,this.end=f,e=3;break;default:return this.write=h,void(this.end=l)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"\ufffd";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\ufffd";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\ufffd"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function s(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function c(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function l(t){return t&&t.length?this.write(t):""}e.StringDecoder=i,i.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},i.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\ufffd":e},i.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=o(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=o(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=o(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},i.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}})),i=t((function(t,e){"use strict";var r=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=h;var i=Object.create(Ni);i.inherits=ci;var a=n({}),s=o({});i.inherits(h,a);for(var u=r(s.prototype),c=0;c<u.length;c++){var f=u[c];h.prototype[f]||(h.prototype[f]=s.prototype[f])}function h(t){if(!(this instanceof h))return new h(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",l)}function l(){this.allowHalfOpen||this._writableState.ended||fi.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),h.prototype._destroy=function(t,e){this.push(null),this.end(),fi.nextTick(e,t)}})),o=t((function(t,e){(function(e,n,r){(function(){"use strict";function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(void 0),r=r.next}e.corkedRequestsFree.next=t}(e,t)}}t.exports=v;var a,s=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:fi.nextTick;v.WritableState=d;var u=Object.create(Ni);u.inherits=ci;var c,f={deprecate:Mi},h=Ti.Buffer,l=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};function p(){}function d(t,e){a=a||i({}),t=t||{};var n=e instanceof a;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,u=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(u||0===u)?u:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===t.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(fi.nextTick(i,r),fi.nextTick(_,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),_(t,e))}(t,n,r,e,i);else{var o=b(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||m(t,n),r?s(y,t,n,o,i):y(t,n,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function v(t){if(a=a||i({}),!(c.call(v,this)||this instanceof a))return new v(t);this._writableState=new d(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),pi.call(this)}function g(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function y(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),_(t,e)}function m(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),a=e.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,g(t,e,!0,e.length,i,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,f=n.encoding,h=n.callback;if(g(t,e,!1,e.objectMode?1:c.length,c,f,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function b(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function w(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),_(t,e)}))}function _(t,e){var n=b(e);return n&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,fi.nextTick(w,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}u.inherits(v,pi),d.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(d.prototype,"buffer",{get:f.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!c.call(this,t)||this===v&&t&&t._writableState instanceof d}})):c=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,n){var r,i=this._writableState,o=!1,a=!i.objectMode&&(r=t,h.isBuffer(r)||r instanceof l);return a&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(n=e,e=null),a?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=p),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),fi.nextTick(e,n)}(this,n):(a||function(t,e,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),fi.nextTick(r,o),i=!1),i}(this,i,t,n))&&(i.pendingcb++,o=function(t,e,n,r,i,o){if(!n){var a=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n)),e}(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else g(t,e,!1,s,r,i,o);return u}(this,i,a,t,e,n)),o},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||m(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||function(t,e,n){e.ending=!0,_(t,e),n&&(e.finished?fi.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=Pi.destroy,v.prototype._undestroy=Pi.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this)}).call(this,bt,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a({}).setImmediate)})),a=t((function(t,e){(function(t,n){(function(){var r=bt.nextTick,i=(Function.prototype.apply,Array.prototype.slice),o={},a=0;function s(t,e){this._id=t,this._clearFn=e}s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.setImmediate="function"==typeof t?t:function(t){var n=a++,s=!(arguments.length<2)&&i.call(arguments,1);return o[n]=!0,r((function(){o[n]&&(s?t.apply(null,s):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof n?n:function(t){delete o[t]}}).call(this)}).call(this,a({}).setImmediate,a({}).clearImmediate)})),s=t((function(t,e){(function(t){(function(){"use strict";e.Buffer=n,e.SlowBuffer=function(t){return+t!=t&&(t=0),n.alloc(+t)},e.INSPECT_MAX_BYTES=50;function t(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=n.prototype,e}function n(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return o(t)}return r(t,e,n)}function r(e,r,i){if("string"==typeof e)return function(e,r){if("string"==typeof r&&""!==r||(r="utf8"),!n.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=0|u(e,r),o=t(i),a=o.write(e,r);return a!==i&&(o=o.slice(0,a)),o}(e,r);if(ArrayBuffer.isView(e))return a(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(P(e,ArrayBuffer)||e&&P(e.buffer,ArrayBuffer))return function(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return(i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r)).__proto__=n.prototype,i}(e,r,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return n.from(o,r,i);var c=function(e){if(n.isBuffer(e)){var r=0|s(e.length),i=t(r);return 0===i.length||e.copy(i,0,0,r),i}return void 0!==e.length?"number"!=typeof e.length||M(e.length)?t(0):a(e):"Buffer"===e.type&&Array.isArray(e.data)?a(e.data):void 0}(e);if(c)return c;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return n.from(e[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function i(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function o(e){return i(e),t(e<0?0:0|s(e))}function a(e){for(var n=e.length<0?0:0|s(e.length),r=t(n),i=0;i<n;i+=1)r[i]=255&e[i];return r}function s(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function u(t,e){if(n.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||P(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return R(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(t).length;default:if(o)return i?-1:R(t).length;e=(""+e).toLowerCase(),o=!0}}function c(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function f(t,e,r,i,o){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),M(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=n.from(e,i)),n.isBuffer(e))return 0===e.length?-1:h(t,e,r,i,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):h(t,[e],r,i,o);throw new TypeError("val must be string, number or Buffer")}function h(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var f=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*a}else-1!==f&&(o-=o-f),f=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var h=!0,l=0;l<u;l++)if(c(t,o+l)!==c(e,l)){h=!1;break}if(h)return o}return-1}function l(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(M(s))return a;t[n+a]=s}return a}function p(t,e,n,r){return C(R(e,t.length-n),t,n,r)}function v(t,e,n,r){return C(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function g(t,e,n,r){return v(t,e,n,r)}function y(t,e,n,r){return C(D(e),t,n,r)}function m(t,e,n,r){return C(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(n=t.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function b(t,e,n){return 0===e&&n===t.length?di.fromByteArray(t):di.fromByteArray(t.slice(e,n))}function w(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],f=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(f=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(f=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(f=u)}null===f?(f=65533,h=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=h}return function(t){var e=t.length;if(e<=_)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=_));return n}(r)}e.kMaxLength=2147483647,n.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(d){return!1}}(),n.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192,n.from=function(t,e,n){return r(t,e,n)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,n.alloc=function(e,n,r){return function(e,n,r){return i(e),e<=0?t(e):void 0!==n?"string"==typeof r?t(e).fill(n,r):t(e).fill(n):t(e)}(e,n,r)},n.allocUnsafe=function(t){return o(t)},n.allocUnsafeSlow=function(t){return o(t)},n.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==n.prototype},n.compare=function(t,e){if(P(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),P(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==e[o]){r=t[o],i=e[o];break}return r<i?-1:i<r?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return n.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=n.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var a=t[r];if(P(a,Uint8Array)&&(a=n.from(a)),!n.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},n.byteLength=u,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)c(this,e,e+1);return this},n.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)c(this,e,e+3),c(this,e+1,e+2);return this},n.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)c(this,e,e+7),c(this,e+1,e+6),c(this,e+2,e+5),c(this,e+3,e+4);return this},n.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?w(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return w(this,e,n);case"ascii":return E(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return b(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===n.compare(this,t)},n.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},n.prototype.compare=function(t,e,r,i,o){if(P(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),!n.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=r)return 0;if(i>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(r>>>=0)-(e>>>=0),u=Math.min(a,s),c=this.slice(i,o),f=t.slice(e,r),h=0;h<u;++h)if(c[h]!==f[h]){a=c[h],s=f[h];break}return a<s?-1:s<a?1:0},n.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},n.prototype.indexOf=function(t,e,n){return f(this,t,e,n,!0)},n.prototype.lastIndexOf=function(t,e,n){return f(this,t,e,n,!1)},n.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return l(this,t,e,n);case"utf8":case"utf-8":return p(this,t,e,n);case"ascii":return v(this,t,e,n);case"latin1":case"binary":return g(this,t,e,n);case"base64":return y(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r,i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=e;a<n;++a)o+=(r=t[a])<16?"0"+r.toString(16):r.toString(16);return o}function A(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function S(t,e,r,i,o,a){if(!n.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function k(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(t,e,n,r,i){return e=+e,n>>>=0,i||k(t,0,n,4),Ii.write(t,e,n,r,23,4),n+4}function N(t,e,n,r,i){return e=+e,n>>>=0,i||k(t,0,n,8),Ii.write(t,e,n,r,52,8),n+8}n.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return i.__proto__=n.prototype,i},n.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},n.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},n.prototype.readUInt8=function(t,e){return t>>>=0,e||x(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return t>>>=0,e||x(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return t>>>=0,e||x(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return t>>>=0,e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return t>>>=0,e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},n.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||x(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},n.prototype.readInt8=function(t,e){return t>>>=0,e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){t>>>=0,e||x(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},n.prototype.readInt16BE=function(t,e){t>>>=0,e||x(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},n.prototype.readInt32LE=function(t,e){return t>>>=0,e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return t>>>=0,e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return t>>>=0,e||x(t,4,this.length),Ii.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return t>>>=0,e||x(t,4,this.length),Ii.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return t>>>=0,e||x(t,8,this.length),Ii.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return t>>>=0,e||x(t,8,this.length),Ii.read(this,t,!1,52,8)},n.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||S(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},n.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||S(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},n.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,1,255,0),this[e]=255&t,e+1},n.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},n.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},n.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},n.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},n.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);S(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},n.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);S(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},n.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},n.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},n.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},n.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},n.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||S(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},n.prototype.writeFloatLE=function(t,e,n){return O(this,t,e,!0,n)},n.prototype.writeFloatBE=function(t,e,n){return O(this,t,e,!1,n)},n.prototype.writeDoubleLE=function(t,e,n){return N(this,t,e,!0,n)},n.prototype.writeDoubleBE=function(t,e,n){return N(this,t,e,!1,n)},n.prototype.copy=function(t,e,r,i){if(!n.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var o=i-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,i);else if(this===t&&r<e&&e<i)for(var a=o-1;a>=0;--a)t[a+e]=this[a+r];else Uint8Array.prototype.set.call(t,this.subarray(r,i),e);return o},n.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!n.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(a=e;a<r;++a)this[a]=t;else{var s=n.isBuffer(t)?t:n.from(t,i),u=s.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(a=0;a<r-e;++a)this[a+e]=s[a%u]}return this};var L=/[^+/0-9A-Za-z-_]/g;function R(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function D(t){return di.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function C(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function P(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function M(t){return t!=t}}).call(this)}).call(this,s({}).Buffer)})),u={};(u=function(t){return t&&t.__esModule?t:{default:t}}).default=u,u.__esModule=!0;var c={exports:{}},f=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(N){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof v?e:v,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===l)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=l;var u=c(t,e,n);if("normal"===u.type){if(r=n.done?p:h,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(N){return{type:"throw",arg:N}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",l="executing",p="completed",d={};function v(){}function g(){}function y(){}var m={};s(m,i,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(k([])));w&&w!==e&&n.call(w,i)&&(m=w);var _=y.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var f=u.arg,h=f.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function T(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,T(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function k(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return g.prototype=y,s(_,"constructor",y),s(y,"constructor",g),g.displayName=s(y,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,a,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},E(I.prototype),s(I.prototype,o,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new I(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,a,"Generator"),s(_,i,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=k,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}(c.exports);try{regeneratorRuntime=f}catch(No){"object"==typeof globalThis?globalThis.regeneratorRuntime=f:Function("r","regeneratorRuntime = r")(f)}var h=c=c.exports,l={};function p(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}(l=function(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){p(o,r,i,a,s,"next",t)}function s(t){p(o,r,i,a,s,"throw",t)}a(void 0)}))}}).default=l,l.__esModule=!0;var d,v={exports:{}};d=function(){var t=function(){function e(t){return i.appendChild(t.dom),t}function n(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";r=t}var r=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),n(++r%i.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,u=e(new t.Panel("FPS","#0ff","#002")),c=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:i,addPanel:e,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(c.update(t-o,200),t>a+1e3&&(u.update(1e3*s/(t-a),100),a=t,s=0,f)){var e=performance.memory;f.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:i,setMode:n}};return t.Panel=function(t,e,n){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,u=48*a,c=3*a,f=2*a,h=3*a,l=15*a,p=74*a,d=30*a,v=document.createElement("canvas");v.width=s,v.height=u,v.style.cssText="width:80px;height:48px";var g=v.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,u),g.fillStyle=e,g.fillText(t,c,f),g.fillRect(h,l,p,d),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,l,p,d),{dom:v,update:function(u,y){r=Math.min(r,u),i=Math.max(i,u),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,l),g.fillStyle=e,g.fillText(o(u)+" "+t+" ("+o(r)+"-"+o(i)+")",c,f),g.drawImage(v,h+a,l,p-a,d,h,l,p-a,d),g.fillRect(h+p-a,l,a,d),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+p-a,l,a,o((1-u/y)*d))}}},t},"object"==typeof v.exports?v.exports=d():"function"==typeof define&&define.amd?define(d):this.Stats=d(),v=v.exports;var g,y={exports:{}};g=function(){function t(t,e){this.id=V++,this.type=t,this.data=e}function e(t){return"["+function t(e){if(0===e.length)return[];var n=e.charAt(0),r=e.charAt(e.length-1);if(1<e.length&&n===r&&('"'===n||"'"===n))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,n.index)).concat(t(n[1])).concat(t(e.substr(n.index+n[0].length)));if(1===(n=e.split(".")).length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(e=[],r=0;r<n.length;++r)e=e.concat(t(n[r]));return e}(t).join("][")+"]"}function n(t){return"string"==typeof t?t.split():t}function r(t){return"string"==typeof t?document.querySelector(t):t}function i(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}function o(t){var e,n;return e=(65535<t)<<4,e|=n=(255<(t>>>=e))<<3,(e|=n=(15<(t>>>=n))<<2)|(n=(3<(t>>>=n))<<1)|t>>>n>>1}function a(){function t(t){t:{for(var e=16;268435456>=e;e*=16)if(t<=e){t=e;break t}t=0}return 0<(e=n[o(t)>>2]).length?e.pop():new ArrayBuffer(t)}function e(t){n[o(t.byteLength)>>2].push(t)}var n=i(8,(function(){return[]}));return{alloc:t,free:e,allocType:function(e,n){var r=null;switch(e){case 5120:r=new Int8Array(t(n),0,n);break;case 5121:r=new Uint8Array(t(n),0,n);break;case 5122:r=new Int16Array(t(2*n),0,n);break;case 5123:r=new Uint16Array(t(2*n),0,n);break;case 5124:r=new Int32Array(t(4*n),0,n);break;case 5125:r=new Uint32Array(t(4*n),0,n);break;case 5126:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(t){e(t.buffer)}}}function s(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||W(t.data))}function u(t,e,n,r,i,o){for(var a=0;a<e;++a)for(var s=t[a],u=0;u<n;++u)for(var c=s[u],f=0;f<r;++f)i[o++]=c[f]}function c(t){return 0|Y[Object.prototype.toString.call(t)]}function f(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function h(t,e,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)t[s++]=e[i*u+o*c+a]}function l(t,e,n,r){function i(e){this.id=l++,this.buffer=t.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function o(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function a(t,e,n,r,i,a){if(t.usage=n,Array.isArray(e)){if(t.dtype=r||5126,0<e.length)if(Array.isArray(e[0])){i=Z(e);for(var u=r=1;u<i.length;++u)r*=i[u];t.dimension=r,o(t,e=$(e,i,t.dtype),n),a?t.persistentData=e:G.freeType(e)}else"number"==typeof e[0]?(t.dimension=i,f(i=G.allocType(t.dtype,e.length),e),o(t,i,n),a?t.persistentData=i:G.freeType(i)):W(e[0])&&(t.dimension=e[0].length,t.dtype=r||c(e[0])||5126,o(t,e=$(e,[e.length,e[0].length],t.dtype),n),a?t.persistentData=e:G.freeType(e))}else if(W(e))t.dtype=r||c(e),t.dimension=i,o(t,e,n),a&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(s(e)){i=e.shape;var l=e.stride,p=(u=e.offset,0),d=0,v=0,g=0;1===i.length?(p=i[0],d=1,v=l[0],g=0):2===i.length&&(p=i[0],d=i[1],v=l[0],g=l[1]),t.dtype=r||c(e.data)||5126,t.dimension=d,h(i=G.allocType(t.dtype,p*d),e.data,p,d,v,g,u),o(t,i,n),a?t.persistentData=i:G.freeType(i)}else e instanceof ArrayBuffer&&(t.dtype=5121,t.dimension=i,o(t,e,n),a&&(t.persistentData=new Uint8Array(new Uint8Array(e))))}function u(n){e.bufferCount--,r(n),t.deleteBuffer(n.buffer),n.buffer=null,delete p[n.id]}var l=0,p={};i.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},i.prototype.destroy=function(){u(this)};var d=[];return n.profile&&(e.getTotalBufferSize=function(){var t=0;return Object.keys(p).forEach((function(e){t+=p[e].stats.size})),t}),{create:function(r,o,l,d){function v(e){var r=35044,i=null,o=0,u=0,c=1;return Array.isArray(e)||W(e)||s(e)||e instanceof ArrayBuffer?i=e:"number"==typeof e?o=0|e:e&&("data"in e&&(i=e.data),"usage"in e&&(r=Q[e.usage]),"type"in e&&(u=J[e.type]),"dimension"in e&&(c=0|e.dimension),"length"in e&&(o=0|e.length)),g.bind(),i?a(g,i,r,u,c,d):(o&&t.bufferData(g.type,o,r),g.dtype=u||5121,g.usage=r,g.dimension=c,g.byteLength=o),n.profile&&(g.stats.size=g.byteLength*tt[g.dtype]),v}e.bufferCount++;var g=new i(o);return p[g.id]=g,l||v(r),v._reglType="buffer",v._buffer=g,v.subdata=function(e,n){var r,i=0|(n||0);if(g.bind(),W(e)||e instanceof ArrayBuffer)t.bufferSubData(g.type,i,e);else if(Array.isArray(e)){if(0<e.length)if("number"==typeof e[0]){var o=G.allocType(g.dtype,e.length);f(o,e),t.bufferSubData(g.type,i,o),G.freeType(o)}else(Array.isArray(e[0])||W(e[0]))&&(r=Z(e),o=$(e,r,g.dtype),t.bufferSubData(g.type,i,o),G.freeType(o))}else if(s(e)){r=e.shape;var a=e.stride,u=o=0,l=0,p=0;1===r.length?(o=r[0],u=1,l=a[0],p=0):2===r.length&&(o=r[0],u=r[1],l=a[0],p=a[1]),r=Array.isArray(e.data)?g.dtype:c(e.data),h(r=G.allocType(r,o*u),e.data,o,u,l,p,e.offset),t.bufferSubData(g.type,i,r),G.freeType(r)}return v},n.profile&&(v.stats=g.stats),v.destroy=function(){u(g)},v},createStream:function(t,e){var n=d.pop();return n||(n=new i(t)),n.bind(),a(n,e,35040,0,1,!1),n},destroyStream:function(t){d.push(t)},clear:function(){K(p).forEach(u),d.forEach(u)},getBuffer:function(t){return t&&t._buffer instanceof i?t._buffer:null},restore:function(){K(p).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))},_initBuffer:a}}function p(t,e,n,r){function i(t){this.id=c++,u[this.id]=this,this.buffer=t,this.primType=4,this.type=this.vertCount=0}function o(r,i,o,a,u,c,f){var h;if(r.buffer.bind(),i?((h=f)||W(i)&&(!s(i)||W(i.data))||(h=e.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,i,o,h,3)):(t.bufferData(34963,c,o),r.buffer.dtype=h||5121,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=c),h=f,!f){switch(r.buffer.dtype){case 5121:case 5120:h=5121;break;case 5123:case 5122:h=5123;break;case 5125:case 5124:h=5125}r.buffer.dtype=h}r.type=h,0>(i=u)&&(i=r.buffer.byteLength,5123===h?i>>=1:5125===h&&(i>>=2)),r.vertCount=i,i=a,0>a&&(i=4,1===(a=r.buffer.dimension)&&(i=0),2===a&&(i=1),3===a&&(i=4)),r.primType=i}function a(t){r.elementsCount--,delete u[t.id],t.buffer.destroy(),t.buffer=null}var u={},c=0,f={uint8:5121,uint16:5123};e.oes_element_index_uint&&(f.uint32=5125),i.prototype.bind=function(){this.buffer.bind()};var h=[];return{create:function(t,e){function u(t){if(t)if("number"==typeof t)c(t),h.primType=4,h.vertCount=0|t,h.type=5121;else{var e=null,n=35044,r=-1,i=-1,a=0,l=0;Array.isArray(t)||W(t)||s(t)?e=t:("data"in t&&(e=t.data),"usage"in t&&(n=Q[t.usage]),"primitive"in t&&(r=et[t.primitive]),"count"in t&&(i=0|t.count),"type"in t&&(l=f[t.type]),"length"in t?a=0|t.length:(a=i,5123===l||5122===l?a*=2:5125!==l&&5124!==l||(a*=4))),o(h,e,n,r,i,a,l)}else c(),h.primType=4,h.vertCount=0,h.type=5121;return u}var c=n.create(null,34963,!0),h=new i(c._buffer);return r.elementsCount++,u(t),u._reglType="elements",u._elements=h,u.subdata=function(t,e){return c.subdata(t,e),u},u.destroy=function(){a(h)},u},createStream:function(t){var e=h.pop();return e||(e=new i(n.create(null,34963,!0,!1)._buffer)),o(e,t,35040,-1,-1,0,0),e},destroyStream:function(t){h.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof i?t._elements:null},clear:function(){K(u).forEach(a)}}}function d(t){for(var e=G.allocType(5123,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(1/0===t[n])e[n]=31744;else if(-1/0===t[n])e[n]=64512;else{nt[0]=t[n];var r=(o=rt[0])>>>31<<15,i=(o<<1>>>24)-127,o=o>>13&1023;e[n]=-24>i?r:-14>i?r+(o+1024>>-14-i):15<i?r+31744:r+(i+15<<10)+o}return e}function v(t){return Array.isArray(t)||W(t)}function g(t){return"[object "+t+"]"}function y(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function m(t){return!(!Array.isArray(t)||0===t.length||!v(t[0]))}function b(t){return Object.prototype.toString.call(t)}function w(t){if(!t)return!1;var e=b(t);return 0<=pt.indexOf(e)||y(t)||m(t)||s(t)}function _(t,e){36193===t.type?(t.data=d(e),G.freeType(e)):t.data=e}function E(t,e,n,r,i,o){if(t=void 0!==vt[t]?vt[t]:at[t]*dt[e],o&&(t*=6),i){for(r=0;1<=n;)r+=t*n*n,n/=2;return r}return t*n*r}function I(t,e,n,r,i,o,a){function u(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function c(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function f(t,e){if("object"==typeof e&&e){"premultiplyAlpha"in e&&(t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(t.flipY=e.flipY),"alignment"in e&&(t.unpackAlignment=e.alignment),"colorSpace"in e&&(t.colorSpace=z[e.colorSpace]),"type"in e&&(t.type=H[e.type]);var n=t.width,r=t.height,i=t.channels,o=!1;"shape"in e?(n=e.shape[0],r=e.shape[1],3===e.shape.length&&(i=e.shape[2],o=!0)):("radius"in e&&(n=r=e.radius),"width"in e&&(n=e.width),"height"in e&&(r=e.height),"channels"in e&&(i=e.channels,o=!0)),t.width=0|n,t.height=0|r,t.channels=0|i,n=!1,"format"in e&&(n=e.format,r=t.internalformat=J[n],t.format=dt[r],n in H&&!("type"in e)&&(t.type=H[n]),n in Q&&(t.compressed=!0),n=!0),!o&&n?t.channels=at[t.format]:o&&!n&&t.channels!==ot[t.format]&&(t.format=t.internalformat=ot[t.channels])}}function h(e){t.pixelStorei(37440,e.flipY),t.pixelStorei(37441,e.premultiplyAlpha),t.pixelStorei(37443,e.colorSpace),t.pixelStorei(3317,e.unpackAlignment)}function l(){u.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(t,e){var n=null;if(w(e)?n=e:e&&(f(t,e),"x"in e&&(t.xOffset=0|e.x),"y"in e&&(t.yOffset=0|e.y),w(e.data)&&(n=e.data)),e.copy){var r=i.viewportWidth,o=i.viewportHeight;t.width=t.width||r-t.xOffset,t.height=t.height||o-t.yOffset,t.needsCopy=!0}else if(n){if(W(n))t.channels=t.channels||4,t.data=n,"type"in e||5121!==t.type||(t.type=0|Y[Object.prototype.toString.call(n)]);else if(y(n)){switch(t.channels=t.channels||4,o=(r=n).length,t.type){case 5121:case 5123:case 5125:case 5126:(o=G.allocType(t.type,o)).set(r),t.data=o;break;case 36193:t.data=d(r)}t.alignment=1,t.needsFree=!0}else if(s(n)){r=n.data,Array.isArray(r)||5121!==t.type||(t.type=0|Y[Object.prototype.toString.call(r)]),o=n.shape;var a,u,c,h,l=n.stride;3===o.length?(c=o[2],h=l[2]):h=c=1,a=o[0],u=o[1],o=l[0],l=l[1],t.alignment=1,t.width=a,t.height=u,t.channels=c,t.format=t.internalformat=ot[c],t.needsFree=!0,a=h,n=n.offset,c=t.width,h=t.height,u=t.channels;for(var p=G.allocType(36193===t.type?5126:t.type,c*h*u),g=0,E=0;E<h;++E)for(var I=0;I<c;++I)for(var T=0;T<u;++T)p[g++]=r[o*I+l*E+a*T+n];_(t,p)}else if(b(n)===st||b(n)===ut||b(n)===ct)b(n)===st||b(n)===ut?t.element=n:t.element=n.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(b(n)===ft)t.element=n,t.width=n.width,t.height=n.height,t.channels=4;else if(b(n)===ht)t.element=n,t.width=n.naturalWidth,t.height=n.naturalHeight,t.channels=4;else if(b(n)===lt)t.element=n,t.width=n.videoWidth,t.height=n.videoHeight,t.channels=4;else if(m(n)){for(r=t.width||n[0].length,o=t.height||n.length,l=t.channels,l=v(n[0][0])?l||n[0][0].length:l||1,a=X.shape(n),c=1,h=0;h<a.length;++h)c*=a[h];c=G.allocType(36193===t.type?5126:t.type,c),X.flatten(n,a,"",c),_(t,c),t.alignment=1,t.width=r,t.height=o,t.channels=l,t.format=t.internalformat=ot[l],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4}function g(e,n,i,o,a){var s=e.element,u=e.data,c=e.internalformat,f=e.format,l=e.type,p=e.width,d=e.height;h(e),s?t.texSubImage2D(n,a,i,o,f,l,s):e.compressed?t.compressedTexSubImage2D(n,a,i,o,c,p,d,u):e.needsCopy?(r(),t.copyTexSubImage2D(n,a,i,o,e.xOffset,e.yOffset,p,d)):t.texSubImage2D(n,a,i,o,p,d,f,l,u)}function I(){return vt.pop()||new l}function T(t){t.needsFree&&G.freeType(t.data),l.call(t),vt.push(t)}function A(){u.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function x(t,e,n){var r=t.images[0]=I();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function S(t,e){var n=null;if(w(e))c(n=t.images[0]=I(),t),p(n,e),t.mipmask=1;else if(f(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)c(n=t.images[i]=I(),t),n.width>>=i,n.height>>=i,p(n,r[i]),t.mipmask|=1<<i;else c(n=t.images[0]=I(),t),p(n,e),t.mipmask=1;c(t,t.images[0])}function k(e,n){for(var i=e.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=n,u=o,c=a.element,f=a.data,l=a.internalformat,p=a.format,d=a.type,v=a.width,g=a.height;h(a),c?t.texImage2D(s,u,p,p,d,c):a.compressed?t.compressedTexImage2D(s,u,l,v,g,0,f):a.needsCopy?(r(),t.copyTexImage2D(s,u,p,a.xOffset,a.yOffset,v,g,0)):t.texImage2D(s,u,p,v,g,0,p,d,f||null)}}function O(){var t=gt.pop()||new A;u.call(t);for(var e=t.mipmask=0;16>e;++e)t.images[e]=null;return t}function N(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&T(e[n]),e[n]=null;gt.push(t)}function L(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function R(t,e){"min"in e&&(t.minFilter=q[e.min],0<=it.indexOf(t.minFilter)&&!("faces"in e)&&(t.genMipmaps=!0)),"mag"in e&&(t.magFilter=B[e.mag]);var n=t.wrapS,r=t.wrapT;if("wrap"in e){var i=e.wrap;"string"==typeof i?n=r=V[i]:Array.isArray(i)&&(n=V[i[0]],r=V[i[1]])}else"wrapS"in e&&(n=V[e.wrapS]),"wrapT"in e&&(r=V[e.wrapT]);if(t.wrapS=n,t.wrapT=r,"anisotropic"in e&&(t.anisotropic=e.anisotropic),"mipmap"in e){switch(n=!1,typeof e.mipmap){case"string":t.mipmapHint=U[e.mipmap],n=t.genMipmaps=!0;break;case"boolean":n=t.genMipmaps=e.mipmap;break;case"object":t.genMipmaps=!1,n=!0}!n||"min"in e||(t.minFilter=9984)}}function D(n,r){t.texParameteri(r,10241,n.minFilter),t.texParameteri(r,10240,n.magFilter),t.texParameteri(r,10242,n.wrapS),t.texParameteri(r,10243,n.wrapT),e.ext_texture_filter_anisotropic&&t.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(t.hint(33170,n.mipmapHint),t.generateMipmap(r))}function C(e){u.call(this),this.mipmask=0,this.internalformat=6408,this.id=yt++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new L,a.profile&&(this.stats={size:0})}function P(e){t.activeTexture(33984),t.bindTexture(e.target,e.texture)}function M(){var e=wt[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(3553,null)}function j(e){var n=e.texture,r=e.unit,i=e.target;0<=r&&(t.activeTexture(33984+r),t.bindTexture(i,null),wt[r]=null),t.deleteTexture(n),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete mt[e.id],o.textureCount--}var U={"don't care":4352,"dont care":4352,nice:4354,fast:4353},V={repeat:10497,clamp:33071,mirror:33648},B={nearest:9728,linear:9729},q=F({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},B),z={none:0,browser:37444},H={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},J={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Q={};e.ext_srgb&&(J.srgb=35904,J.srgba=35906),e.oes_texture_float&&(H.float32=H.float=5126),e.oes_texture_half_float&&(H.float16=H["half float"]=36193),e.webgl_depth_texture&&(F(J,{depth:6402,"depth stencil":34041}),F(H,{uint16:5123,uint32:5125,"depth stencil":34042})),e.webgl_compressed_texture_s3tc&&F(Q,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),e.webgl_compressed_texture_atc&&F(Q,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),e.webgl_compressed_texture_pvrtc&&F(Q,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),e.webgl_compressed_texture_etc1&&(Q["rgb etc1"]=36196);var $=Array.prototype.slice.call(t.getParameter(34467));Object.keys(Q).forEach((function(t){var e=Q[t];0<=$.indexOf(e)&&(J[t]=e)}));var Z=Object.keys(J);n.textureFormats=Z;var tt=[];Object.keys(J).forEach((function(t){tt[J[t]]=t}));var et=[];Object.keys(H).forEach((function(t){et[H[t]]=t}));var nt=[];Object.keys(B).forEach((function(t){nt[B[t]]=t}));var rt=[];Object.keys(q).forEach((function(t){rt[q[t]]=t}));var pt=[];Object.keys(V).forEach((function(t){pt[V[t]]=t}));var dt=Z.reduce((function(t,n){var r=J[n];return 6409===r||6406===r||6409===r||6410===r||6402===r||34041===r||e.ext_srgb&&(35904===r||35906===r)?t[r]=r:32855===r||0<=n.indexOf("rgba")?t[r]=6408:t[r]=6407,t}),{}),vt=[],gt=[],yt=0,mt={},bt=n.maxTextureUnits,wt=Array(bt).map((function(){return null}));return F(C.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(0>e){for(var n=0;n<bt;++n){var r=wt[n];if(r){if(0<r.bindCount)continue;r.unit=-1}wt[n]=this,e=n;break}a.profile&&o.maxTextureUnits<e+1&&(o.maxTextureUnits=e+1),this.unit=e,t.activeTexture(33984+e),t.bindTexture(this.target,this.texture)}return e},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&j(this)}}),a.profile&&(o.getTotalTextureSize=function(){var t=0;return Object.keys(mt).forEach((function(e){t+=mt[e].stats.size})),t}),{create2D:function(e,n){function r(t,e){var n=i.texInfo;L.call(n);var o=O();return"number"==typeof t?x(o,0|t,"number"==typeof e?0|e:0|t):t?(R(n,t),S(o,t)):x(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,c(i,o),i.internalformat=o.internalformat,r.width=o.width,r.height=o.height,P(i),k(o,3553),D(n,3553),M(),N(o),a.profile&&(i.stats.size=E(i.internalformat,i.type,o.width,o.height,n.genMipmaps,!1)),r.format=tt[i.internalformat],r.type=et[i.type],r.mag=nt[n.magFilter],r.min=rt[n.minFilter],r.wrapS=pt[n.wrapS],r.wrapT=pt[n.wrapT],r}var i=new C(3553);return mt[i.id]=i,o.textureCount++,r(e,n),r.subimage=function(t,e,n,o){e|=0,n|=0,o|=0;var a=I();return c(a,i),a.width=0,a.height=0,p(a,t),a.width=a.width||(i.width>>o)-e,a.height=a.height||(i.height>>o)-n,P(i),g(a,3553,e,n,o),M(),T(a),r},r.resize=function(e,n){var o=0|e,s=0|n||o;if(o===i.width&&s===i.height)return r;r.width=i.width=o,r.height=i.height=s,P(i);for(var u=0;i.mipmask>>u;++u){var c=o>>u,f=s>>u;if(!c||!f)break;t.texImage2D(3553,u,i.format,c,f,0,i.format,i.type,null)}return M(),a.profile&&(i.stats.size=E(i.internalformat,i.type,o,s,!1,!1)),r},r._reglType="texture2d",r._texture=i,a.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(e,n,r,i,s,u){function h(t,e,n,r,i,o){var s,u=l.texInfo;for(L.call(u),s=0;6>s;++s)d[s]=O();if("number"!=typeof t&&t){if("object"==typeof t)if(e)S(d[0],t),S(d[1],e),S(d[2],n),S(d[3],r),S(d[4],i),S(d[5],o);else if(R(u,t),f(l,t),"faces"in t)for(t=t.faces,s=0;6>s;++s)c(d[s],l),S(d[s],t[s]);else for(s=0;6>s;++s)S(d[s],t)}else for(t=0|t||1,s=0;6>s;++s)x(d[s],t,t);for(c(l,d[0]),l.mipmask=u.genMipmaps?(d[0].width<<1)-1:d[0].mipmask,l.internalformat=d[0].internalformat,h.width=d[0].width,h.height=d[0].height,P(l),s=0;6>s;++s)k(d[s],34069+s);for(D(u,34067),M(),a.profile&&(l.stats.size=E(l.internalformat,l.type,h.width,h.height,u.genMipmaps,!0)),h.format=tt[l.internalformat],h.type=et[l.type],h.mag=nt[u.magFilter],h.min=rt[u.minFilter],h.wrapS=pt[u.wrapS],h.wrapT=pt[u.wrapT],s=0;6>s;++s)N(d[s]);return h}var l=new C(34067);mt[l.id]=l,o.cubeCount++;var d=Array(6);return h(e,n,r,i,s,u),h.subimage=function(t,e,n,r,i){n|=0,r|=0,i|=0;var o=I();return c(o,l),o.width=0,o.height=0,p(o,e),o.width=o.width||(l.width>>i)-n,o.height=o.height||(l.height>>i)-r,P(l),g(o,34069+t,n,r,i),M(),T(o),h},h.resize=function(e){if((e|=0)!==l.width){h.width=l.width=e,h.height=l.height=e,P(l);for(var n=0;6>n;++n)for(var r=0;l.mipmask>>r;++r)t.texImage2D(34069+n,r,l.format,e>>r,e>>r,0,l.format,l.type,null);return M(),a.profile&&(l.stats.size=E(l.internalformat,l.type,h.width,h.height,!1,!0)),h}},h._reglType="textureCube",h._texture=l,a.profile&&(h.stats=l.stats),h.destroy=function(){l.decRef()},h},clear:function(){for(var e=0;e<bt;++e)t.activeTexture(33984+e),t.bindTexture(3553,null),wt[e]=null;K(mt).forEach(j),o.cubeCount=0,o.textureCount=0},getTexture:function(t){return null},restore:function(){for(var e=0;e<bt;++e){var n=wt[e];n&&(n.bindCount=0,n.unit=-1,wt[e]=null)}K(mt).forEach((function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var n=0;32>n;++n)if(0!=(e.mipmask&1<<n))if(3553===e.target)t.texImage2D(3553,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);else for(var r=0;6>r;++r)t.texImage2D(34069+r,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);D(e.texInfo,e.target)}))},refresh:function(){for(var e=0;e<bt;++e){var n=wt[e];n&&(n.bindCount=0,n.unit=-1,wt[e]=null),t.activeTexture(33984+e),t.bindTexture(3553,null),t.bindTexture(34067,null)}}}}function T(t,e,n,r,i,o){function a(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=t=0;e?(t=e.width,r=e.height):n&&(t=n.width,r=n.height),this.width=t,this.height=r}function s(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function u(t,e,n){t&&(t.texture?t.texture._texture.refCount+=1:t.renderbuffer._renderbuffer.refCount+=1)}function c(e,n){n&&(n.texture?t.framebufferTexture2D(36160,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(36160,e,36161,n.renderbuffer._renderbuffer.renderbuffer))}function f(t){var e=3553,n=null,r=null,i=t;return"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),"texture2d"===(t=i._reglType)||"textureCube"===t?n=i:"renderbuffer"===t&&(r=i,e=36161),new a(e,n,r)}function h(t,e,n,o,s){return n?((t=r.create2D({width:t,height:e,format:o,type:s}))._texture.refCount=0,new a(3553,t,null)):((t=i.create({width:t,height:e,format:o}))._renderbuffer.refCount=0,new a(36161,null,t))}function l(t){return t&&(t.texture||t.renderbuffer)}function p(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}function d(){this.id=I++,T[this.id]=this,this.framebuffer=t.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(t){t.colorAttachments.forEach(s),s(t.depthAttachment),s(t.stencilAttachment),s(t.depthStencilAttachment)}function g(e){t.deleteFramebuffer(e.framebuffer),e.framebuffer=null,o.framebufferCount--,delete T[e.id]}function y(e){var r;t.bindFramebuffer(36160,e.framebuffer);var i=e.colorAttachments;for(r=0;r<i.length;++r)c(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(36160,36064+r,3553,null,0);t.framebufferTexture2D(36160,33306,3553,null,0),t.framebufferTexture2D(36160,36096,3553,null,0),t.framebufferTexture2D(36160,36128,3553,null,0),c(36096,e.depthAttachment),c(36128,e.stencilAttachment),c(33306,e.depthStencilAttachment),t.checkFramebufferStatus(36160),t.isContextLost(),t.bindFramebuffer(36160,b.next?b.next.framebuffer:null),b.cur=b.next,t.getError()}function m(t,e){function n(t,e){var i,o=0,a=0,s=!0,c=!0;i=null;var p=!0,d="rgba",g="uint8",m=1,b=null,E=null,I=null,T=!1;"number"==typeof t?(o=0|t,a=0|e||o):t?("shape"in t?(o=(a=t.shape)[0],a=a[1]):("radius"in t&&(o=a=t.radius),"width"in t&&(o=t.width),"height"in t&&(a=t.height)),("color"in t||"colors"in t)&&(i=t.color||t.colors,Array.isArray(i)),i||("colorCount"in t&&(m=0|t.colorCount),"colorTexture"in t&&(p=!!t.colorTexture,d="rgba4"),"colorType"in t&&(g=t.colorType,!p)&&("half float"===g||"float16"===g?d="rgba16f":"float"!==g&&"float32"!==g||(d="rgba32f")),"colorFormat"in t&&(d=t.colorFormat,0<=w.indexOf(d)?p=!0:0<=_.indexOf(d)&&(p=!1))),("depthTexture"in t||"depthStencilTexture"in t)&&(T=!(!t.depthTexture&&!t.depthStencilTexture)),"depth"in t&&("boolean"==typeof t.depth?s=t.depth:(b=t.depth,c=!1)),"stencil"in t&&("boolean"==typeof t.stencil?c=t.stencil:(E=t.stencil,s=!1)),"depthStencil"in t&&("boolean"==typeof t.depthStencil?s=c=t.depthStencil:(I=t.depthStencil,c=s=!1))):o=a=1;var A=null,x=null,S=null,k=null;if(Array.isArray(i))A=i.map(f);else if(i)A=[f(i)];else for(A=Array(m),i=0;i<m;++i)A[i]=h(o,a,p,d,g);for(o=o||A[0].width,a=a||A[0].height,b?x=f(b):s&&!c&&(x=h(o,a,T,"depth","uint32")),E?S=f(E):c&&!s&&(S=h(o,a,!1,"stencil","uint8")),I?k=f(I):!b&&!E&&c&&s&&(k=h(o,a,T,"depth stencil","depth stencil")),s=null,i=0;i<A.length;++i)u(A[i]),A[i]&&A[i].texture&&(c=mt[A[i].texture._texture.format]*bt[A[i].texture._texture.type],null===s&&(s=c));return u(x),u(S),u(k),v(r),r.width=o,r.height=a,r.colorAttachments=A,r.depthAttachment=x,r.stencilAttachment=S,r.depthStencilAttachment=k,n.color=A.map(l),n.depth=l(x),n.stencil=l(S),n.depthStencil=l(k),n.width=r.width,n.height=r.height,y(r),n}var r=new d;return o.framebufferCount++,n(t,e),F(n,{resize:function(t,e){var i=Math.max(0|t,1),o=Math.max(0|e||i,1);if(i===r.width&&o===r.height)return n;for(var a=r.colorAttachments,s=0;s<a.length;++s)p(a[s],i,o);return p(r.depthAttachment,i,o),p(r.stencilAttachment,i,o),p(r.depthStencilAttachment,i,o),r.width=n.width=i,r.height=n.height=o,y(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){g(r),v(r)},use:function(t){b.setFBO({framebuffer:n},t)}})}var b={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],_=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&_.push("srgba"),e.ext_color_buffer_half_float&&_.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&_.push("rgba32f");var E=["uint8"];e.oes_texture_half_float&&E.push("half float","float16"),e.oes_texture_float&&E.push("float","float32");var I=0,T={};return F(b,{getFramebuffer:function(t){return"function"==typeof t&&"framebuffer"===t._reglType&&(t=t._framebuffer)instanceof d?t:null},create:m,createCube:function(t){function e(t){var i,o={color:null},a=0,s=null;i="rgba";var u="uint8",c=1;if("number"==typeof t?a=0|t:t?("shape"in t?a=t.shape[0]:("radius"in t&&(a=0|t.radius),"width"in t?a=0|t.width:"height"in t&&(a=0|t.height)),("color"in t||"colors"in t)&&(s=t.color||t.colors,Array.isArray(s)),s||("colorCount"in t&&(c=0|t.colorCount),"colorType"in t&&(u=t.colorType),"colorFormat"in t&&(i=t.colorFormat)),"depth"in t&&(o.depth=t.depth),"stencil"in t&&(o.stencil=t.stencil),"depthStencil"in t&&(o.depthStencil=t.depthStencil)):a=1,s)if(Array.isArray(s))for(t=[],i=0;i<s.length;++i)t[i]=s[i];else t=[s];else for(t=Array(c),s={radius:a,format:i,type:u},i=0;i<c;++i)t[i]=r.createCube(s);for(o.color=Array(t.length),i=0;i<t.length;++i)c=t[i],a=a||c.width,o.color[i]={target:34069,data:t[i]};for(i=0;6>i;++i){for(c=0;c<t.length;++c)o.color[c].target=34069+i;0<i&&(o.depth=n[0].depth,o.stencil=n[0].stencil,o.depthStencil=n[0].depthStencil),n[i]?n[i](o):n[i]=m(o)}return F(e,{width:a,height:a,color:t})}var n=Array(6);return e(t),F(e,{faces:n,resize:function(t){var r=0|t;if(r===e.width)return e;var i=e.color;for(t=0;t<i.length;++t)i[t].resize(r);for(t=0;6>t;++t)n[t].resize(r);return e.width=e.height=r,e},_reglType:"framebufferCube",destroy:function(){n.forEach((function(t){t.destroy()}))}})},clear:function(){K(T).forEach(g)},restore:function(){b.cur=null,b.next=null,b.dirty=!0,K(T).forEach((function(e){e.framebuffer=t.createFramebuffer(),y(e)}))}})}function A(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function x(t,e,n,r,i){function o(){this.id=++c,this.attributes=[];var t=e.oes_vertex_array_object;this.vao=t?t.createVertexArrayOES():null,f[this.id]=this,this.buffers=[]}var a=n.maxAttributes,u=Array(a);for(n=0;n<a;++n)u[n]=new A;var c=0,f={},h={Record:A,scope:{},state:u,currentVAO:null,targetVAO:null,restore:e.oes_vertex_array_object?function(){e.oes_vertex_array_object&&K(f).forEach((function(t){t.refresh()}))}:function(){},createVAO:function(t){function e(t){var r={},o=n.attributes;o.length=t.length;for(var a=0;a<t.length;++a){var u,c=t[a],f=o[a]=new A,h=c.data||c;Array.isArray(h)||W(h)||s(h)?(n.buffers[a]&&(u=n.buffers[a],W(h)&&u._buffer.byteLength>=h.byteLength?u.subdata(h):(u.destroy(),n.buffers[a]=null)),n.buffers[a]||(u=n.buffers[a]=i.create(c,34962,!1,!0)),f.buffer=i.getBuffer(u),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1,r[a]=1):i.getBuffer(c)?(f.buffer=i.getBuffer(c),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1):i.getBuffer(c.buffer)?(f.buffer=i.getBuffer(c.buffer),f.size=0|(+c.size||f.buffer.dimension),f.normalized=!!c.normalized||!1,f.type="type"in c?J[c.type]:f.buffer.dtype,f.offset=0|(c.offset||0),f.stride=0|(c.stride||0),f.divisor=0|(c.divisor||0),f.state=1):"x"in c&&(f.x=+c.x||0,f.y=+c.y||0,f.z=+c.z||0,f.w=+c.w||0,f.state=2)}for(t=0;t<n.buffers.length;++t)!r[t]&&n.buffers[t]&&(n.buffers[t].destroy(),n.buffers[t]=null);return n.refresh(),e}var n=new o;return r.vaoCount+=1,e.destroy=function(){for(var t=0;t<n.buffers.length;++t)n.buffers[t]&&n.buffers[t].destroy();n.buffers.length=0,n.destroy()},e._vao=n,e._reglType="vao",e(t)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(e){for(var n=0;n<u.length;++n){var r=u[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}},setVAO:e.oes_vertex_array_object?function(t){if(t!==h.currentVAO){var n=e.oes_vertex_array_object;t?n.bindVertexArrayOES(t.vao):n.bindVertexArrayOES(null),h.currentVAO=t}}:function(n){if(n!==h.currentVAO){if(n)n.bindAttrs();else for(var r=e.angle_instanced_arrays,i=0;i<u.length;++i){var o=u[i];o.buffer?(t.enableVertexAttribArray(i),t.vertexAttribPointer(i,o.size,o.type,o.normalized,o.stride,o.offfset),r&&o.divisor&&r.vertexAttribDivisorANGLE(i,o.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,o.x,o.y,o.z,o.w))}h.currentVAO=n}},clear:e.oes_vertex_array_object?function(){K(f).forEach((function(t){t.destroy()}))}:function(){}};return o.prototype.bindAttrs=function(){for(var n=e.angle_instanced_arrays,r=this.attributes,i=0;i<r.length;++i){var o=r[i];o.buffer?(t.enableVertexAttribArray(i),t.bindBuffer(34962,o.buffer.buffer),t.vertexAttribPointer(i,o.size,o.type,o.normalized,o.stride,o.offset),n&&o.divisor&&n.vertexAttribDivisorANGLE(i,o.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,o.x,o.y,o.z,o.w))}for(n=r.length;n<a;++n)t.disableVertexAttribArray(n)},o.prototype.refresh=function(){var t=e.oes_vertex_array_object;t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),h.currentVAO=this)},o.prototype.destroy=function(){if(this.vao){var t=e.oes_vertex_array_object;this===h.currentVAO&&(h.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}f[this.id]&&(delete f[this.id],--r.vaoCount)},h}function S(t,e,n,r){function i(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function o(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function a(n,r,i){if(!(a=(i=35632===n?c:f)[r])){var o=e.str(r),a=t.createShader(n);t.shaderSource(a,o),t.compileShader(a),i[r]=a}return a}function s(t,e){this.id=p++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(n,s,u){var c;c=a(35632,n.fragId);var f=a(35633,n.vertId);if(s=n.program=t.createProgram(),t.attachShader(s,c),t.attachShader(s,f),u)for(c=0;c<u.length;++c)f=u[c],t.bindAttribLocation(s,f[0],f[1]);t.linkProgram(s),f=t.getProgramParameter(s,35718),r.profile&&(n.stats.uniformsCount=f);var h=n.uniforms;for(c=0;c<f;++c)if(u=t.getActiveUniform(s,c))if(1<u.size)for(var l=0;l<u.size;++l){var p=u.name.replace("[0]","["+l+"]");o(h,new i(p,e.id(p),t.getUniformLocation(s,p),u))}else o(h,new i(u.name,e.id(u.name),t.getUniformLocation(s,u.name),u));for(f=t.getProgramParameter(s,35721),r.profile&&(n.stats.attributesCount=f),n=n.attributes,c=0;c<f;++c)(u=t.getActiveAttrib(s,c))&&o(n,new i(u.name,e.id(u.name),t.getAttribLocation(s,u.name),u))}var c={},f={},h={},l=[],p=0;return r.profile&&(n.getMaxUniformsCount=function(){var t=0;return l.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},n.getMaxAttributesCount=function(){var t=0;return l.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);K(c).forEach(e),c={},K(f).forEach(e),f={},l.forEach((function(e){t.deleteProgram(e.program)})),l.length=0,h={},n.shaderCount=0},program:function(e,r,i,o){var a=h[r];a||(a=h[r]={});var p=a[e];if(p&&(p.refCount++,!o))return p;var d=new s(r,e);return n.shaderCount++,u(d,i,o),p||(a[e]=d),l.push(d),F(d,{destroy:function(){if(d.refCount--,0>=d.refCount){t.deleteProgram(d.program);var e=l.indexOf(d);l.splice(e,1),n.shaderCount--}0>=a[d.vertId].refCount&&(t.deleteShader(f[d.vertId]),delete f[d.vertId],delete h[d.fragId][d.vertId]),Object.keys(h[d.fragId]).length||(t.deleteShader(c[d.fragId]),delete c[d.fragId],delete h[d.fragId])}})},restore:function(){c={},f={};for(var t=0;t<l.length;++t)u(l[t],null,l[t].attributes.map((function(t){return[t.location,t.name]})))},shader:a,frag:-1,vert:-1}}function k(t,e,n,r,i,o,a){function s(i){var o;o=null===e.next?5121:e.next.colorAttachments[0].texture._texture.type;var a=0,s=0,u=r.framebufferWidth,c=r.framebufferHeight,f=null;return W(i)?f=i:i&&(a=0|i.x,s=0|i.y,u=0|(i.width||r.framebufferWidth-a),c=0|(i.height||r.framebufferHeight-s),f=i.data||null),n(),i=u*c*4,f||(5121===o?f=new Uint8Array(i):5126===o&&(f=f||new Float32Array(i))),t.pixelStorei(3333,4),t.readPixels(a,s,u,c,6408,o,f),f}return function(t){return t&&"framebuffer"in t?function(t){var n;return e.setFBO({framebuffer:t.framebuffer},(function(){n=s(t)})),n}(t):s(t)}}function O(t){return Array.prototype.slice.call(t)}function N(t){return O(t).join("")}function L(t){return Array.isArray(t)||W(t)||s(t)}function R(t){return t.sort((function(t,e){return"viewport"===t?-1:"viewport"===e?1:t<e?-1:1}))}function D(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function C(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function P(t){return new D(!1,!1,!1,t)}function M(t,e){var n=t.type;if(0===n)return new D(!0,1<=(n=t.data.length),2<=n,e);if(4===n)return new D((n=t.data).thisDep,n.contextDep,n.propDep,e);if(5===n)return new D(!1,!1,!1,e);if(6===n){for(var r=n=!1,i=!1,o=0;o<t.data.length;++o){var a=t.data[o];1===a.type?i=!0:2===a.type?r=!0:3===a.type?n=!0:0===a.type?(n=!0,1<=(a=a.data)&&(r=!0),2<=a&&(i=!0)):4===a.type&&(n=n||a.data.thisDep,r=r||a.data.contextDep,i=i||a.data.propDep)}return new D(n,r,i,e)}return new D(3===n,2===n,1===n,e)}function j(t,e,n,r,o,a,s,u,c,f,h,l,p,d,g){function y(t){return t.replace(".","_")}function m(t,e,n){var r=y(t);ot.push(t),it[r]=rt[r]=!!n,at[r]=e}function b(t,e,n){var r=y(t);ot.push(t),Array.isArray(n)?(rt[r]=n.slice(),it[r]=n.slice()):rt[r]=it[r]=n,st[r]=e}function w(){var t=function(){function t(){var t=[],e=[];return F((function(){t.push.apply(t,O(arguments))}),{def:function(){var r="v"+n++;return e.push(r),0<arguments.length&&(t.push(r,"="),t.push.apply(t,O(arguments)),t.push(";")),r},toString:function(){return N([0<e.length?"var "+e.join(",")+";":"",N(t)])}})}function e(){function e(t,e){r(t,e,"=",n.def(t,e),";")}var n=t(),r=t(),i=n.toString,o=r.toString;return F((function(){n.apply(n,O(arguments))}),{def:n.def,entry:n,exit:r,save:e,set:function(t,r,i){e(t,r),n(t,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=t(),a={};return{global:o,link:function(t){for(var e=0;e<i.length;++e)if(i[e]===t)return r[e];return e="g"+n++,r.push(e),i.push(t),e},block:t,proc:function(t,n){function r(){var t="a"+i.length;return i.push(t),t}var i=[];n=n||0;for(var o=0;o<n;++o)r();var s=(o=e()).toString;return a[t]=F(o,{arg:r,toString:function(){return N(["function(",i.join(),"){",s(),"}"])}})},scope:e,cond:function(){var t=N(arguments),n=e(),r=e(),i=n.toString,o=r.toString;return F(n,{then:function(){return n.apply(n,O(arguments)),this},else:function(){return r.apply(r,O(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),N(["if(",t,"){",i(),"}",e])}})},compile:function(){var t=['"use strict";',o,"return {"];Object.keys(a).forEach((function(e){t.push('"',e,'":',a[e].toString(),",")})),t.push("}");var e=N(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(e)).apply(null,i)}}}(),n=t.link,r=t.global;t.id=ft++,t.batchId="0";var i=n(ut),o=t.shared={props:"a0"};Object.keys(ut).forEach((function(t){o[t]=r.def(i,".",t)}));var a=t.next={},s=t.current={};Object.keys(st).forEach((function(t){Array.isArray(rt[t])&&(a[t]=r.def(o.next,".",t),s[t]=r.def(o.current,".",t))}));var u=t.constants={};Object.keys(ct).forEach((function(t){u[t]=r.def(JSON.stringify(ct[t]))})),t.invoke=function(e,r){switch(r.type){case 0:var i=["this",o.context,o.props,t.batchId];return e.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return e.def(o.props,r.data);case 2:return e.def(o.context,r.data);case 3:return e.def("this",r.data);case 4:return r.data.append(t,e),r.data.ref;case 5:return r.data.toString();case 6:return r.data.map((function(n){return t.invoke(e,n)}))}},t.attribCache={};var c={};return t.scopeAttrib=function(t){if((t=e.id(t))in c)return c[t];var r=f.scope[t];return r||(r=f.scope[t]=new $),c[t]=n(r)},t}function _(t,e){var n=t.static,r=t.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=u.getFramebuffer(i),P((function(t,e){var n=t.link(i),r=t.shared;return e.set(r.framebuffer,".next",n),r=r.context,e.set(r,".framebufferWidth",n+".width"),e.set(r,".framebufferHeight",n+".height"),n}))):P((function(t,e){var n=t.shared;return e.set(n.framebuffer,".next","null"),n=n.context,e.set(n,".framebufferWidth",n+".drawingBufferWidth"),e.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"}))}if("framebuffer"in r){var o=r.framebuffer;return M(o,(function(t,e){var n=t.invoke(e,o),r=t.shared,i=r.framebuffer;return n=e.def(i,".getFramebuffer(",n,")"),e.set(i,".next",n),r=r.context,e.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),e.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n}))}return null}function E(t,n,r){function i(t){if(t in o){var n=e.id(o[t]);return(t=P((function(){return n}))).id=n,t}if(t in a){var r=a[t];return M(r,(function(t,e){var n=t.invoke(e,r);return e.def(t.shared.strings,".id(",n,")")}))}return null}var o=t.static,a=t.dynamic,s=i("frag"),u=i("vert"),c=null;return C(s)&&C(u)?(c=h.program(u.id,s.id,null,r),t=P((function(t,e){return t.link(c)}))):t=new D(s&&s.thisDep||u&&u.thisDep,s&&s.contextDep||u&&u.contextDep,s&&s.propDep||u&&u.propDep,(function(t,e){var n,r,i=t.shared.shader;return n=s?s.append(t,e):e.def(i,".","frag"),r=u?u.append(t,e):e.def(i,".","vert"),e.def(i+".program("+r+","+n+")")})),{frag:s,vert:u,progVar:t,program:c}}function I(t,e){function n(t,e){if(t in r){var n=0|r[t];return P((function(t,r){return e&&(t.OFFSET=n),n}))}if(t in i){var a=i[t];return M(a,(function(t,n){var r=t.invoke(n,a);return e&&(t.OFFSET=r),r}))}return e&&o?P((function(t,e){return t.OFFSET="0",0})):null}var r=t.static,i=t.dynamic,o=function(){if("elements"in r){var t=r.elements;L(t)?t=a.getElements(a.create(t,!0)):t&&(t=a.getElements(t));var e=P((function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r}return e.ELEMENTS=null}));return e.value=t,e}if("elements"in i){var n=i.elements;return M(n,(function(t,e){var r=(i=t.shared).isBufferArgs,i=i.elements,o=t.invoke(e,n),a=e.def("null");return r=e.def(r,"(",o,")"),o=t.cond(r).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");"),e.entry(o),e.exit(t.cond(r).then(i,".destroyStream(",a,");")),t.ELEMENTS=a}))}return null}(),s=n("offset",!0);return{elements:o,primitive:function(){if("primitive"in r){var t=r.primitive;return P((function(e,n){return et[t]}))}if("primitive"in i){var e=i.primitive;return M(e,(function(t,n){var r=t.constants.primTypes,i=t.invoke(n,e);return n.def(r,"[",i,"]")}))}return o?C(o)?o.value?P((function(t,e){return e.def(t.ELEMENTS,".primType")})):P((function(){return 4})):new D(o.thisDep,o.contextDep,o.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",4)})):null}(),count:function(){if("count"in r){var t=0|r.count;return P((function(){return t}))}if("count"in i){var e=i.count;return M(e,(function(t,n){return t.invoke(n,e)}))}return o?C(o)?o?s?new D(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.ELEMENTS,".vertCount-",t.OFFSET)})):P((function(t,e){return e.def(t.ELEMENTS,".vertCount")})):P((function(){return-1})):new D(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")})):null}(),instances:n("instances",!1),offset:s}}function T(t,n){var r=t.static,i=t.dynamic,a={};return Object.keys(r).forEach((function(t){var n=r[t],i=e.id(t),s=new $;if(L(n))s.state=1,s.buffer=o.getBuffer(o.create(n,34962,!1,!0)),s.type=0;else if(c=o.getBuffer(n))s.state=1,s.buffer=c,s.type=0;else if("constant"in n){var u=n.constant;s.buffer="null",s.state=2,"number"==typeof u?s.x=u:wt.forEach((function(t,e){e<u.length&&(s[t]=u[e])}))}else{var c=L(n.buffer)?o.getBuffer(o.create(n.buffer,34962,!1,!0)):o.getBuffer(n.buffer),f=0|n.offset,h=0|n.stride,l=0|n.size,p=!!n.normalized,d=0;"type"in n&&(d=J[n.type]),n=0|n.divisor,s.buffer=c,s.state=1,s.size=l,s.normalized=p,s.type=d||c.dtype,s.offset=f,s.stride=h,s.divisor=n}a[t]=P((function(t,e){var n=t.attribCache;if(i in n)return n[i];var r={isStream:!1};return Object.keys(s).forEach((function(t){r[t]=s[t]})),s.buffer&&(r.buffer=t.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[i]=r}))})),Object.keys(i).forEach((function(t){var e=i[t];a[t]=M(e,(function(t,n){function r(t){n(u[t],"=",i,".",t,"|0;")}var i=t.invoke(n,e),o=t.shared,a=t.constants,s=o.isBufferArgs,u=(o=o.buffer,{isStream:n.def(!1)}),c=new $;c.state=1,Object.keys(c).forEach((function(t){u[t]=n.def(""+c[t])}));var f=u.buffer,h=u.type;return n("if(",s,"(",i,")){",u.isStream,"=true;",f,"=",o,".createStream(",34962,",",i,");",h,"=",f,".dtype;","}else{",f,"=",o,".getBuffer(",i,");","if(",f,"){",h,"=",f,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[wt[0]],"=",i,".constant;",wt.slice(1).map((function(t){return u[t]})).join("="),"=0;","}else{",wt.map((function(t,e){return u[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",f,"=",o,".createStream(",34962,",",i,".buffer);","}else{",f,"=",o,".getBuffer(",i,".buffer);","}",h,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",f,".dtype;",u.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",u.isStream,"){",o,".destroyStream(",f,");","}"),u}))})),a}function A(t,e,r,o,a){function s(t){var e=c[t];e&&(l[t]=e)}var u=function(t,e){if("string"==typeof(n=t.static).frag&&"string"==typeof n.vert){if(0<Object.keys(e.dynamic).length)return null;var n=e.static,r=Object.keys(n);if(0<r.length&&"number"==typeof n[r[0]]){for(var i=[],o=0;o<r.length;++o)i.push([0|n[r[o]],r[o]]);return i}}return null}(t,e),c=function(t,e,n){function r(t){if(t in i){var n=i[t];t=!0;var r,a,s=0|n.x,u=0|n.y;return"width"in n?r=0|n.width:t=!1,"height"in n?a=0|n.height:t=!1,new D(!t&&e&&e.thisDep,!t&&e&&e.contextDep,!t&&e&&e.propDep,(function(t,e){var i=t.shared.context,o=r;"width"in n||(o=e.def(i,".","framebufferWidth","-",s));var c=a;return"height"in n||(c=e.def(i,".","framebufferHeight","-",u)),[s,u,o,c]}))}if(t in o){var c=o[t];return t=M(c,(function(t,e){var n=t.invoke(e,c),r=t.shared.context,i=e.def(n,".x|0"),o=e.def(n,".y|0");return[i,o,e.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=e.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",o,")")]})),e&&(t.thisDep=t.thisDep||e.thisDep,t.contextDep=t.contextDep||e.contextDep,t.propDep=t.propDep||e.propDep),t}return e?new D(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".","framebufferWidth"),e.def(n,".","framebufferHeight")]})):null}var i=t.static,o=t.dynamic;if(t=r("viewport")){var a=t;t=new D(t.thisDep,t.contextDep,t.propDep,(function(t,e){var n=a.append(t,e),r=t.shared.context;return e.set(r,".viewportWidth",n[2]),e.set(r,".viewportHeight",n[3]),n}))}return{viewport:t,scissor_box:r("scissor.box")}}(t,d=_(t)),h=I(t),l=function(t,e){var n=t.static,r=t.dynamic,o={};return ot.forEach((function(t){function e(e,i){if(t in n){var s=e(n[t]);o[a]=P((function(){return s}))}else if(t in r){var u=r[t];o[a]=M(u,(function(t,e){return i(t,e,t.invoke(e,u))}))}}var a=y(t);switch(t){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return e((function(t){return t}),(function(t,e,n){return n}));case"depth.func":return e((function(t){return It[t]}),(function(t,e,n){return e.def(t.constants.compareFuncs,"[",n,"]")}));case"depth.range":return e((function(t){return t}),(function(t,e,n){return[e.def("+",n,"[0]"),e=e.def("+",n,"[1]")]}));case"blend.func":return e((function(t){return[Et["srcRGB"in t?t.srcRGB:t.src],Et["dstRGB"in t?t.dstRGB:t.dst],Et["srcAlpha"in t?t.srcAlpha:t.src],Et["dstAlpha"in t?t.dstAlpha:t.dst]]}),(function(t,e,n){function r(t,r){return e.def('"',t,r,'" in ',n,"?",n,".",t,r,":",n,".",t)}t=t.constants.blendFuncs;var i=r("src","RGB"),o=r("dst","RGB"),a=(i=e.def(t,"[",i,"]"),e.def(t,"[",r("src","Alpha"),"]"));return[i,o=e.def(t,"[",o,"]"),a,t=e.def(t,"[",r("dst","Alpha"),"]")]}));case"blend.equation":return e((function(t){return"string"==typeof t?[Z[t],Z[t]]:"object"==typeof t?[Z[t.rgb],Z[t.alpha]]:void 0}),(function(t,e,n){var r=t.constants.blendEquations,i=e.def(),o=e.def();return(t=t.cond("typeof ",n,'==="string"')).then(i,"=",o,"=",r,"[",n,"];"),t.else(i,"=",r,"[",n,".rgb];",o,"=",r,"[",n,".alpha];"),e(t),[i,o]}));case"blend.color":return e((function(t){return i(4,(function(e){return+t[e]}))}),(function(t,e,n){return i(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case"stencil.mask":return e((function(t){return 0|t}),(function(t,e,n){return e.def(n,"|0")}));case"stencil.func":return e((function(t){return[It[t.cmp||"keep"],t.ref||0,"mask"in t?t.mask:-1]}),(function(t,e,n){return[t=e.def('"cmp" in ',n,"?",t.constants.compareFuncs,"[",n,".cmp]",":",7680),e.def(n,".ref|0"),e=e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case"stencil.opFront":case"stencil.opBack":return e((function(e){return["stencil.opBack"===t?1029:1028,Tt[e.fail||"keep"],Tt[e.zfail||"keep"],Tt[e.zpass||"keep"]]}),(function(e,n,r){function i(t){return n.def('"',t,'" in ',r,"?",o,"[",r,".",t,"]:",7680)}var o=e.constants.stencilOps;return["stencil.opBack"===t?1029:1028,i("fail"),i("zfail"),i("zpass")]}));case"polygonOffset.offset":return e((function(t){return[0|t.factor,0|t.units]}),(function(t,e,n){return[e.def(n,".factor|0"),e=e.def(n,".units|0")]}));case"cull.face":return e((function(t){var e=0;return"front"===t?e=1028:"back"===t&&(e=1029),e}),(function(t,e,n){return e.def(n,'==="front"?',1028,":",1029)}));case"lineWidth":return e((function(t){return t}),(function(t,e,n){return n}));case"frontFace":return e((function(t){return At[t]}),(function(t,e,n){return e.def(n+'==="cw"?2304:2305')}));case"colorMask":return e((function(t){return t.map((function(t){return!!t}))}),(function(t,e,n){return i(4,(function(t){return"!!"+n+"["+t+"]"}))}));case"sample.coverage":return e((function(t){return["value"in t?t.value:1,!!t.invert]}),(function(t,e,n){return[e.def('"value" in ',n,"?+",n,".value:1"),e=e.def("!!",n,".invert")]}))}})),o}(t),p=E(t,0,u);s("viewport"),s(y("scissor.box"));var d,g=0<Object.keys(l).length;if((d={framebuffer:d,draw:h,shader:p,state:l,dirty:g,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(t){var e,n=t.static;if(t=t.dynamic,"profile"in n){var r=!!n.profile;(e=P((function(t,e){return r}))).enable=r}else if("profile"in t){var i=t.profile;e=M(i,(function(t,e){return t.invoke(e,i)}))}return e}(t),d.uniforms=function(t,e){var n=t.static,r=t.dynamic,o={};return Object.keys(n).forEach((function(t){var e,r=n[t];if("number"==typeof r||"boolean"==typeof r)e=P((function(){return r}));else if("function"==typeof r){var a=r._reglType;"texture2d"===a||"textureCube"===a?e=P((function(t){return t.link(r)})):"framebuffer"!==a&&"framebufferCube"!==a||(e=P((function(t){return t.link(r.color[0])})))}else v(r)&&(e=P((function(t){return t.global.def("[",i(r.length,(function(t){return r[t]})),"]")})));e.value=r,o[t]=e})),Object.keys(r).forEach((function(t){var e=r[t];o[t]=M(e,(function(t,n){return t.invoke(n,e)}))})),o}(r),d.drawVAO=d.scopeVAO=function(t,e){var n=t.static,r=t.dynamic;if("vao"in n){var i=n.vao;return null!==i&&null===f.getVAO(i)&&(i=f.createVAO(i)),P((function(t){return t.link(f.getVAO(i))}))}if("vao"in r){var o=r.vao;return M(o,(function(t,e){var n=t.invoke(e,o);return e.def(t.shared.vao+".getVAO("+n+")")}))}return null}(t),!d.drawVAO&&p.program&&!u&&n.angle_instanced_arrays){var m=!0;if(t=p.program.attributes.map((function(t){return t=e.static[t],m=m&&!!t,t})),m&&0<t.length){var b=f.getVAO(f.createVAO(t));d.drawVAO=new D(null,null,null,(function(t,e){return t.link(b)})),d.useVAO=!0}}return u?d.useVAO=!0:d.attributes=T(e),d.context=function(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach((function(t){var n=e[t];r[t]=P((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];r[t]=M(e,(function(t,n){return t.invoke(n,e)}))})),r}(o),d}function x(t,e,n){var r=t.shared.context,i=t.scope();Object.keys(n).forEach((function(o){e.save(r,"."+o);var a=n[o].append(t,e);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")})),e(i)}function S(t,e,n,r){var i,o=(s=t.shared).gl,a=s.framebuffer;nt&&(i=e.def(s.extensions,".webgl_draw_buffers"));var s=(u=t.constants).drawBuffer,u=u.backBuffer;t=n?n.append(t,e):e.def(a,".next"),r||e("if(",t,"!==",a,".cur){"),e("if(",t,"){",o,".bindFramebuffer(",36160,",",t,".framebuffer);"),nt&&e(i,".drawBuffersWEBGL(",s,"[",t,".colorAttachments.length]);"),e("}else{",o,".bindFramebuffer(",36160,",null);"),nt&&e(i,".drawBuffersWEBGL(",u,");"),e("}",a,".cur=",t,";"),r||e("}")}function k(t,e,n){var r=t.shared,o=r.gl,a=t.current,s=t.next,u=r.current,c=r.next,f=t.cond(u,".dirty");ot.forEach((function(e){var r,h;if(!((e=y(e))in n.state))if(e in s){r=s[e],h=a[e];var l=i(rt[e].length,(function(t){return f.def(r,"[",t,"]")}));f(t.cond(l.map((function(t,e){return t+"!=="+h+"["+e+"]"})).join("||")).then(o,".",st[e],"(",l,");",l.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";"))}else r=f.def(c,".",e),l=t.cond(r,"!==",u,".",e),f(l),e in at?l(t.cond(r).then(o,".enable(",at[e],");").else(o,".disable(",at[e],");"),u,".",e,"=",r,";"):l(o,".",st[e],"(",r,");",u,".",e,"=",r,";")})),0===Object.keys(n.state).length&&f(u,".dirty=false;"),e(f)}function j(t,e,n,r){var i=t.shared,o=t.current,a=i.current,s=i.gl;R(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var c=u.append(t,e);if(at[i]){var f=at[i];C(u)?e(s,c?".enable(":".disable(",f,");"):e(t.cond(c).then(s,".enable(",f,");").else(s,".disable(",f,");")),e(a,".",i,"=",c,";")}else if(v(c)){var h=o[i];e(s,".",st[i],"(",c,");",c.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";")}else e(s,".",st[i],"(",c,");",a,".",i,"=",c,";")}}))}function U(t,e){tt&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function V(t,e,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(t){t(c=e.def(),"=",o(),";"),"string"==typeof i?t(l,".count+=",i,";"):t(l,".count++;"),d&&(r?t(f=e.def(),"=",v,".getNumPendingQueries();"):t(v,".beginQuery(",l,");"))}function s(t){t(l,".cpuTime+=",o(),"-",c,";"),d&&(r?t(v,".pushScopeStats(",f,",",v,".getNumPendingQueries(),",l,");"):t(v,".endQuery();"))}function u(t){var n=e.def(p,".profile");e(p,".profile=",t,";"),e.exit(p,".profile=",n,";")}var c,f,h=t.shared,l=t.stats,p=h.current,v=h.timer;if(n=n.profile){if(C(n))return void(n.enable?(a(e),s(e.exit),u("true")):u("false"));u(n=n.append(t,e))}else n=e.def(p,".profile");a(h=t.block()),e("if(",n,"){",h,"}"),s(t=t.block()),e.exit("if(",n,"){",t,"}")}function q(t,e,n,r,i){function o(n,r,i){function o(){e("if(!",f,".buffer){",u,".enableVertexAttribArray(",c,");}");var n,o=i.type;n=i.size?e.def(i.size,"||",r):r,e("if(",f,".type!==",o,"||",f,".size!==",n,"||",p.map((function(t){return f+"."+t+"!=="+i[t]})).join("||"),"){",u,".bindBuffer(",34962,",",h,".buffer);",u,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",f,".type=",o,";",f,".size=",n,";",p.map((function(t){return f+"."+t+"="+i[t]+";"})).join(""),"}"),tt&&(o=i.divisor,e("if(",f,".divisor!==",o,"){",t.instancing,".vertexAttribDivisorANGLE(",[c,o],");",f,".divisor=",o,";}"))}function s(){e("if(",f,".buffer){",u,".disableVertexAttribArray(",c,");",f,".buffer=null;","}if(",wt.map((function(t,e){return f+"."+t+"!=="+l[e]})).join("||"),"){",u,".vertexAttrib4f(",c,",",l,");",wt.map((function(t,e){return f+"."+t+"="+l[e]+";"})).join(""),"}")}var u=a.gl,c=e.def(n,".location"),f=e.def(a.attributes,"[",c,"]");n=i.state;var h=i.buffer,l=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];1===n?o():2===n?s():(e("if(",n,"===",1,"){"),o(),e("}else{"),s(),e("}"))}var a=t.shared;r.forEach((function(r){var a,s=r.name,u=n.attributes[s];if(u){if(!i(u))return;a=u.append(t,e)}else{if(!i(xt))return;var c=t.scopeAttrib(s);a={},Object.keys(new $).forEach((function(t){a[t]=e.def(c,".",t)}))}o(t.link(r),function(t){switch(t){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(r.info.type),a)}))}function z(t,n,r,o,a){for(var s,u=t.shared,c=u.gl,f=0;f<o.length;++f){var h,l=(g=o[f]).name,p=g.info.type,d=r.uniforms[l],g=t.link(g)+".location";if(d){if(!a(d))continue;if(C(d)){if(l=d.value,35678===p||35680===p)n(c,".uniform1i(",g,",",(p=t.link(l._texture||l.color[0]._texture))+".bind());"),n.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)d=2,35675===p?d=3:35676===p&&(d=4),n(c,".uniformMatrix",d,"fv(",g,",false,",l=t.global.def("new Float32Array(["+Array.prototype.slice.call(l)+"])"),");");else{switch(p){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}n(c,".uniform",s,"(",g,",",v(l)?Array.prototype.slice.call(l):l,");")}continue}h=d.append(t,n)}else{if(!a(xt))continue;h=n.def(u.uniforms,"[",e.id(l),"]")}switch(35678===p?n("if(",h,"&&",h,'._reglType==="framebuffer"){',h,"=",h,".color[0];","}"):35680===p&&n("if(",h,"&&",h,'._reglType==="framebufferCube"){',h,"=",h,".color[0];","}"),l=1,p){case 35678:case 35680:p=n.def(h,"._texture"),n(c,".uniform1i(",g,",",p,".bind());"),n.exit(p,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",l=2;break;case 35668:case 35672:s="3i",l=3;break;case 35669:case 35673:s="4i",l=4;break;case 5126:s="1f";break;case 35664:s="2f",l=2;break;case 35665:s="3f",l=3;break;case 35666:s="4f",l=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(n(c,".uniform",s,"(",g,","),"M"===s.charAt(0)){g=Math.pow(p-35674+2,2);var y=t.global.def("new Float32Array(",g,")");Array.isArray(h)?n("false,(",i(g,(function(t){return y+"["+t+"]="+h[t]})),",",y,")"):n("false,(Array.isArray(",h,")||",h," instanceof Float32Array)?",h,":(",i(g,(function(t){return y+"["+t+"]="+h+"["+t+"]"})),",",y,")")}else n(1<l?i(l,(function(t){return Array.isArray(h)?h[t]:h+"["+t+"]"})):h);n(");")}}function G(t,e,n,r){function i(i){var o=l[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(h,".",i)}function o(){function t(){n(u,".drawElementsInstancedANGLE(",[d,g,y,v+"<<(("+y+"-5121)>>1)",s],");")}function e(){n(u,".drawArraysInstancedANGLE(",[d,v,g,s],");")}p?m?t():(n("if(",p,"){"),t(),n("}else{"),e(),n("}")):e()}function a(){function t(){n(f+".drawElements("+[d,g,y,v+"<<(("+y+"-5121)>>1)"]+");")}function e(){n(f+".drawArrays("+[d,v,g]+");")}p?m?t():(n("if(",p,"){"),t(),n("}else{"),e(),n("}")):e()}var s,u,c=t.shared,f=c.gl,h=c.draw,l=r.draw,p=function(){var i=l.elements,o=e;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(t,o)):i=o.def(h,".","elements"),i&&o("if("+i+")"+f+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),d=i("primitive"),v=i("offset"),g=function(){var i=l.count,o=e;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(t,o)):i=o.def(h,".","count"),i}();if("number"==typeof g){if(0===g)return}else n("if(",g,"){"),n.exit("}");tt&&(s=i("instances"),u=t.instancing);var y=p+".type",m=l.elements&&C(l.elements);tt&&("number"!=typeof s||0<=s)?"string"==typeof s?(n("if(",s,">0){"),o(),n("}else if(",s,"<0){"),a(),n("}")):o():a()}function H(t,e,n,r,i){return i=(e=w()).proc("body",i),tt&&(e.instancing=i.def(e.shared.extensions,".angle_instanced_arrays")),t(e,i,n,r),e.compile().body}function W(t,e,n,r){U(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),q(t,e,n,r.attributes,(function(){return!0}))),z(t,e,n,r.uniforms,(function(){return!0})),G(t,e,e,n)}function K(t,e,n,r){function i(){return!0}t.batchId="a1",U(t,e),q(t,e,n,r.attributes,i),z(t,e,n,r.uniforms,i),G(t,e,e,n)}function X(t,e,n,r){function i(t){return t.contextDep&&a||t.propDep}function o(t){return!i(t)}U(t,e);var a=n.contextDep,s=e.def(),u=e.def();t.shared.props=u,t.batchId=s;var c=t.scope(),f=t.scope();e(c.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",u,"=","a0","[",s,"];",f,"}",c.exit),n.needsContext&&x(t,f,n.context),n.needsFramebuffer&&S(t,f,n.framebuffer),j(t,f,n.state,i),n.profile&&i(n.profile)&&V(t,f,n,!1,!0),r?(n.useVAO?n.drawVAO?i(n.drawVAO)?f(t.shared.vao,".setVAO(",n.drawVAO.append(t,f),");"):c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):c(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(c(t.shared.vao,".setVAO(null);"),q(t,c,n,r.attributes,o),q(t,f,n,r.attributes,i)),z(t,c,n,r.uniforms,o),z(t,f,n,r.uniforms,i),G(t,c,f,n)):(e=t.global.def("{}"),r=n.shader.progVar.append(t,f),u=f.def(r,".id"),c=f.def(e,"[",u,"]"),f(t.shared.gl,".useProgram(",r,".program);","if(!",c,"){",c,"=",e,"[",u,"]=",t.link((function(e){return H(K,t,n,e,2)})),"(",r,");}",c,".call(this,a0[",s,"],",s,");"))}function Y(t,n){function r(e){var r=n.shader[e];r&&i.set(o.shader,"."+e,r.append(t,i))}var i=t.proc("scope",3);t.batchId="a2";var o=t.shared,a=o.current;x(t,i,n.context),n.framebuffer&&n.framebuffer.append(t,i),R(Object.keys(n.state)).forEach((function(e){var r=n.state[e].append(t,i);v(r)?r.forEach((function(n,r){i.set(t.next[e],"["+r+"]",n)})):i.set(o.next,"."+e,r)})),V(t,i,n,!0,!0),["elements","offset","count","instances","primitive"].forEach((function(e){var r=n.draw[e];r&&i.set(o.draw,"."+e,""+r.append(t,i))})),Object.keys(n.uniforms).forEach((function(r){var a=n.uniforms[r].append(t,i);Array.isArray(a)&&(a="["+a.join()+"]"),i.set(o.uniforms,"["+e.id(r)+"]",a)})),Object.keys(n.attributes).forEach((function(e){var r=n.attributes[e].append(t,i),o=t.scopeAttrib(e);Object.keys(new $).forEach((function(t){i.set(o,"."+t,r[t])}))})),n.scopeVAO&&i.set(o.vao,".targetVAO",n.scopeVAO.append(t,i)),r("vert"),r("frag"),0<Object.keys(n.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}function Q(t,e,n){var r=e.static[n];if(r&&function(t){if("object"==typeof t&&!v(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(B.isDynamic(t[e[n]]))return!0;return!1}}(r)){var i=t.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=t.global.def("{}");o.forEach((function(e){var n=r[e];if(B.isDynamic(n))"function"==typeof n&&(n=r[e]=B.unbox(n)),e=M(n,null),a=a||e.thisDep,u=u||e.propDep,s=s||e.contextDep;else{switch(i(c,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n))}i(";")}})),e.dynamic[n]=new B.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:u,ref:c,append:function(t,e){o.forEach((function(n){var i=r[n];B.isDynamic(i)&&(i=t.invoke(e,i),e(c,".",n,"=",i,";"))}))}}),delete e.static[n]}}var $=f.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var tt=n.angle_instanced_arrays,nt=n.webgl_draw_buffers,rt={dirty:!0,profile:g.profile},it={},ot=[],at={},st={};m("dither",3024),m("blend.enable",3042),b("blend.color","blendColor",[0,0,0,0]),b("blend.equation","blendEquationSeparate",[32774,32774]),b("blend.func","blendFuncSeparate",[1,0,1,0]),m("depth.enable",2929,!0),b("depth.func","depthFunc",513),b("depth.range","depthRange",[0,1]),b("depth.mask","depthMask",!0),b("colorMask","colorMask",[!0,!0,!0,!0]),m("cull.enable",2884),b("cull.face","cullFace",1029),b("frontFace","frontFace",2305),b("lineWidth","lineWidth",1),m("polygonOffset.enable",32823),b("polygonOffset.offset","polygonOffset",[0,0]),m("sample.alpha",32926),m("sample.enable",32928),b("sample.coverage","sampleCoverage",[1,!1]),m("stencil.enable",2960),b("stencil.mask","stencilMask",-1),b("stencil.func","stencilFunc",[519,0,-1]),b("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),b("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),m("scissor.enable",3089),b("scissor.box","scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),b("viewport","viewport",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var ut={gl:t,context:p,strings:e,next:it,current:rt,draw:l,elements:a,buffer:o,shader:h,attributes:f.state,vao:f,uniforms:c,framebuffer:u,extensions:n,timer:d,isBufferArgs:L},ct={primTypes:et,compareFuncs:It,blendFuncs:Et,blendEquations:Z,stencilOps:Tt,glTypes:J,orientationType:At};nt&&(ct.backBuffer=[1029],ct.drawBuffer=i(r.maxDrawbuffers,(function(t){return 0===t?[0]:i(t,(function(t){return 36064+t}))})));var ft=0;return{next:it,current:rt,procs:function(){var t=w(),e=t.proc("poll"),o=t.proc("refresh"),a=t.block();e(a),o(a);var s,u=t.shared,c=u.gl,f=u.next,h=u.current;a(h,".dirty=false;"),S(t,e),S(t,o,null,!0),tt&&(s=t.link(tt)),n.oes_vertex_array_object&&o(t.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var l=0;l<r.maxAttributes;++l){var p=o.def(u.attributes,"[",l,"]"),d=t.cond(p,".buffer");d.then(c,".enableVertexAttribArray(",l,");",c,".bindBuffer(",34962,",",p,".buffer.buffer);",c,".vertexAttribPointer(",l,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(c,".disableVertexAttribArray(",l,");",c,".vertexAttrib4f(",l,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),o(d),tt&&o(s,".vertexAttribDivisorANGLE(",l,",",p,".divisor);")}return o(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(at).forEach((function(n){var r=at[n],i=a.def(f,".",n),s=t.block();s("if(",i,"){",c,".enable(",r,")}else{",c,".disable(",r,")}",h,".",n,"=",i,";"),o(s),e("if(",i,"!==",h,".",n,"){",s,"}")})),Object.keys(st).forEach((function(n){var r,s,u=st[n],l=rt[n],p=t.block();p(c,".",u,"("),v(l)?(u=l.length,r=t.global.def(f,".",n),s=t.global.def(h,".",n),p(i(u,(function(t){return r+"["+t+"]"})),");",i(u,(function(t){return s+"["+t+"]="+r+"["+t+"];"})).join("")),e("if(",i(u,(function(t){return r+"["+t+"]!=="+s+"["+t+"]"})).join("||"),"){",p,"}")):(r=a.def(f,".",n),s=a.def(h,".",n),p(r,");",h,".",n,"=",r,";"),e("if(",r,"!==",s,"){",p,"}")),o(p)})),t.compile()}(),compile:function(t,e,n,r,i){var o=w();o.stats=o.link(i),Object.keys(e.static).forEach((function(t){Q(o,e,t)})),_t.forEach((function(e){Q(o,t,e)}));var a=A(t,e,n,r);return function(t,e){var n=t.proc("draw",1);U(t,n),x(t,n,e.context),S(t,n,e.framebuffer),k(t,n,e),j(t,n,e.state),V(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)W(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(n){return H(W,t,e,n,1)})),"(",r,");",a,".call(this,a0);"))}0<Object.keys(e.state).length&&n(t.shared.current,".dirty=true;")}(o,a),Y(o,a),function(t,e){function n(t){return t.contextDep&&i||t.propDep}var r=t.proc("batch",2);t.batchId="0",U(t,r);var i=!1,o=!0;Object.keys(e.context).forEach((function(t){i=i||e.context[t].propDep})),i||(x(t,r,e.context),o=!1);var a=!1;if((s=e.framebuffer)?(s.propDep?i=a=!0:s.contextDep&&i&&(a=!0),a||S(t,r,s)):S(t,r,null),e.state.viewport&&e.state.viewport.propDep&&(i=!0),k(t,r,e),j(t,r,e.state,(function(t){return!n(t)})),e.profile&&n(e.profile)||V(t,r,e,!1,"a1"),e.contextDep=i,e.needsContext=o,e.needsFramebuffer=a,(o=e.shader.progVar).contextDep&&i||o.propDep)X(t,r,e,null);else if(o=o.append(t,r),r(t.shared.gl,".useProgram(",o,".program);"),e.shader.program)X(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var s=t.global.def("{}"),u=(a=r.def(o,".id"),r.def(s,"[",a,"]"));r(t.cond(u).then(u,".call(this,a0,a1);").else(u,"=",s,"[",a,"]=",t.link((function(n){return H(X,t,e,n,2)})),"(",o,");",u,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&r(t.shared.current,".dirty=true;")}(o,a),F(o.compile(),{destroy:function(){a.shader.program.destroy()}})}}}function U(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}var F=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},V=0,B={DynamicVariable:t,define:function(n,r){return new t(n,e(r+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof t},unbox:function e(n,r){return"function"==typeof n?new t(0,n):"number"==typeof n||"boolean"==typeof n?new t(5,n):Array.isArray(n)?new t(6,n.map((function(t,n){return e(t,r+"["+n+"]")}))):n instanceof t?n:void 0},accessor:e},q={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},z="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},G=a();G.zero=a();var H=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(34047));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(34852),i=t.getParameter(36063));var o=!!e.oes_texture_float;if(o){o=t.createTexture(),t.bindTexture(3553,o),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var a=t.createFramebuffer();if(t.bindFramebuffer(36160,a),t.framebufferTexture2D(36160,36064,3553,o,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var s=G.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,s),t.getError()?o=!1:(t.deleteFramebuffer(a),t.deleteTexture(o),o=1===s[0]),G.freeType(s)}}return s=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=t.createTexture(),a=G.allocType(5121,36),t.activeTexture(33984),t.bindTexture(34067,s),t.texImage2D(34069,0,6408,3,3,0,6408,5121,a),G.freeType(a),t.bindTexture(34067,null),t.deleteTexture(s),s=!t.getError()),{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:o,npotTextureCube:s}},W=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},K=function(t){return Object.keys(t).map((function(e){return t[e]}))},X={shape:function(t){for(var e=[];t.length;t=t[0])e.push(t.length);return e},flatten:function(t,e,n,r){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;switch(n=r||G.allocType(n,i),e.length){case 0:break;case 1:for(r=e[0],e=0;e<r;++e)n[e]=t[e];break;case 2:for(r=e[0],e=e[1],o=i=0;o<r;++o)for(var a=t[o],s=0;s<e;++s)n[i++]=a[s];break;case 3:u(t,e[0],e[1],e[2],n,0);break;default:!function t(e,n,r,i,o){for(var a=1,s=r+1;s<n.length;++s)a*=n[s];var c=n[r];if(4==n.length-r){var f=n[r+1],h=n[r+2];for(n=n[r+3],s=0;s<c;++s)u(e[s],f,h,n,i,o),o+=a}else for(s=0;s<c;++s)t(e[s],n,r+1,i,o),o+=a}(t,e,0,n,0)}return n}},Y={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},J={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Q={dynamic:35048,stream:35040,static:35044},$=X.flatten,Z=X.shape,tt=[];tt[5120]=1,tt[5122]=2,tt[5124]=4,tt[5121]=1,tt[5123]=2,tt[5125]=4,tt[5126]=4;var et={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},nt=new Float32Array(1),rt=new Uint32Array(nt.buffer),it=[9984,9986,9985,9987],ot=[0,6409,6410,6407,6408],at={};at[6409]=at[6406]=at[6402]=1,at[34041]=at[6410]=2,at[6407]=at[35904]=3,at[6408]=at[35906]=4;var st=g("HTMLCanvasElement"),ut=g("OffscreenCanvas"),ct=g("CanvasRenderingContext2D"),ft=g("ImageBitmap"),ht=g("HTMLImageElement"),lt=g("HTMLVideoElement"),pt=Object.keys(Y).concat([st,ut,ct,ft,ht,lt]),dt=[];dt[5121]=1,dt[5126]=4,dt[36193]=2,dt[5123]=2,dt[5125]=4;var vt=[];vt[32854]=2,vt[32855]=2,vt[36194]=2,vt[34041]=4,vt[33776]=.5,vt[33777]=.5,vt[33778]=1,vt[33779]=1,vt[35986]=.5,vt[35987]=1,vt[34798]=1,vt[35840]=.5,vt[35841]=.25,vt[35842]=.5,vt[35843]=.25,vt[36196]=.5;var gt=[];gt[32854]=2,gt[32855]=2,gt[36194]=2,gt[33189]=2,gt[36168]=1,gt[34041]=4,gt[35907]=4,gt[34836]=16,gt[34842]=8,gt[34843]=6;var yt=function(t,e,n,r,i){function o(t){this.id=c++,this.refCount=1,this.renderbuffer=t,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(e){var n=e.renderbuffer;t.bindRenderbuffer(36161,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete f[e.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(s.srgba=35907),e.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),e.webgl_color_buffer_float&&(s.rgba32f=34836);var u=[];Object.keys(s).forEach((function(t){u[s[t]]=t}));var c=0,f={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(f).forEach((function(e){t+=f[e].stats.size})),t}),{create:function(e,n){function a(e,n){var r=0,o=0,f=32854;if("object"==typeof e&&e?("shape"in e?(r=0|(o=e.shape)[0],o=0|o[1]):("radius"in e&&(r=o=0|e.radius),"width"in e&&(r=0|e.width),"height"in e&&(o=0|e.height)),"format"in e&&(f=s[e.format])):"number"==typeof e?(r=0|e,o="number"==typeof n?0|n:r):e||(r=o=1),r!==c.width||o!==c.height||f!==c.format)return a.width=c.width=r,a.height=c.height=o,c.format=f,t.bindRenderbuffer(36161,c.renderbuffer),t.renderbufferStorage(36161,f,r,o),i.profile&&(c.stats.size=gt[c.format]*c.width*c.height),a.format=u[c.format],a}var c=new o(t.createRenderbuffer());return f[c.id]=c,r.renderbufferCount++,a(e,n),a.resize=function(e,n){var r=0|e,o=0|n||r;return r===c.width&&o===c.height||(a.width=c.width=r,a.height=c.height=o,t.bindRenderbuffer(36161,c.renderbuffer),t.renderbufferStorage(36161,c.format,r,o),i.profile&&(c.stats.size=gt[c.format]*c.width*c.height)),a},a._reglType="renderbuffer",a._renderbuffer=c,i.profile&&(a.stats=c.stats),a.destroy=function(){c.decRef()},a},clear:function(){K(f).forEach(a)},restore:function(){K(f).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,e.renderbuffer),t.renderbufferStorage(36161,e.format,e.width,e.height)})),t.bindRenderbuffer(36161,null)}}},mt=[];mt[6408]=4,mt[6407]=3;var bt=[];bt[5121]=1,bt[5126]=4,bt[36193]=2;var wt=["x","y","z","w"],_t="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Et={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},It={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Tt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},At={cw:2304,ccw:2305},xt=new D(!1,!1,!1,(function(){}));return function(t){function e(){if(0===Q.length)A&&A.update(),et=null;else{et=q.next(e),d();for(var t=Q.length-1;0<=t;--t){var n=Q[t];n&&n(R,null,0)}y.flush(),A&&A.update()}}function i(){!et&&0<Q.length&&(et=q.next(e))}function o(){et&&(q.cancel(e),et=null)}function a(t){t.preventDefault(),o(),$.forEach((function(t){t()}))}function s(t){y.getError(),b.restore(),V.restore(),C.restore(),G.restore(),W.restore(),K.restore(),P.restore(),A&&A.restore(),X.procs.refresh(),i(),Z.forEach((function(t){t()}))}function u(t){function e(t,e){var n={},r={};return Object.keys(t).forEach((function(i){var o=t[i];if(B.isDynamic(o))r[i]=B.unbox(o,i);else{if(e&&Array.isArray(o))for(var a=0;a<o.length;++a)if(B.isDynamic(o[a]))return void(r[i]=B.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}var n=e(t.context||{},!0),r=e(t.uniforms||{},!0),i=e(t.attributes||{},!1);t=e(function(t){function e(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(r){n[t+"."+r]=e[r]}))}}var n=F({},t);return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),e("blend"),e("depth"),e("cull"),e("stencil"),e("polygonOffset"),e("scissor"),e("sample"),"vao"in t&&(n.vao=t.vao),n}(t),!1);var o={gpuTime:0,cpuTime:0,count:0},a=X.compile(t,i,r,n,o),s=a.draw,u=a.batch,c=a.scope,f=[];return F((function(t,e){var n;if("function"==typeof t)return c.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)c.call(this,null,e,n);else{if(!Array.isArray(t))return c.call(this,t,e,0);for(n=0;n<t.length;++n)c.call(this,t[n],e,n)}else if("number"==typeof t){if(0<t)return u.call(this,function(t){for(;f.length<t;)f.push(null);return f}(0|t),0|t)}else{if(!Array.isArray(t))return s.call(this,t);if(t.length)return u.call(this,t,t.length)}}),{stats:o,destroy:function(){a.destroy()}})}function c(t,e){var n=0;X.procs.poll();var r=e.color;r&&(y.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in e&&(y.clearDepth(+e.depth),n|=256),"stencil"in e&&(y.clearStencil(0|e.stencil),n|=1024),y.clear(n)}function f(t){return Q.push(t),i(),{cancel:function(){var e=U(Q,t);Q[e]=function t(){var e=U(Q,t);Q[e]=Q[Q.length-1],--Q.length,0>=Q.length&&o()}}}}function h(){var t=Y.viewport,e=Y.scissor_box;t[0]=t[1]=e[0]=e[1]=0,R.viewportWidth=R.framebufferWidth=R.drawingBufferWidth=t[2]=e[2]=y.drawingBufferWidth,R.viewportHeight=R.framebufferHeight=R.drawingBufferHeight=t[3]=e[3]=y.drawingBufferHeight}function d(){R.tick+=1,R.time=g(),h(),X.procs.poll()}function v(){G.refresh(),h(),X.procs.refresh(),A&&A.update()}function g(){return(z()-O)/1e3}if(!(t=function(t){var e,i,o,a,s=t||{};t={};var u=[],c=[],f="undefined"==typeof window?1:window.devicePixelRatio,h=!1,l=function(t){},p=function(){};if("string"==typeof s?e=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?e=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?o=(a=s).canvas:("gl"in s?a=s.gl:"canvas"in s?o=r(s.canvas):"container"in s&&(i=r(s.container)),"attributes"in s&&(t=s.attributes),"extensions"in s&&(u=n(s.extensions)),"optionalExtensions"in s&&(c=n(s.optionalExtensions)),"onDone"in s&&(l=s.onDone),"profile"in s&&(h=!!s.profile),"pixelRatio"in s&&(f=+s.pixelRatio))),e&&("canvas"===e.nodeName.toLowerCase()?o=e:i=e),!a){if(!o){if(!(e=function(t,e,n){function r(){var e=window.innerWidth,r=window.innerHeight;t!==document.body&&(e=(r=t.getBoundingClientRect()).right-r.left,r=r.bottom-r.top),o.width=n*e,o.height=n*r,F(o.style,{width:e+"px",height:r+"px"})}var i,o=document.createElement("canvas");return F(o.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(o),t===document.body&&(o.style.position="absolute",F(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(r)}))).observe(t):window.addEventListener("resize",r,!1),r(),{canvas:o,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",r),t.removeChild(o)}}}(i||document.body,0,f)))return null;o=e.canvas,p=e.onDestroy}void 0===t.premultipliedAlpha&&(t.premultipliedAlpha=!0),a=function(t,e){function n(n){try{return t.getContext(n,e)}catch(o){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(o,t)}return a?{gl:a,canvas:o,container:i,extensions:u,optionalExtensions:c,pixelRatio:f,profile:h,onDone:l,onDestroy:p}:(p(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(t)))return null;var y=t.gl,m=y.getContextAttributes();y.isContextLost();var b=function(t,e){function n(e){var n;e=e.toLowerCase();try{n=r[e]=t.getExtension(e)}catch(i){}return!!n}for(var r={},i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!n(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach((function(t){if(r[t]&&!n(t))throw Error("(regl): error restoring extension "+t)}))}}}(y,t);if(!b)return null;var w=function(){var t={"":0},e=[""];return{id:function(n){var r=t[n];return r||(r=t[n]=e.length,e.push(n),r)},str:function(t){return e[t]}}}(),_={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},E=b.extensions,A=function(t,e){function n(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function r(t,e,r){var i=a.pop()||new n;i.startQueryIndex=t,i.endQueryIndex=e,i.sum=0,i.stats=r,s.push(i)}if(!e.ext_disjoint_timer_query)return null;var i=[],o=[],a=[],s=[],u=[],c=[];return{beginQuery:function(t){var n=i.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(35007,n),o.push(n),r(o.length-1,o.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:r,update:function(){var t,n;if(0!==(t=o.length)){c.length=Math.max(c.length,t+1),u.length=Math.max(u.length,t+1),u[0]=0;var r=c[0]=0;for(n=t=0;n<o.length;++n){var f=o[n];e.ext_disjoint_timer_query.getQueryObjectEXT(f,34919)?(r+=e.ext_disjoint_timer_query.getQueryObjectEXT(f,34918),i.push(f)):o[t++]=f,u[n+1]=r,c[n+1]=t}for(o.length=t,n=t=0;n<s.length;++n){var h=(r=s[n]).startQueryIndex;f=r.endQueryIndex,r.sum+=u[f]-u[h],h=c[h],(f=c[f])===h?(r.stats.gpuTime+=r.sum/1e6,a.push(r)):(r.startQueryIndex=h,r.endQueryIndex=f,s[t++]=r)}s.length=t}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var t=0;t<i.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(i[t]);o.length=0,i.length=0},restore:function(){o.length=0,i.length=0}}}(0,E),O=z(),N=y.drawingBufferWidth,L=y.drawingBufferHeight,R={tick:0,time:0,viewportWidth:N,viewportHeight:L,framebufferWidth:N,framebufferHeight:L,drawingBufferWidth:N,drawingBufferHeight:L,pixelRatio:t.pixelRatio},D=H(y,E),C=l(y,_,t,(function(t){return P.destroyBuffer(t)})),P=x(y,E,D,_,C),M=p(y,E,C,_),V=S(y,w,_,t),G=I(y,E,D,(function(){X.procs.poll()}),R,_,t),W=yt(y,E,0,_,t),K=T(y,E,D,G,W,_),X=j(y,w,E,D,C,M,0,K,{},P,V,{elements:null,primitive:4,count:-1,offset:0,instances:-1},R,A,t),Y=(w=k(y,K,X.procs.poll,R),X.next),J=y.canvas,Q=[],$=[],Z=[],tt=[t.onDestroy],et=null;J&&(J.addEventListener("webglcontextlost",a,!1),J.addEventListener("webglcontextrestored",s,!1));var nt=K.setFBO=u({framebuffer:B.define.call(null,1,"framebuffer")});return v(),m=F(u,{clear:function(t){if("framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;6>e;++e)nt(F({framebuffer:t.framebuffer.faces[e]},t),c);else nt(t,c);else c(0,t)},prop:B.define.bind(null,1),context:B.define.bind(null,2),this:B.define.bind(null,3),draw:u({}),buffer:function(t){return C.create(t,34962,!1,!1)},elements:function(t){return M.create(t,!1)},texture:G.create2D,cube:G.createCube,renderbuffer:W.create,framebuffer:K.create,framebufferCube:K.createCube,vao:P.createVAO,attributes:m,frame:f,on:function(t,e){var n;switch(t){case"frame":return f(e);case"lost":n=$;break;case"restore":n=Z;break;case"destroy":n=tt}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e){n[t]=n[n.length-1],n.pop();break}}}},limits:D,hasExtension:function(t){return 0<=D.extensions.indexOf(t.toLowerCase())},read:w,destroy:function(){Q.length=0,o(),J&&(J.removeEventListener("webglcontextlost",a),J.removeEventListener("webglcontextrestored",s)),V.clear(),K.clear(),W.clear(),G.clear(),M.clear(),C.clear(),P.clear(),A&&A.clear(),tt.forEach((function(t){t()}))},_gl:y,_refresh:v,poll:function(){d(),A&&A.update()},now:g,stats:_}),t.onDone(null,m),m}},"object"==typeof y.exports?y.exports=g():"function"==typeof define&&define.amd?define(g):this.createREGL=g(),y=y.exports;var m;(m=function(t){if(Array.isArray(t))return t}).default=m,m.__esModule=!0;var b;(b=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}).default=b,b.__esModule=!0;var w;(w=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}).default=w,w.__esModule=!0;var _;(_=function(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}).default=_,_.__esModule=!0;var E;(E=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}).default=E,E.__esModule=!0;var I;(I=function(t,e){return m(t)||b(t,e)||_(t,e)||E()}).default=I,I.__esModule=!0;var T;(T=function(t){if(Array.isArray(t))return w(t)}).default=T,T.__esModule=!0;var A;(A=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}).default=A,A.__esModule=!0;var x;(x=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}).default=x,x.__esModule=!0;var S;(S=function(t){return T(t)||A(t)||_(t)||x()}).default=S,S.__esModule=!0;var k=u(I),O=u(S),N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return t.map((function(t){return[(i*t[e]+n)/2,(i*t[1-e]+r)/2]}))};function L(t,e,n){e=.5-e/4,n*=Math.pow(4,t),console.time("hilbert");var r=function t(e){if(1===e)return N([[0,0],[0,1],[1,1],[1,0]],0,.5,.5);var n=t(e-1);return[].concat((0,O.default)(N(n,1,0,0)),(0,O.default)(N(n,0,0,1)),(0,O.default)(N(n,0,1,1)),(0,O.default)(N(n,1,2,1,-1)))}(t);console.timeEnd("hilbert"),r.unshift(r[3]),r.push(r[r.length-4]),console.time("dir");for(var i=[],o=0;o<r.length-2;o++){var a=r[o],s=r[o+1],u=r[o+2],c=[s[0]-a[0],s[1]-a[1]],f=[u[0]-s[0],u[1]-s[1]];i[o]={p0:a,p1:s,p2:u,s:Math.sign(c[0]*f[1]-c[1]*f[0])}}console.timeEnd("dir");var h=i.slice(0).reverse();h=h.map((function(t){var e=t.p0,n=t.p1;return{p0:t.p2,p1:n,p2:e,s:-t.s}})),t%2?i.splice(-3):h.splice(0,3),i=i.concat(h);var l=function(t){-1===i[t+1].s&&-1===i[t+2].s&&(i[t].s--,i[t+3].s--,i[t].p2=i[t+3].p1,i[t+3].p0=i[t].p1,i.splice(t+1,2))};console.time("rnd wall");for(var p=0;p<n;p++){for(var d=Math.floor(Math.random()*(i.length-3));-1!==i[d+1].s||-1!==i[d+2].s;)d=(d+1)%(i.length-3);l(d)}console.timeEnd("rnd wall"),console.time("pretty wall");for(var v=0;v<i.length-3;v++)1!==i[v].s&&1!==i[v+3].s||l(v);console.timeEnd("pretty wall");var g=[];return console.time("border"),i.map((function(t){var n=t.p0,r=t.p1,i=t.p2,o=t.s,a=[(r[0]-n[0])*e,(r[1]-n[1])*e],s=[(i[0]-r[0])*e,(i[1]-r[1])*e];0!==o&&g.push([r[0]+o*(a[0]-s[0]),r[1]+o*(a[1]-s[1])])})),console.timeEnd("border"),t%2?g.splice(0,1,g[g.length-1]):g.splice(-1,1,g[0]),g}function R(t,e,n,r,i,o){for(var a=e.slice(n,r).reverse(),s=e.slice(i,o),u=a.length/s.length;a.length>0&&s.length>0;)t.push(a.length/s.length>u?a.pop():s.pop());for(;a.length>0;)t.push(a.pop());for(;s.length>0;)t.push(s.pop());return t}function D(t,e,n){console.time("gen grid");var r=function(t){return console.time("split segments"),t=t.map((function(t){var e=Math.hypot(t[1][0]-t[0][0],t[1][1]-t[0][1]);if((e=Math.ceil(e/8-.3))<=0)return{parts:[t],seg:t};for(var n=[],r=0;r<=1;r+=1/e)n.push([t[0][0]*(1-r)+t[1][0]*r,t[0][1]*(1-r)+t[1][1]*r]);return{seg:t,parts:n.slice(0,-1).map((function(t,e){return[t,n[e+1]]}))}})),console.timeEnd("split segments"),t}(t),i=Math.pow(2,e),o=Array(i*i).fill().map((function(){return[]})),a=Array(i*i).fill().map((function(){return[]}));r.map((function(t){var e=t.seg;return t.parts.map((function(t){for(var r=0,s=[Math.round(t[0][0]/n-.5)+Math.round(t[0][1]/n-.5)*i,Math.round(t[1][0]/n-.5)+Math.round(t[1][1]/n-.5)*i,Math.round((t[0][0]+t[1][0])/2/n-.5)+Math.round((t[0][1]+t[1][1])/2/n-.5)*i];r<s.length;r++){var u=s[r];o[u]||(o[u]=[]),o[u].includes(e)||o[u].push(e),a[u]||(a[u]=[]),a[u].includes(t)||a[u].push(t)}}))}));var s=r.flatMap((function(t){return t.parts})),u=(s=function(t,e){var n;console.time("reorder placements");var r=t;t=[];for(var i=0,o=r.length-1,a=[],s=[],u=0,c=function(){var n=Math.floor((r[i][0][0]+r[i][1][0])/4/e),c=Math.floor((r[i][0][1]+r[i][1][1])/4/e),f=Math.floor((r[o][0][0]+r[o][1][0])/4/e),h=Math.floor((r[o][0][1]+r[o][1][1])/4/e);if(n==f&&c==h)R(t,r,i-u,i+1,o,o+u+1),a=[],s=[],u=0;else{var l=s.findIndex((function(t){var e=(0,k.default)(t,2),r=e[0],i=e[1];return r===n&&i===c})),p=a.findIndex((function(t){var e=(0,k.default)(t,2),n=e[0],r=e[1];return n===f&&r===h}));-1!==l?(R(t,r,i-u,i+1,o+u-l,o+u+1),o+=u-l,a=[],s=[],u=0):-1!==p?(R(t,r,i-u,i-u+p+1,o,o+u+1),i-=u-p,a=[],s=[],u=0):(a.push([n,c]),s.push([f,h]),u++)}i++,o--};i<o;)c();return(n=t).push.apply(n,(0,O.default)(r.slice(i-u,o+u+1))),console.timeEnd("reorder placements"),t}(s=s.filter((function(t){var e=(0,k.default)(t,2),n=(0,k.default)(e[0],2),r=n[0],i=n[1],o=(0,k.default)(e[1],2),a=o[0],s=o[1];return Math.hypot(r-a,i-s)>1})),n)).map((function(t){return[(Math.round((t[0][0]+t[1][0])/2/n+.5)-.5)*n,(Math.round((t[0][1]+t[1][1])/2/n+.5)-.5)*n]}));return console.timeEnd("gen grid"),{getGridSegments:function(t,e){return o[Math.round(t/n-.5)+Math.round(e/n-.5)*i]||[]},getGridParts:function(t,e){return a[Math.round(t/n-.5)+Math.round(e/n-.5)*i]||[]},getAreaIndex:function(t,e){var r=u.findIndex((function(r){return Math.abs(r[0]-t)<n/2&&Math.abs(r[1]-e)<n/2}));return-1===r&&(r=u.findIndex((function(r){return Math.abs(r[0]-t)+Math.abs(r[1]-e)<n}))),r},placements:s}}var C,P,M=u(h),j=u(l),U=(C=(0,j.default)(M.default.mark((function t(e,n){var r,i,o;return M.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n);case 2:return r=t.sent,t.next=5,r.blob();case 5:return i=t.sent,t.next=8,createImageBitmap(i);case 8:o=t.sent,e({data:o,wrapS:"repeat",wrapT:"repeat"});case 10:case"end":return t.stop()}}),t)}))),function(t,e){return C.apply(this,arguments)});(P=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}).default=P,P.__esModule=!0;var F={exports:{}};(function(t){(function(){var e,n,r,i,o,a,s,u,c,f,h,l,p,v,g,y,m,b,w,_,E,I,T;!function(e){var n="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:{};function r(t,e){return t!==n&&("function"==typeof Object.create?Object.defineProperty(t,"__esModule",{value:!0}):t.__esModule=!0),function(n,r){return t[n]=e?e(n,r):r}}"function"==typeof define&&define.amd?define("tslib",["exports"],(function(t){e(r(n,r(t)))})):"object"==typeof F.exports?e(r(n,r(F.exports))):e(r(n))}((function(t){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};e=function(t,e){function n(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},i=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},o=function(t,e){return function(n,r){e(n,r,t)}},a=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(d){o(d)}}function s(t){try{u(r.throw(t))}catch(d){o(d)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(d){o=[6,d],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},T=function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]},c=function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])},f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},l=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t},p=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},v=function(t){return this instanceof v?(this.v=t,this):new v(t)},g=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof v?Promise.resolve(n.value.v).then(u,c):f(o[0][2],n)}catch(d){f(o[0][3],d)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function f(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}},y=function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:v(t[r](e)),done:"return"===r}:i?i(e):e}:i}},m=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=f(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}},b=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},w=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},_=function(t){return t&&t.__esModule?t:{default:t}},E=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},I=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},t("__extends",e),t("__assign",n),t("__rest",r),t("__decorate",i),t("__param",o),t("__metadata",a),t("__awaiter",s),t("__generator",u),t("__exportStar",c),t("__createBinding",T),t("__values",f),t("__read",h),t("__spread",l),t("__spreadArrays",p),t("__await",v),t("__asyncGenerator",g),t("__asyncDelegator",y),t("__asyncValues",m),t("__makeTemplateObject",b),t("__importStar",w),t("__importDefault",_),t("__classPrivateFieldGet",E),t("__classPrivateFieldSet",I)}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),F=F.exports;var V={};(function(t){(function(){"use strict";Object.defineProperty(V,"__esModule",{value:!0});var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};function n(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&(t[r]=n(t[r],e[r]));return t}var r=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function i(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(d){return!1}}var a=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,s.prototype.create),i}return F.__extends(e,t),e}(Error),s=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(u,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}(o,r):"Error",c=this.serviceName+": "+s+" ("+i+").",f=new a(i,c),h=0,l=Object.keys(r);h<l.length;h++){var p=l[h];"_"!==p.slice(-1)&&(p in f&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),f[p]=r[p])}return f},t}(),u=/\{\$([^}]+)}/g;!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],f=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=f^u&(c^f),a=1518500249):(o=u^c^f,a=1859775393):r<60?(o=u&c|f&(u|c),a=2400959708):(o=u^c^f,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=f,f=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();var c=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=f),void 0===r.error&&(r.error=f),void 0===r.complete&&(r.complete=f);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(d){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(d){"undefined"!=typeof console&&console.error&&console.error(d)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function f(){}V.Deferred=r,V.ErrorFactory=s,V.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},V.createSubscribe=function(t,e){var n=new c(t,e);return n.subscribe.bind(n)},V.deepCopy=function(t){return n(void 0,t)},V.deepExtend=n,V.getUA=i,V.isBrowser=function(){return"object"==typeof self&&self.self===self},V.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},V.isElectron=function(){return i().indexOf("Electron/")>=0},V.isIE=function(){var t=i();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},V.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(i())},V.isNode=o,V.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},V.isUWP=function(){return i().indexOf("MSAppHost/")>=0}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var B={};Object.defineProperty(B,"__esModule",{value:!0});var q=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),z=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new V.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(d){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=F.__assign({identifier:"[DEFAULT]",optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(d){if(r)return null;throw d}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService("[DEFAULT]")}catch(d){}try{for(var r=F.__values(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=F.__read(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(u);s.resolve(c)}catch(d){}}}catch(f){e={error:f}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return F.__awaiter(this,void 0,void 0,(function(){var t;return F.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(F.__spread(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}(),G=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new z(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();B.Component=q,B.ComponentContainer=G;var H,W={};function K(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}Object.defineProperty(W,"__esModule",{value:!0});var X,Y=[];(X=W.LogLevel||(W.LogLevel={}))[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT";var J={debug:W.LogLevel.DEBUG,verbose:W.LogLevel.VERBOSE,info:W.LogLevel.INFO,warn:W.LogLevel.WARN,error:W.LogLevel.ERROR,silent:W.LogLevel.SILENT},Q=W.LogLevel.INFO,$=((H={})[W.LogLevel.DEBUG]="log",H[W.LogLevel.VERBOSE]="log",H[W.LogLevel.INFO]="info",H[W.LogLevel.WARN]="warn",H[W.LogLevel.ERROR]="error",H),Z=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=$[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,K(["["+i+"]  "+t.name+":"],n))}},tt=function(){function t(t){this.name=t,this._logLevel=Q,this._logHandler=Z,this._userLogHandler=null,Y.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in W.LogLevel))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?J[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,K([this,W.LogLevel.DEBUG],t)),this._logHandler.apply(this,K([this,W.LogLevel.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,K([this,W.LogLevel.VERBOSE],t)),this._logHandler.apply(this,K([this,W.LogLevel.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,K([this,W.LogLevel.INFO],t)),this._logHandler.apply(this,K([this,W.LogLevel.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,K([this,W.LogLevel.WARN],t)),this._logHandler.apply(this,K([this,W.LogLevel.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,K([this,W.LogLevel.ERROR],t)),this._logHandler.apply(this,K([this,W.LogLevel.ERROR],t))},t}();W.Logger=tt,W.setLogLevel=function(t){Y.forEach((function(e){e.setLogLevel(t)}))},W.setUserLogHandler=function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=J[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:W.LogLevel[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=Y;r<i.length;r++)n(i[r])};var et={};Object.defineProperty(et,"__esModule",{value:!0});var nt,rt,it=((nt={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",nt["bad-app-name"]="Illegal App name: '{$appName}",nt["duplicate-app"]="Firebase App named '{$appName}' already exists",nt["app-deleted"]="Firebase App named '{$appName}' already deleted",nt["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",nt["invalid-log-argument"]="First argument to `onLog` must be null or a function.",nt),ot=new V.ErrorFactory("app","Firebase",it),at=((rt={})["@firebase/app"]="fire-core",rt["@firebase/analytics"]="fire-analytics",rt["@firebase/auth"]="fire-auth",rt["@firebase/database"]="fire-rtdb",rt["@firebase/functions"]="fire-fn",rt["@firebase/installations"]="fire-iid",rt["@firebase/messaging"]="fire-fcm",rt["@firebase/performance"]="fire-perf",rt["@firebase/remote-config"]="fire-rc",rt["@firebase/storage"]="fire-gcs",rt["@firebase/firestore"]="fire-fst",rt["fire-js"]="fire-js",rt["firebase-wrapper"]="fire-js-all",rt),st=new W.Logger("@firebase/app"),ut=function(){function t(t,e,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=V.deepCopy(t),this.container=new B.ComponentContainer(e.name),this._addComponent(new B.Component("app",(function(){return o}),"PUBLIC"));try{for(var a=F.__values(this.firebase_.INTERNAL.components.values()),s=a.next();!s.done;s=a.next()){var u=s.value;this._addComponent(u)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(d){st.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,d)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ot.create("app-deleted",{appName:this.name_})},t}();ut.prototype.name&&ut.prototype.options||ut.prototype.delete||console.log("dc");var ct=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){(void 0===i&&(i={}),"object"!=typeof i||null===i)&&(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw ot.create("bad-app-name",{appName:String(a)});if(V.contains(e,a))throw ot.create("duplicate-app",{appName:a});var s=new t(n,o,r);return e[a]=s,s},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=at[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),s=e.match(/\s|\//);if(a||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void st.warn(u.join(" "))}o(new B.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:W.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw ot.create("invalid-log-argument",{appName:name});W.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.20.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||"[DEFAULT]",!V.contains(e,t))throw ot.create("no-app",{appName:t});return e[t]}function o(o){var a,s,u=o.name;if(n.has(u))return st.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===o.type?r[u]:null;if(n.set(u,o),"PUBLIC"===o.type){var c=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[u])throw ot.create("invalid-app-argument",{appName:u});return t[u]()};void 0!==o.serviceProps&&V.deepExtend(c,o.serviceProps),r[u]=c,t.prototype[u]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,u).apply(this,o.multipleInstances?t:[])}}try{for(var f=F.__values(Object.keys(e)),h=f.next();!h.done;h=f.next()){var l=h.value;e[l]._addComponent(o)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}return"PUBLIC"===o.type?r[u]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(ut);return e.INTERNAL=F.__assign(F.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){V.deepExtend(e,t)},createSubscribe:V.createSubscribe,ErrorFactory:V.ErrorFactory,deepExtend:V.deepExtend}),e}(),ft=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(V.isBrowser()&&void 0!==self.firebase){st.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var ht=self.firebase.SDK_VERSION;ht&&ht.indexOf("LITE")>=0&&st.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var lt=ct.initializeApp;ct.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return V.isNode()&&st.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),lt.apply(void 0,t)};var pt=ct;!function(t,e){t.INTERNAL.registerComponent(new B.Component("platform-logger",(function(t){return new ft(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.11",void 0),t.registerVersion("fire-js","")}(pt),et.default=pt,et.firebase=pt;var dt={};var vt=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(et);vt.default.registerVersion("firebase","7.24.0","app"),dt=vt.default;(function(t){(function(){(function(){var e,n=et.default,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t,e];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,e){if(e){var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in n||(n[a]={}),n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.o=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Pa(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Pa(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Pa(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,f=null;function h(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==l(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++b)}var m="closure_uid_"+(1e9*Math.random()>>>0),b=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function _(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:_).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now||function(){return+new Date};function A(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function x(t,e,n){this.code=O+t,this.message=e||N[t]||"",this.a=n||null}function S(t){var e=t&&t.code;return e?new x(e.substring(O.length),t.message,t.serverResponse):null}A(x,Error),x.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},x.prototype.toJSON=function(){return this.w()};var k,O="auth/",N={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},L={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function R(t){for(var e in L)if(L[e].id===t)return{firebaseEndpoint:(t=L[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function D(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function C(t){if(Error.captureStackTrace)Error.captureStackTrace(this,C);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function P(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");C.call(this,n+t[r])}function M(t,e){throw new P("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function j(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function U(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}k=R("__EID__")?"__EID__":void 0,A(C,Error),C.prototype.name="CustomError",A(P,C),P.prototype.name="AssertionError",j.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new j((function(){return new q}),(function(t){t.reset()}));function B(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function q(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},q.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},q.prototype.reset=function(){this.next=this.b=this.a=null};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},K=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function X(t,e){return 0<=z(t,e)}function Y(t,e){var n;return(n=0<=(e=z(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function Q(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Z,tt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,at=/'/g,st=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function ft(t,e){return t<e?-1:t>e?1:0}t:{var ht=u.navigator;if(ht){var lt=ht.userAgent;if(lt){Z=lt;break t}}Z=""}function pt(t){return ct(Z,t)}function dt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var yt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<yt.length;o++)n=yt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(a){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(a){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;M("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function wt(t,e){this.a=t===It&&e||"",this.b=Et}function _t(t){return t instanceof wt&&t.constructor===wt&&t.b===Et?t.a:(M("expected object of type Const, got '"+t+"'"),"type_error:Const")}wt.prototype.sa=!0,wt.prototype.ra=function(){return this.a},wt.prototype.toString=function(){return"Const{"+this.a+"}"};var Et={},It={},Tt=new wt(It,"");function At(t,e){this.a=t===Lt&&e||"",this.b=Nt}function xt(t){return t instanceof At&&t.constructor===At&&t.b===Nt?t.a:(M("expected object of type TrustedResourceUrl, got '"+t+"' of type "+l(t)),"type_error:TrustedResourceUrl")}function St(t,e){var n=_t(t);if(!Ot.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(kt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof wt?_t(t):encodeURIComponent(String(t))})),new At(Lt,t)}At.prototype.sa=!0,At.prototype.ra=function(){return this.a.toString()},At.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,Ot=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Nt={},Lt={};function Rt(t,e){this.a=t===jt&&e||"",this.b=Mt}function Dt(t){return t instanceof Rt&&t.constructor===Rt&&t.b===Mt?t.a:(M("expected object of type SafeUrl, got '"+t+"' of type "+l(t)),"type_error:SafeUrl")}Rt.prototype.sa=!0,Rt.prototype.ra=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ct=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Pt(t){return t instanceof Rt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Ct.test(t)||(t="about:invalid#zClosurez"),new Rt(jt,t))}var Mt={},jt={};function Ut(){this.a="",this.b=Vt}function Ft(t){return t instanceof Ut&&t.constructor===Ut&&t.b===Vt?t.a:(M("expected object of type SafeHtml, got '"+t+"' of type "+l(t)),"type_error:SafeHtml")}Ut.prototype.sa=!0,Ut.prototype.ra=function(){return this.a.toString()},Ut.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Vt={};function Bt(t){var e=new Ut;return e.a=t,e}Bt("<!DOCTYPE html>");var qt=Bt("");function zt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Gt(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(at,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Ht(t){return Ht[" "](t),t}Bt("<br>"),Ht[" "]=h;var Wt,Kt,Xt=pt("Opera"),Yt=pt("Trident")||pt("MSIE"),Jt=pt("Edge"),Qt=Jt||Yt,$t=pt("Gecko")&&!(ct(Z.toLowerCase(),"webkit")&&!pt("Edge"))&&!(pt("Trident")||pt("MSIE"))&&!pt("Edge"),Zt=ct(Z.toLowerCase(),"webkit")&&!pt("Edge");function te(){var t=u.document;return t?t.documentMode:void 0}t:{var ee="",ne=(Kt=Z,$t?/rv:([^\);]+)(\)|;)/.exec(Kt):Jt?/Edge\/([\d\.]+)/.exec(Kt):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Kt):Zt?/WebKit\/(\S+)/.exec(Kt):Xt?/(?:Version)[ \/]?(\S+)/.exec(Kt):void 0);if(ne&&(ee=ne?ne[1]:""),Yt){var re=te();if(null!=re&&re>parseFloat(ee)){Wt=String(re);break t}}Wt=ee}var ie,oe={};function ae(t){return function(t,e){var n=oe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=tt(String(Wt)).split("."),r=tt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ft(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ft(0==a[2].length,0==s[2].length)||ft(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}ie=u.document&&Yt?te():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Kt){}var se=!Yt||9<=Number(ie);function ue(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ce(t,e){dt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:le.hasOwnProperty(n)?t.setAttribute(le[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,he,le={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function pe(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function de(t){if(t&&"number"==typeof t.length){if(g(t))return"function"==typeof t.item||"string"==typeof t.item;if(v(t))return"function"==typeof t.item}return!1}function ve(t){u.setTimeout((function(){throw t}),0)}function ge(t,e){he||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);he=function(){t.then(be)}}else he=function(){var t=be;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!pt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(fe||(fe=function(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!pt("Presto")&&(t=function(){var t,e,n=pe(document,"IFRAME");n.style.display="none",t=n,e=new At(Lt,_t(Tt)),bt(t,"HTMLIFrameElement"),t.src=xt(e).toString(),document.documentElement.appendChild(n);var r=n.contentWindow;(n=r.document).open(),n.write(Ft(qt)),n.close();var i="callImmediate"+Math.random(),o="file:"==r.location.protocol?"*":r.location.protocol+"//"+r.location.host;n=E((function(t){"*"!=o&&t.origin!=o||t.data!=i||this.port1.onmessage()}),this),r.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){r.postMessage(i,o)}}}),void 0!==t&&!pt("Trident")&&!pt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){r.next={Fb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),fe(t)):u.setImmediate(t)}}(),ye||(he(),ye=!0),me.add(t,e)}var ye=!1,me=new F;function be(){for(var t;t=B();){try{t.a.call(t.b)}catch(e){ve(e)}U(V,t)}ye=!1}function we(t,e){if(this.a=_e,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=h)try{var n=this;t.call(e,(function(t){De(n,Ee,t)}),(function(t){if(!(t instanceof Ve))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(d){}De(n,Ie,t)}))}catch(r){De(this,Ie,r)}}var _e=0,Ee=2,Ie=3;function Te(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Te.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ae=new j((function(){return new Te}),(function(t){t.reset()}));function xe(t,e,n){var r=Ae.get();return r.g=t,r.b=e,r.f=n,r}function Se(t){if(t instanceof we)return t;var e=new we(h);return De(e,Ee,t),e}function ke(t){return new we((function(e,n){n(t)}))}function Oe(t,e,n){Ce(t,e,n,null)||ge(I(e,t))}function Ne(t){return new we((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Oe(t[o],I(i,o,!0),I(i,o,!1));else e(r)}))}function Le(t,e){t.b||t.a!=Ee&&t.a!=Ie||Pe(t),t.f?t.f.next=e:t.b=e,t.f=e}function Re(t,e,n,r){var i=xe(null,null,null);return i.a=new we((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(a){o(a)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ve?o(e):t(i)}catch(a){o(a)}}:o})),i.a.c=t,Le(t,i),i.a}function De(t,e,n){t.a==_e&&(t===n&&(e=Ie,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Ce(n,t.Zc,t.$c,t)||(t.i=n,t.a=e,t.c=null,Pe(t),e!=Ie||n instanceof Ve||function(t,e){t.g=!0,ge((function(){t.g&&Fe.call(null,e)}))}(t,n)))}function Ce(t,e,n,r){if(t instanceof we)return Le(t,xe(e||h,n||null,r)),!0;if(D(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(s){o(s)}}(t,i,e,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Pe(t){t.h||(t.h=!0,ge(t.fc,t))}function Me(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function je(t,e,n,r){if(n==Ie&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ue(e,n,r);else try{e.c?e.g.call(e.f):Ue(e,n,r)}catch(d){Fe.call(null,d)}U(Ae,e)}function Ue(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}we.prototype.then=function(t,e,n){return Re(this,v(t)?t:null,v(e)?e:null,n)},we.prototype.$goog_Thenable=!0,(e=we.prototype).na=function(t,e){return(t=xe(t,t,e)).c=!0,Le(this,t),this},e.s=function(t,e){return Re(this,null,t,e)},e.cancel=function(t){if(this.a==_e){var e=new Ve(t);ge((function(){!function t(e,n){if(e.a==_e)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==_e&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Me(r),je(r,o,Ie,n)))}e.c=null}else De(e,Ie,n)}(this,e)}),this)}},e.Zc=function(t){this.a=_e,De(this,Ee,t)},e.$c=function(t){this.a=_e,De(this,Ie,t)},e.fc=function(){for(var t;t=Me(this);)je(this,t,this.a,this.i);this.h=!1};var Fe=ve;function Ve(t){C.call(this,t)}function Be(){0!=qe&&(ze[y(this)]=this),this.xa=this.xa,this.oa=this.oa}A(Ve,C),Ve.prototype.name="cancel";var qe=0,ze={};function Ge(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=qe)){var e=y(t);if(0!=qe&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}Be.prototype.xa=!1,Be.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var He=Object.freeze||function(t){return t},We=!Yt||9<=Number(ie),Ke=Yt&&!ae("9"),Xe=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",h,e),u.removeEventListener("test",h,e)}catch(n){}return t}();function Ye(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Je(t,e){if(Ye.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if($t){t:{try{Ht(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Qe[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ye.prototype.preventDefault=function(){this.defaultPrevented=!0},A(Je,Ye);var Qe=He({2:"touch",3:"pen",4:"mouse"});Je.prototype.preventDefault=function(){Je.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ke)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Je.prototype.g=function(){return this.a};var $e="closure_listenable_"+(1e6*Math.random()|0),Ze=0;function tn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Ze,this.va=this.Oa=!1}function en(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function nn(t){this.src=t,this.a={},this.b=0}function rn(t,e){var n=e.type;n in t.a&&Y(t.a[n],e)&&(en(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function on(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==r)return i}return-1}nn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=on(t,e,r,i);return-1<a?(e=t[a],n||(e.Oa=!1)):((e=new tn(e,this.src,o,!!r,i)).Oa=n,t.push(e)),e};var an="closure_lm_"+(1e6*Math.random()|0),sn={};function un(t,e,n,r,i){if(r&&r.once)fn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,r,i);else n=bn(n),t&&t[$e]?_n(t,e,n,g(r)?!!r.capture:!!r,i):cn(t,e,n,!1,r,i)}function cn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=yn(t);if(s||(t[an]=s=new nn(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=gn,e=We?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Xe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(pn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function fn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);else n=bn(n),t&&t[$e]?En(t,e,n,g(r)?!!r.capture:!!r,i):cn(t,e,n,!0,r,i)}function hn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=bn(n),t&&t[$e]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=on(o=t.a[e],n,r,i))&&(en(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=yn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=on(e,n,r,i)),(n=-1<t?e[t]:null)&&ln(n))}function ln(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[$e])rn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(pn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=yn(e))?(rn(n,t),0==n.b&&(n.src=null,e[an]=null)):en(t)}}}function pn(t){return t in sn?sn[t]:sn[t]="on"+t}function dn(t,e,n,r){var i=!0;if((t=yn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=vn(o,r),i=i&&!1!==o)}return i}function vn(t,e){var n=t.listener,r=t.Ua||t.src;return t.Oa&&ln(t),n.call(r,e)}function gn(t,e){if(t.va)return!0;if(!We){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Je(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(a){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=dn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=dn(r[i],t,!1,e),n=n&&o}return n}return vn(t,new Je(e,this))}function yn(t){return(t=t[an])instanceof nn?t:null}var mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function bn(t){return v(t)?t:(t[mn]||(t[mn]=function(e){return t.handleEvent(e)}),t[mn])}function wn(){Be.call(this),this.v=new nn(this),this.$b=this,this.fb=null}function _n(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function En(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function In(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Ua||a.src;a.Oa&&rn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function Tn(t,e,n){if(v(t))n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function An(t){var e=null;return new we((function(n,r){-1==(e=Tn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).s((function(t){throw u.clearTimeout(e),t}))}function xn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Sn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function kn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof kn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function On(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Nn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Nn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}A(wn,Be),wn.prototype[$e]=!0,wn.prototype.addEventListener=function(t,e,n,r){un(this,t,e,n,r)},wn.prototype.removeEventListener=function(t,e,n,r){hn(this,t,e,n,r)},wn.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var r=t.type||t;if("string"==typeof t)t=new Ye(t,n);else if(t instanceof Ye)t.target=t.target||n;else{var i=t;mt(t=new Ye(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=In(a,r,!0,t)&&i}if(i=In(a=t.b=n,r,!0,t)&&i,i=In(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=In(a=t.b=e[o],r,!1,t)&&i;return i},wn.prototype.Da=function(){if(wn.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)en(n[r]);delete e.a[t],e.b--}}this.fb=null},(e=kn.prototype).V=function(){On(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.Y=function(){return On(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return Nn(this.b,t)?this.b[t]:e},e.set=function(t,e){Nn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ln=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(t,e){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,t instanceof Rn?(this.i=void 0!==e?e:t.i,Dn(this,t.f),this.l=t.l,this.a=t.a,Cn(this,t.g),this.c=t.c,Pn(this,tr(t.b)),this.h=t.h):t&&(n=String(t).match(Ln))?(this.i=!!e,Dn(this,n[1]||"",!0),this.l=Vn(n[2]||""),this.a=Vn(n[3]||"",!0),Cn(this,n[4]),this.c=Vn(n[5]||"",!0),Pn(this,n[6]||"",!0),this.h=Vn(n[7]||"")):(this.i=!!e,this.b=new Xn(null,this.i))}function Dn(t,e,n){t.f=n?Vn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Cn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Pn(t,e,n){e instanceof Xn?(t.b=e,function(t,e){e&&!t.f&&(Yn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qn(this,e),Zn(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Bn(e,Wn)),t.b=new Xn(e,t.i))}function Mn(t,e,n){t.b.set(e,n)}function jn(t,e){return t.b.get(e)}function Un(t){return t instanceof Rn?new Rn(t):new Rn(t,void 0)}function Fn(t,e,n,r){var i=new Rn(null,void 0);return t&&Dn(i,t),e&&(i.a=e),n&&Cn(i,n),r&&(i.c=r),i}function Vn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,qn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Bn(e,zn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Bn(e,zn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Bn(n,"/"==n.charAt(0)?Hn:Gn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Bn(n,Kn)),t.join("")},Rn.prototype.resolve=function(t){var e=new Rn(this),n=!!t.f;n?Dn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.c;if(n)Cn(e,t.g);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.a&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.b.toString(),n?Pn(e,tr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var zn=/[#\/\?@]/g,Gn=/[#\?:]/g,Hn=/[#\?]/g,Wn=/[#\?@]/g,Kn=/#/g;function Xn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Yn(t){t.a||(t.a=new kn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Jn(t){var e=Sn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Xn(null,void 0);t=xn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?Zn(n,i,o):n.add(i,o)}return n}function Qn(t,e){Yn(t),e=er(t,e),Nn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Nn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&On(t)))}function $n(t,e){return Yn(t),e=er(t,e),Nn(t.a.b,e)}function Zn(t,e,n){Qn(t,e),0<n.length&&(t.c=null,t.a.set(er(t,e),$(n)),t.b+=n.length)}function tr(t){var e=new Xn;return e.c=t.c,t.a&&(e.a=new kn(t.a),e.b=t.b),e}function er(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function nr(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),ar(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":ar(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new rr,t,e),e.join("")}function rr(){}(e=Xn.prototype).add=function(t,e){Yn(this),this.c=null,t=er(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Yn(this),this.a.forEach((function(n,r){G(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.Y=function(){Yn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.V=function(t){Yn(this);var e=[];if("string"==typeof t)$n(this,t)&&(e=Q(e,this.a.get(er(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=Q(e,t[n])}return e},e.set=function(t,e){return Yn(this),this.c=null,$n(this,t=er(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ir={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},or=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ar(t,e){e.push('"',t.replace(or,(function(t){var e=ir[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ir[t]=e),e})),'"')}function sr(){var t=Ar();return Yt&&!!ie&&11==ie||/Edge\/\d+/.test(t)}function ur(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function cr(t,e){e=e||u.window;var n="about:blank";t&&(n=Dt(Pt(t))),e.location.href=n}function fr(t){return!!((t=(t||Ar()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function hr(t){t=t||u.window;try{t.close()}catch(e){}}function lr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Ar().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Er(Ar())==_r&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Rt?n:Pt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((pt("iPhone")&&!pt("iPod")&&!pt("iPad")||pt("iPad")||pt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(a=pe(document,"A"),"HTMLAnchorElement"),e instanceof Rt||e instanceof Rt||(e="object"==typeof e&&e.sa?e.ra():String(e),Ct.test(e)||(e="about:invalid#zClosurez"),e=new Rt(jt,e)),a.href=Dt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Dt(e),a&&(Qt&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Bt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Gt(t)+'">'),r=a.document)&&(r.write(Ft(t)),r.close())):(a=r.open(Dt(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var pr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dr=/^[^@]+@[^@]+$/;function vr(){var t=null;return new we((function(e){"complete"==u.document.readyState?e():(t=function(){e()},fn(window,"load",t))})).s((function(e){throw hn(window,"load",t),e}))}function gr(t){return t=t||Ar(),!("file:"!==Nr()&&"ionic:"!==Nr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function yr(){var t=u.window;try{return!(!t||t==t.top)}catch(e){return!1}}function mr(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function br(){return n.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":n.INTERNAL.hasOwnProperty("node")?"Node":mr()?"Worker":"Browser"}function wr(){var t=br();return"ReactNative"===t||"Node"===t}var _r="Firefox";function Er(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?_r:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"}var Ir={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function Tr(t,e){e=e||[];var n,r=[],i={};for(n in Ir)i[Ir[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=br())?r=Er(i=Ar()):"Worker"===r&&(r=Er(i=Ar())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Ar(){return u.navigator&&u.navigator.userAgent||""}function xr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Sr(){try{var t=u.localStorage,e=Pr();if(t)return t.setItem(e,"1"),t.removeItem(e),!sr()||!!u.indexedDB}catch(n){return mr()&&!!u.indexedDB}return!1}function kr(){return(Or()||"chrome-extension:"===Nr()||gr())&&!wr()&&Sr()&&!mr()}function Or(){return"http:"===Nr()||"https:"===Nr()}function Nr(){return u.location&&u.location.protocol||null}function Lr(t){return!fr(t=t||Ar())&&Er(t)!=_r}function Rr(t){return void 0===t?null:nr(t)}function Dr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Cr(t){if(null!==t)return JSON.parse(t)}function Pr(t){return t||Math.floor(1e9*Math.random()).toString()}function Mr(t){return"Safari"!=Er(t=t||Ar())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function jr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ur(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Ar(),e=br(),this.b=fr(t)||"ReactNative"===e}function Fr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Vr(t){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t)}function Br(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function qr(){return!(!xr("fireauth.oauthhelper",u)&&!xr("fireauth.iframe",u))}Ur.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Or()&&"chrome-extension:"!==Nr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var zr,Gr={};function Hr(t){Gr[t]||(Gr[t]=!0,Vr(t))}try{var Wr={};Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Wr,"abcd",{configurable:!0,enumerable:!0,value:2}),zr=2==Wr.abcd}catch(Kt){zr=!1}function Kr(t,e,n){zr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Xr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Kr(t,n,e[n])}function Yr(t){var e={};return Xr(e,t),e}function Jr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Kr(e,n,Jr(t[n]));return e}function Qr(t){var e=t&&(t[ni]?"phone":null);if(!(e&&t&&t[ei]))throw new x("internal-error","Internal assert: invalid MultiFactorInfo object");Kr(this,"uid",t[ei]),Kr(this,"displayName",t[Zr]||null);var n=null;t[ti]&&(n=new Date(t[ti]).toUTCString()),Kr(this,"enrollmentTime",n),Kr(this,"factorId",e)}function $r(t){try{var e=new ri(t)}catch(n){e=null}return e}Qr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Zr="displayName",ti="enrolledAt",ei="mfaEnrollmentId",ni="phoneInfo";function ri(t){Qr.call(this,t),Kr(this,"phoneNumber",t[ni])}function ii(t){var e={},n=t[ui],r=t[fi],i=t[hi];if(t=$r(t[ci]),!i||i!=ai&&i!=si&&!n||i==si&&!r||i==oi&&!t)throw Error("Invalid checkActionCode response!");i==si?(e[pi]=n||null,e[vi]=n||null,e[li]=r):(e[pi]=r||null,e[vi]=r||null,e[li]=n||null),e[di]=t||null,Kr(this,yi,i),Kr(this,gi,Jr(e))}A(ri,Qr),ri.prototype.w=function(){var t=ri.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var oi="REVERT_SECOND_FACTOR_ADDITION",ai="EMAIL_SIGNIN",si="VERIFY_AND_CHANGE_EMAIL",ui="email",ci="mfaInfo",fi="newEmail",hi="requestType",li="email",pi="fromEmail",di="multiFactorInfo",vi="previousEmail",gi="data",yi="operation";function mi(t){var e=jn(t=Un(t),bi)||null,n=jn(t,wi)||null,r=jn(t,Ii)||null;if(r=r&&Ai[r]||null,!e||!n||!r)throw new x("argument-error",bi+", "+wi+"and "+Ii+" are required in a valid action code URL.");Xr(this,{apiKey:e,operation:r,code:n,continueUrl:jn(t,_i)||null,languageCode:jn(t,Ei)||null,tenantId:jn(t,Ti)||null})}var bi="apiKey",wi="oobCode",_i="continueUrl",Ei="languageCode",Ii="mode",Ti="tenantId",Ai={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:oi,signIn:ai,verifyAndChangeEmail:si,verifyEmail:"VERIFY_EMAIL"};function xi(t){try{return new mi(t)}catch(e){return null}}function Si(t){var e=t[Ri];if(void 0===e)throw new x("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new x("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[ki];if(n&&"object"==typeof n){e=n[Pi];var r=n[Di];if(n=n[Ci],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new x("argument-error",Di+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new x("argument-error",Ci+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new x("argument-error",Pi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new x("missing-android-pkg-name")}}else if(void 0!==n)throw new x("argument-error",ki+" property must be a non null object when specified.");if(this.f=null,(e=t[Li])&&"object"==typeof e){if("string"==typeof(e=e[Mi])&&e.length)this.f=e;else if(void 0!==e)throw new x("argument-error",Mi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new x("argument-error",Li+" property must be a non null object when specified.");if(void 0!==(e=t[Ni])&&"boolean"!=typeof e)throw new x("argument-error",Ni+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Oi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new x("argument-error",Oi+" property must be a non empty string when specified.");this.i=t||null}var ki="android",Oi="dynamicLinkDomain",Ni="handleCodeInApp",Li="iOS",Ri="url",Di="installApp",Ci="minimumVersion",Pi="packageName",Mi="bundleId";function ji(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ui=null;function Fi(t){var e=Bi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,T(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Vi(t){try{return new Fi(t)}catch(e){return null}}function Bi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ui[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ui){Ui={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ui[o]&&(Ui[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}(t))}catch(r){}return null}Fi.prototype.S=function(){return this.f},Fi.prototype.i=function(){return this.b},Fi.prototype.toString=function(){return this.g};var qi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),zi=["client_id","response_type","scope","redirect_uri","state"],Gi={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:zi},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:zi},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:zi},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:qi},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function Hi(t){for(var e in Gi)if(Gi[e].fa==t)return Gi[e];return null}function Wi(t){var e={};e["facebook.com"]=Qi,e["google.com"]=Zi,e["github.com"]=$i,e["twitter.com"]=to;var n=t&&t[Xi];try{if(n)return e[n]?new e[n](t):new Ji(t);if(void 0!==t[Ki])return new Yi(t)}catch(r){}return null}var Ki="idToken",Xi="providerId";function Yi(t){var e=t[Xi];if(!e&&t[Ki]){var n=Vi(t[Ki]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Kr(this,"providerId",e),Kr(this,"isNewUser",n)}function Ji(t){Yi.call(this,t),Kr(this,"profile",Jr((t=Cr(t.rawUserInfo||"{}"))||{}))}function Qi(t){if(Ji.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function $i(t){if(Ji.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Kr(this,"username",this.profile&&this.profile.login||null)}function Zi(t){if(Ji.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Ji.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Kr(this,"username",t.screenName||null)}function eo(t){var e=Un(t),n=jn(e,"link"),r=jn(Un(n),"link");return e=jn(e,"deep_link_id"),jn(Un(e),"link")||e||r||n||t}function no(t,e){if(!t&&!e)throw new x("internal-error","Internal assert: no raw session string available");if(t&&e)throw new x("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?ro:io}A(Ji,Yi),A(Qi,Ji),A($i,Ji),A(Zi,Ji),A(to,Ji);var ro="enroll",io="signin";function oo(){}function ao(t,e){return t.then((function(t){if(t[Ka]){var n=Vi(t[Ka]);if(!n||e!=n.h)throw new x("user-mismatch");return t}throw new x("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==O+"user-not-found"?new x("user-mismatch"):t}))}function so(t,e){if(!e)throw new x("internal-error","failed to construct a credential");this.a=e,Kr(this,"providerId",t),Kr(this,"signInMethod",t)}function uo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function co(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new so(t.providerId,t.pendingToken)}catch(e){}return null}function fo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Kr(this,"idToken",e.idToken),e.accessToken&&Kr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Kr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new x("internal-error","failed to construct a credential");Kr(this,"accessToken",e.oauthToken),Kr(this,"secret",e.oauthTokenSecret)}Kr(this,"providerId",t),Kr(this,"signInMethod",n)}function ho(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Jn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function lo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new fo(t.providerId,e,t.signInMethod)}catch(n){}}return null}function po(t,e){this.Pc=e||[],Xr(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(Hi(t)||{}).Ja||null,this.nb=null}function vo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new x("argument-error",'SAML provider IDs must be prefixed with "saml."');po.call(this,t,[])}function go(t){po.call(this,t,zi),this.a=[]}function yo(){go.call(this,"facebook.com")}function mo(t){if(!t)throw new x("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new yo).credential({accessToken:e})}function bo(){go.call(this,"github.com")}function wo(t){if(!t)throw new x("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new bo).credential({accessToken:e})}function _o(){go.call(this,"google.com"),this.Ca("profile")}function Eo(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new _o).credential({idToken:n,accessToken:e})}function Io(){po.call(this,"twitter.com",qi)}function To(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new x("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new fo("twitter.com",n,"twitter.com")}function Ao(t,e,n){this.a=t,this.f=e,Kr(this,"providerId","password"),Kr(this,"signInMethod",n===So.EMAIL_LINK_SIGN_IN_METHOD?So.EMAIL_LINK_SIGN_IN_METHOD:So.EMAIL_PASSWORD_SIGN_IN_METHOD)}function xo(t){return t&&t.email&&t.password?new Ao(t.email,t.password,t.signInMethod):null}function So(){Xr(this,{providerId:"password",isOAuthProvider:!1})}function ko(t,e){if(!(e=Oo(e)))throw new x("argument-error","Invalid email link!");return new Ao(t,e.code,So.EMAIL_LINK_SIGN_IN_METHOD)}function Oo(t){return(t=xi(t=eo(t)))&&t.operation===ai?t:null}function No(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new x("internal-error");this.a=t,Kr(this,"providerId","phone"),this.fa="phone",Kr(this,"signInMethod","phone")}function Lo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new No(e)}return null}function Ro(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Do(t){try{this.a=t||n.auth()}catch(e){throw new x("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Xr(this,{providerId:"phone",isOAuthProvider:!1})}function Co(t,e){if(!t)throw new x("missing-verification-id");if(!e)throw new x("missing-verification-code");return new No({cb:t,bb:e})}function Po(t){if(t.temporaryProof&&t.phoneNumber)return new No({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Eo(o,n);case"facebook.com":return mo(n);case"github.com":return wo(n);case"twitter.com":return To(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new so(e,a):new fo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new go(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Mo(t){if(!t.isOAuthProvider)throw new x("invalid-oauth-provider")}function jo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new x("invalid-auth-event");if(this.g&&this.a)throw new x("invalid-auth-event");if(this.g&&!this.f)throw new x("invalid-auth-event")}function Uo(t){return(t=t||{}).type?new jo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&S(t.error),t.postBody,t.tenantId):null}function Fo(){this.b=null,this.a=[]}no.prototype.Ha=function(){return this.a?Se(this.a):Se(this.b)},no.prototype.w=function(){return this.type==ro?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},oo.prototype.ja=function(){},oo.prototype.b=function(){},oo.prototype.c=function(){},oo.prototype.w=function(){},so.prototype.ja=function(t){return ds(t,uo(this))},so.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,vs(t,n)},so.prototype.c=function(t,e){return ao(gs(t,uo(this)),e)},so.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},fo.prototype.ja=function(t){return ds(t,ho(this))},fo.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,vs(t,n)},fo.prototype.c=function(t,e){return ao(gs(t,ho(this)),e)},fo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},po.prototype.Ka=function(t){return this.Hb=gt(t),this},A(vo,po),A(go,po),go.prototype.Ca=function(t){return X(this.a,t)||this.a.push(t),this},go.prototype.Pb=function(){return $(this.a)},go.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new x("argument-error","credential failed: must provide the ID token and/or the access token.");return new fo(this.providerId,n,this.providerId)},A(yo,go),Kr(yo,"PROVIDER_ID","facebook.com"),Kr(yo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),A(bo,go),Kr(bo,"PROVIDER_ID","github.com"),Kr(bo,"GITHUB_SIGN_IN_METHOD","github.com"),A(_o,go),Kr(_o,"PROVIDER_ID","google.com"),Kr(_o,"GOOGLE_SIGN_IN_METHOD","google.com"),A(Io,po),Kr(Io,"PROVIDER_ID","twitter.com"),Kr(Io,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ao.prototype.ja=function(t){return this.signInMethod==So.EMAIL_LINK_SIGN_IN_METHOD?Qs(t,Ts,{email:this.a,oobCode:this.f}):Qs(t,Ws,{email:this.a,password:this.f})},Ao.prototype.b=function(t,e){return this.signInMethod==So.EMAIL_LINK_SIGN_IN_METHOD?Qs(t,As,{idToken:e,email:this.a,oobCode:this.f}):Qs(t,Us,{idToken:e,email:this.a,password:this.f})},Ao.prototype.c=function(t,e){return ao(this.ja(t),e)},Ao.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Xr(So,{PROVIDER_ID:"password"}),Xr(So,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Xr(So,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),No.prototype.ja=function(t){return t.eb(Ro(this))},No.prototype.b=function(t,e){var n=Ro(this);return n.idToken=e,Qs(t,Xs,n)},No.prototype.c=function(t,e){var n=Ro(this);return n.operation="REAUTH",ao(t=Qs(t,Ys,n),e)},No.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Do.prototype.eb=function(t,e){var n=this.a.a;return Se(e.verify()).then((function(r){if("string"!=typeof r)throw new x("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==ro?i.Ha().then((function(t){return Qs(n,Vs,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}}).then((function(t){return t.phoneSessionInfo.sessionInfo}))})):i&&i.type==io?i.Ha().then((function(e){return function(t,e){return Qs(t,Bs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return Qs(t,Ms,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new x("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Xr(Do,{PROVIDER_ID:"phone"}),Xr(Do,{PHONE_SIGN_IN_METHOD:"phone"}),jo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},jo.prototype.S=function(){return this.h},jo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Vo,Bo=null;function qo(t){var e="unauthorized-domain",n=void 0,r=Un(t);t=r.a,"chrome-extension"==(r=r.f)?n=zt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=zt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",x.call(this,e,n)}function zo(t,e,n){x.call(this,t,n),(t=e||{}).Ib&&Kr(this,"email",t.Ib),t.ea&&Kr(this,"phoneNumber",t.ea),t.credential&&Kr(this,"credential",t.credential),t.Yb&&Kr(this,"tenantId",t.Yb)}function Go(t){if(t.code){var e=t.code||"";0==e.indexOf(O)&&(e=e.substring(O.length));var n={credential:Po(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new x(e,t.message||void 0);return new zo(e,n,t.message)}return null}function Ho(){}function Wo(t){return t.c||(t.c=t.b())}function Ko(){}function Xo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(d){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Yo(){}function Jo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=E(this.pc,this),this.a.onerror=E(this.Rb,this),this.a.onprogress=E(this.qc,this),this.a.ontimeout=E(this.uc,this)}function Qo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function $o(t,e,n){this.reset(t,e,n,void 0,void 0)}function Zo(t){this.f=t,this.b=this.c=this.a=null}function ta(t,e){this.name=t,this.value=e}A(qo,x),A(zo,x),zo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},zo.prototype.toJSON=function(){return this.w()},Ho.prototype.c=null,A(Ko,Ho),Ko.prototype.a=function(){var t=Xo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Ko.prototype.b=function(){var t={};return Xo(this)&&(t[0]=!0,t[1]=!0),t},Vo=new Ko,A(Yo,Ho),Yo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Jo;throw Error("Unsupported browser")},Yo.prototype.b=function(){return{}},(e=Jo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Qo(this,4)},e.Rb=function(){this.status=500,this.response=this.responseText="",Qo(this,4)},e.uc=function(){this.Rb()},e.qc=function(){this.status=200,Qo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},$o.prototype.a=null,$o.prototype.reset=function(t,e,n,r,i){r||T(),delete this.a},ta.prototype.toString=function(){return this.name};var ea=new ta("SEVERE",1e3),na=new ta("WARNING",900),ra=new ta("CONFIG",700),ia=new ta("FINE",500);Zo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(M("Root logger has no level set."),null)}(this).value)for(v(e)&&(e=e()),t=new $o(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var oa={},aa=null;function sa(t){var e;if(aa||(aa=new Zo(""),oa[""]=aa,aa.c=ra),!(e=oa[t])){e=new Zo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=sa(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,oa[t]=e}return e}function ua(t,e){t&&t.log(ia,e,void 0)}function ca(t){this.f=t}function fa(t){wn.call(this),this.o=t,this.readyState=ha,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=sa("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}A(ca,Ho),ca.prototype.a=function(){return new fa(this.f)},ca.prototype.b=function(t){return function(){return t}}({}),A(fa,wn);var ha=0;function la(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function pa(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,da(t)}function da(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function va(t){wn.call(this),this.headers=new kn,this.O=t||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.o=null,this.m=ga,this.u=this.R=!1}(e=fa.prototype).open=function(t,e){if(this.readyState!=ha)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,da(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.tc.bind(this),this.Ta.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,pa(this,!1)),this.readyState=ha},e.tc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,da(this)),this.a&&(this.readyState=3,da(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,la(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},e.oc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?pa(this,!0):da(this),3==this.readyState&&la(this)}},e.sc=function(t){this.a&&(this.response=this.responseText=t,pa(this,!0))},e.rc=function(t){this.a&&(this.response=t,pa(this,!0))},e.Ta=function(t){var e=this.h;e&&e.log(na,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&pa(this,!0)},e.setRequestHeader=function(t,e){this.i.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(na,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(na,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},A(va,wn);var ga="";va.prototype.b=sa("goog.net.XhrIo");var ya=/^https?$/i,ma=["POST","PUT"];function ba(t){return"content-type"==t.toLowerCase()}function wa(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,_a(t),Ia(t)}function _a(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ea(t){if(t.c&&void 0!==s)if(t.A[1]&&4==Aa(t)&&2==xa(t))ua(t.b,Sa(t,"Local request error detected and ignored"));else if(t.i&&4==Aa(t))Tn(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==Aa(t)){ua(t.b,Sa(t,"Request complete")),t.c=!1;try{var e,n=xa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Ln)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!ya.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Aa(t)?t.a.statusText:""}catch(f){ua(t.b,"Can not get status: "+f.message),c=""}t.h=c+" ["+xa(t)+"]",_a(t)}}finally{Ia(t)}}}function Ia(t,e){if(t.a){Ta(t);var n=t.a,r=t.A[0]?h:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(d){(t=t.b)&&t.log(ea,"Problem encountered resetting onreadystatechange: "+d.message,void 0)}}}function Ta(t){t.a&&t.u&&(t.a.ontimeout=null),t.o&&(u.clearTimeout(t.o),t.o=null)}function Aa(t){return t.a?t.a.readyState:0}function xa(t){try{return 2<Aa(t)?t.a.status:-1}catch(e){return-1}}function Sa(t,e){return e+" ["+t.P+" "+t.l+" "+xa(t)+"]"}function ka(t){var e=Fa;this.g=[],this.u=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function Oa(t,e,n){t.a=!0,t.c=n,t.f=!e,Da(t)}function Na(t){if(t.a){if(!t.m)throw new Ca(t);t.m=!1}}function La(t,e,n,r){t.g.push([e,n,r]),t.a&&Da(t)}function Ra(t){return K(t.g,(function(t){return v(t[1])}))}function Da(t){if(t.h&&t.a&&Ra(t)){var e=t.h,n=ja[e];n&&(u.clearTimeout(n.a),delete ja[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(D(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ra(t)||(n=!0)}}t.c=e,r&&(s=E(t.v,t,!0),r=E(t.v,t,!1),e instanceof ka?(La(e,s,r),e.A=!0):e.then(s,r)),n&&(e=new Ma(e),ja[e.a]=e,t.h=e.a)}function Ca(){C.call(this)}function Pa(){C.call(this)}function Ma(t){this.a=u.setTimeout(E(this.c,this),0),this.b=t}(e=va.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ua(this.b,Sa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(ua(this.b,Sa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ia(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ia(this,!0)),va.$a.Da.call(this)},e.Ub=function(){this.xa||(this.N||this.i||this.f?Ea(this):this.Ic())},e.Ic=function(){Ea(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ga:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ea,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ua(this.b,"Can not get response: "+e.message),null}},ka.prototype.cancel=function(t){if(this.a)this.c instanceof ka&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.o,this):this.m=!0,this.a||(t=new Pa(this),Na(this),Oa(this,!1,t))}},ka.prototype.v=function(t,e){this.i=!1,Oa(this,t,e)},ka.prototype.then=function(t,e,n){var r,i,o=new we((function(t,e){r=t,i=e}));return La(this,r,(function(t){t instanceof Pa?o.cancel():i(t)})),o.then(t,e,n)},ka.prototype.$goog_Thenable=!0,A(Ca,C),Ca.prototype.message="Deferred has already fired",Ca.prototype.name="AlreadyCalledError",A(Pa,C),Pa.prototype.message="Deferred was canceled",Pa.prototype.name="CanceledError",Ma.prototype.c=function(){throw delete ja[this.a],this.b};var ja={};function Ua(t){var e={},n=e.document||document,r=xt(t).toString(),i=pe(document,"SCRIPT"),o={Vb:i,Ma:void 0},a=new ka(o),s=null,h=null!=e.timeout?e.timeout:5e3;return 0<h&&(s=window.setTimeout((function(){Va(i,!0);var t=new za(qa,"Timeout reached for loading script "+r);Na(a),Oa(a,!1,t)}),h),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Va(i,e.wd||!1,s),Na(a),Oa(a,!0,null))},i.onerror=function(){Va(i,!0,s);var t=new za(Ba,"Error while loading script "+r);Na(a),Oa(a,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),ce(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=xt(e),null===f&&(f=(e=(e=u.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&c.test(e)?e:""),(e=f)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Fa(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&Va(t,!0,this.Ma)}}function Va(t,e,n){null!=n&&u.clearTimeout(n),t.onload=h,t.onerror=h,t.onreadystatechange=h,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ba=0,qa=1;function za(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),C.call(this,n),this.code=t}function Ga(t){this.f=t}function Ha(t,e,r){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||Xa,this.g=gt(t.secureTokenHeaders||Ya),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||Ja,this.a=gt(t.firebaseHeaders||Qa),r&&(this.a["X-Client-Version"]=r,this.g["X-Client-Version"]=r),r="Node"==br(),!(r=u.XMLHttpRequest||r&&n.INTERNAL.node&&n.INTERNAL.node.XMLHttpRequest)&&!mr())throw new x("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,mr()?this.f=new ca(self):wr()?this.f=new Ga(r):this.f=new Yo,this.b=null}A(za,C),A(Ga,Ho),Ga.prototype.a=function(){return new this.f},Ga.prototype.b=function(){return{}};var Wa,Ka="idToken",Xa=new Ur(3e4,6e4),Ya={"Content-Type":"application/x-www-form-urlencoded"},Ja=new Ur(3e4,6e4),Qa={"Content-Type":"application/json"};function $a(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Za(t,e){e&&(t.l=ts("https://securetoken.googleapis.com/v1/token",e),t.h=ts("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=ts("https://identitytoolkit.googleapis.com/v2/",e))}function ts(t,e){return t=Un(t),e=Un(e.url),t.c=t.a+t.c,Dn(t,e.f),t.a=e.a,Cn(t,e.g),t.toString()}function es(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ns(t,e,n,r,i,o,a){(function(){var t=Ar();return!((t="Chrome"!=Er(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Yt&&ie&&!(9<ie))})()||mr()?t=E(t.u,t):(Wa||(Wa=new we((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(u[is]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){La(t,null,e,void 0)}(Ua(St(rs,{onload:is})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=E(t.o,t)),t(e,n,r,i,o,a)}Ha.prototype.S=function(){return this.b},Ha.prototype.u=function(t,e,n,r,i,o){if(mr()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new x("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new va(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}_n(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ua(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),En(a,"ready",(function(){s&&clearTimeout(s),Ge(this)})),En(a,"timeout",(function(){s&&clearTimeout(s),Ge(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Vo.a(),t.A=t.O?Wo(t.O):Wo(Vo),t.a.onreadystatechange=E(t.Ub,t);try{ua(t.b,Sa(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(a){return ua(t.b,Sa(t,"Error opening Xhr: "+a.message)),void wa(t,a)}e=r||"";var o=new kn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)G(t,e,void 0);else for(var n=Sn(t),r=xn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ba,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!X(ma,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{Ta(t),0<t.g&&(t.u=function(t){return Yt&&ae(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ua(t.b,Sa(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=E(t.Ma,t)):t.o=Tn(t.Ma,t.g,t)),ua(t.b,Sa(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(a){ua(t.b,Sa(t,"Send error: "+a.message)),wa(t,a)}}(a,t,n,r,i)};var rs=new wt(It,"https://apis.google.com/js/client.js?onload=%{onload}"),is="__fcb"+Math.floor(1e6*Math.random()).toString();function os(t){if("string"!=typeof(t=t.email)||!dr.test(t))throw new x("invalid-email")}function as(t){"email"in t&&os(t)}function ss(t){if(!t[Ka]){if(t.mfaPendingCredential)throw new x("multi-factor-auth-required",null,gt(t));throw new x("internal-error")}}function us(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new x("internal-error")}else{if(!t.sessionInfo)throw new x("missing-verification-id");if(!t.code)throw new x("missing-verification-code")}}Ha.prototype.o=function(t,e,n,r,i){var o=this;Wa.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Ha.prototype.yb=function(){return Qs(this,Fs,{})},Ha.prototype.Ab=function(t,e){return Qs(this,js,{idToken:t,email:e})},Ha.prototype.Bb=function(t,e){return Qs(this,Us,{idToken:t,password:e})};var cs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function fs(t){if(!t.phoneVerificationInfo)throw new x("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new x("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new x("missing-verification-code")}function hs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new x("internal-error")}function ls(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&$n(t=new Xn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function ps(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Go(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Go(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Go(t)):t.errorMessage&&(e=$s(t.errorMessage)),e)throw e;ss(t)}function ds(t,e){return e.returnIdpCredential=!0,Qs(t,qs,e)}function vs(t,e){return e.returnIdpCredential=!0,Qs(t,Gs,e)}function gs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Qs(t,zs,e)}function ys(t){if(!t.oobCode)throw new x("invalid-action-code")}(e=Ha.prototype).Cb=function(t,e){var n={idToken:t},r=[];return dt(cs,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Qs(this,js,n)},e.ub=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),Qs(this,Rs,t)},e.vb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),Qs(this,Os,t)},e.tb=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Qs(this,Ns,t)},e.Db=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Qs(this,Ls,t)},e.eb=function(t){return Qs(this,Ks,t)},e.mb=function(t,e){return Qs(this,Ps,{oobCode:t,newPassword:e})},e.Qa=function(t){return Qs(this,bs,{oobCode:t})},e.ib=function(t){return Qs(this,ms,{oobCode:t})};var ms={endpoint:"setAccountInfo",B:ys,Z:"email",C:!0},bs={endpoint:"resetPassword",B:ys,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new x("internal-error")},C:!0},ws={endpoint:"signupNewUser",B:function(t){if(os(t),!t.password)throw new x("weak-password")},F:ss,U:!0,C:!0},_s={endpoint:"createAuthUri",C:!0},Es={endpoint:"deleteAccount",M:["idToken"]},Is={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if("array"!=l(t.deleteProvider))throw new x("internal-error")}},Ts={endpoint:"emailLinkSignin",M:["email","oobCode"],B:os,F:ss,U:!0,C:!0},As={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:os,F:ss,U:!0},xs={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:fs,F:ss,C:!0,Na:!0},Ss={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:fs,F:ss,C:!0,Na:!0},ks={endpoint:"getAccountInfo"},Os={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new x("internal-error");os(t)},Z:"email",C:!0},Ns={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new x("internal-error")},Z:"email",C:!0},Ls={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new x("internal-error")},Z:"email",C:!0},Rs={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new x("internal-error");os(t)},Z:"email",C:!0},Ds={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Cs={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new x("internal-error")}},Ps={endpoint:"resetPassword",B:ys,Z:"email",C:!0},Ms={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},js={endpoint:"setAccountInfo",M:["idToken"],B:as,U:!0},Us={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(as(t),!t.password)throw new x("weak-password")},F:ss,U:!0},Fs={endpoint:"signupNewUser",F:ss,U:!0,C:!0},Vs={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new x("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new x("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new x("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new x("internal-error")},C:!0,Na:!0},Bs={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new x("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new x("internal-error")},C:!0,Na:!0},qs={endpoint:"verifyAssertion",B:hs,Xa:ls,F:ps,U:!0,C:!0},zs={endpoint:"verifyAssertion",B:hs,Xa:ls,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new x("user-not-found");if(t.errorMessage)throw $s(t.errorMessage);ss(t)},U:!0,C:!0},Gs={endpoint:"verifyAssertion",B:function(t){if(hs(t),!t.idToken)throw new x("internal-error")},Xa:ls,F:ps,U:!0},Hs={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new x("invalid-custom-token")},F:ss,U:!0,C:!0},Ws={endpoint:"verifyPassword",B:function(t){if(os(t),!t.password)throw new x("wrong-password")},F:ss,U:!0,C:!0},Ks={endpoint:"verifyPhoneNumber",B:us,F:ss,C:!0},Xs={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new x("internal-error");us(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Go(t);ss(t)}},Ys={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:us,F:ss,C:!0},Js={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Ka]^!!t.refreshToken)throw new x("internal-error")},C:!0,Na:!0};function Qs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return ke(new x("internal-error"));var r,i=!!e.Na,o=e.Tb||"POST";return Se(n).then(e.B).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Un(e+n);Mn(s,"key",t.c),a&&Mn(s,"cb",T().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Mn(s,c,i[c]);return new we((function(e,n){ns(t,s.toString(),(function(t){t?t.error?n(Zs(t,o||{})):e(t):n(new x("network-request-failed"))}),r,u?void 0:nr(Dr(i)),t.a,t.m.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Gb,e.kb||!1)})).then((function(t){return r=t,e.Xa?e.Xa(n,r):r})).then(e.F).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new x("internal-error");return r[e.Z]}))}function $s(t){return Zs({error:{errors:[{message:t}],code:400,message:t}})}function Zs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new x(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",mt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new x(r[i],e);return!e&&t&&(e=Rr(t)),new x("internal-error",e)}function tu(t){this.b=t,this.a=null,this.qb=function(t){return(iu||(iu=new we((function(t,e){function n(){jr(),xr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){jr(),e(Error("Network Error"))},timeout:nu.get()})}if(xr("gapi.iframes.Iframe"))t();else if(xr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){xr("gapi.load")?n():e(Error("Network Error"))},Se(Ua(r=St(eu,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw iu=null,t})))).then((function(){return new we((function(e,n){xr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),ru.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var eu=new wt(It,"https://apis.google.com/js/api.js?onload=%{onload}"),nu=new Ur(3e4,6e4),ru=new Ur(5e3,15e3),iu=null;function ou(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Fn((t=Un(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):Fn("https",this.l,null,"/__/auth/iframe"),this.a=t,Mn(this.a,"apiKey",this.h),Mn(this.a,"appName",this.i),this.b=null,this.c=[]}function au(t,e,n,r,i,o){this.u=t,this.o=e,this.c=n,this.v=r,this.m=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function su(t){try{return n.app(t).auth().Ga()}catch(e){return[]}}function uu(t,e,n,r,i,o){this.o=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function cu(t){var e=ur();return function(t){return Qs(t,Ds,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Un(e),r=n.f;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Un(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:pr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new qo(ur())}))}function fu(t){return t.v||(t.v=vr().then((function(){if(!t.u){var e=t.c,n=t.i,r=su(t.b),i=new ou(t.o,t.g,t.b,t.f);i.f=e,i.b=n,i.c=$(r||[]),t.u=i.toString()}t.m=new tu(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then((function(){t.a.register("authEvent",e,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.m,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Uo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Se(n)}return n.status="ERROR",Se(n)}))}(t)}))),t.v}function hu(t){return t.l||(t.A=t.c?Tr(t.c,su(t.b)):null,t.l=new Ha(t.g,R(t.i),t.A),t.f&&Za(t.l,t.f)),t.l}function lu(t,e,n,r,i,o,a,s,u,c,f,h){return(t=new au(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=gt(u||null),t.f=c,t.xb(f).toString()}function pu(t){if(this.a=t||n.INTERNAL.reactNative&&n.INTERNAL.reactNative.AsyncStorage,!this.a)throw new x("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function du(t){this.b=t,this.a={},this.f=E(this.c,this)}ou.prototype.toString=function(){return this.f?Mn(this.a,"v",this.f):Qn(this.a.b,"v"),this.b?Mn(this.a,"eid",this.b):Qn(this.a.b,"eid"),this.c.length?Mn(this.a,"fw",this.c.join(",")):Qn(this.a.b,"fw"),this.a.toString()},au.prototype.xb=function(t){return this.h=t,this},au.prototype.toString=function(){if(this.m){var t=Un(this.m.url);t=Fn(t.f,t.a,t.g,"/emulator/auth/handler")}else t=Fn("https",this.u,null,"/__/auth/handler");if(Mn(t,"apiKey",this.o),Mn(t,"appName",this.c),Mn(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var r=n.app(this.c).auth().ka()}catch(u){r=null}for(var i in e.nb=r,Mn(t,"providerId",this.a.providerId),e=Dr((r=this.a).Hb))e[i]=e[i].toString();i=r.Pc,e=gt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}r.ob&&r.nb&&!e[r.ob]&&(e[r.ob]=r.nb),vt(e)||Mn(t,"customParameters",Rr(e))}if("function"==typeof this.a.Pb&&(r=this.a.Pb()).length&&Mn(t,"scopes",r.join(",")),this.l?Mn(t,"redirectUrl",this.l):Qn(t.b,"redirectUrl"),this.g?Mn(t,"eventId",this.g):Qn(t.b,"eventId"),this.i?Mn(t,"v",this.i):Qn(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!jn(t,s)&&Mn(t,s,this.b[s]);return this.h?Mn(t,"tid",this.h):Qn(t.b,"tid"),this.f?Mn(t,"eid",this.f):Qn(t.b,"eid"),(s=su(this.c)).length&&Mn(t,"fw",s.join(",")),t.toString()},(e=uu.prototype).Nb=function(t,e,n){var r=new x("popup-closed-by-user"),i=new x("web-storage-unsupported"),o=this,a=!1;return this.la().then((function(){(function(t){var e={type:"webStorageSupport"};return fu(t).then((function(){return function(t,e){return t.qb.then((function(){return new we((function(n){t.a.send(e.type,e,n,xr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.m,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&hr(t),e(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(t){return new we((function(e){return function n(){An(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return An(n).then((function(){e(r)}))}))},e.Wb=function(){var t=Ar();return!Lr(t)&&!Mr(t)},e.Sb=function(){return!1},e.Lb=function(t,e,n,r,i,o,a,s){if(!t)return ke(new x("popup-blocked"));if(a&&!Lr())return this.la().s((function(e){hr(t),i(e)})),r(),Se();this.a||(this.a=cu(hu(this)));var u=this;return this.a.then((function(){var e=u.la().s((function(e){throw hr(t),i(e),e}));return r(),e})).then((function(){Mo(n),a||cr(lu(u.o,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Mb=function(t,e,n,r){this.a||(this.a=cu(hu(this)));var i=this;return this.a.then((function(){Mo(e),cr(lu(i.o,i.g,i.b,t,e,ur(),n,i.c,void 0,i.i,r,i.f))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.la=function(){var t=this;return fu(this).then((function(){return t.m.qb})).s((function(){throw t.a=null,new x("network-request-failed")}))},e.Zb=function(){return!0},e.Ea=function(t){this.h.push(t)},e.Ra=function(t){J(this.h,(function(e){return e==t}))},(e=pu.prototype).get=function(t){return Se(this.a.getItem(t)).then((function(t){return t&&Cr(t)}))},e.set=function(t,e){return Se(this.a.setItem(t,Rr(e)))},e.T=function(t){return Se(this.a.removeItem(t))},e.ca=function(){},e.ia=function(){};var vu,gu=[];function yu(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function mu(t){this.a=t}function bu(t){this.c=t,this.b=!1,this.a=[]}function wu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return ke(Error("connection_unavailable"));var f=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new we((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),f),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return _u(t,c),e})).s((function(e){throw _u(t,c),e}))}function _u(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(t.a,(function(t){return t==e}))}}function Eu(){if(!Tu())throw new x("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;mr()&&self?(this.l=function(){var t=mr()?self:null;if(G(gu,(function(n){n.b==t&&(e=n)})),!e){var e=new du(t);gu.push(e)}return e}(),yu(this.l,"keyChanged",(function(e,n){return Ou(t).then((function(e){return 0<e.length&&G(t.a,(function(t){t(e)})),{keyProcessed:X(e,n.key)}}))})),yu(this.l,"ping",(function(){return Se(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Se().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):Se(null)}().then((function(e){(t.h=e)&&(t.g=new bu(new mu(e)),wu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&X(e[0].value,"keyChanged")&&(t.o=!0)})).s((function(){})))}))}function Iu(t){return t.v||(t.v=function t(e){return new we((function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){r(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new we((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(e).then((function(){return t(e)})).then((function(t){n(t)})).s((function(t){r(t)}))}}))}(t)),t.v}function Tu(){try{return!!u.indexedDB}catch(Kt){return!1}}function Au(t){return t.objectStore("firebaseLocalStorage")}function xu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Su(t){return new we((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function ku(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?wu(t.g,"keyChanged",{key:e},t.o).then((function(){})).s((function(){})):Se()}function Ou(t){return Iu(t).then((function(t){var e=Au(xu(t,!1));return e.getAll?Su(e.getAll()):new we((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Nu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Lu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Se().then((function(){if(Tu()){var t=Pr(),r="__sak"+t;return vu||(vu=new Eu),(n=vu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){G(e.a,(function(e){e(t)}))})),t}))}function Ru(){this.a={},this.type="inMemory"}function Du(){if(!function(){var t="Node"==br();if(!(t=Cu()||t&&n.INTERNAL.node&&n.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==br())throw new x("internal-error","The LocalStorage compatibility library was not found.");throw new x("web-storage-unsupported")}this.a=Cu()||n.INTERNAL.node.localStorage,this.type="localStorage"}function Cu(){try{var t=u.localStorage,e=Pr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Pu(){this.type="nullStorage"}function Mu(){if(!function(){var t="Node"==br();if(!(t=ju()||t&&n.INTERNAL.node&&n.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==br())throw new x("internal-error","The SessionStorage compatibility library was not found.");throw new x("web-storage-unsupported")}this.a=ju()||n.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function ju(){try{var t=u.sessionStorage,e=Pr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Uu(){var t={};t.Browser=Bu,t.Node=qu,t.ReactNative=zu,t.Worker=Gu,this.a=t[br()]}du.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];G(r,(function(e){i.push(Se().then((function(){return e(t.origin,t.data.data)})))})),Ne(i).then((function(r){var i=[];G(r,(function(t){i.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})})),G(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},mu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},bu.prototype.close=function(){for(;0<this.a.length;)_u(this,this.a[0]);this.b=!0},(e=Eu.prototype).set=function(t,e){var n,r=!1,i=this;return Iu(this).then((function(e){return Su((e=Au(xu(n=e,!0))).get(t))})).then((function(o){var a=Au(xu(n,!0));return o?(o.value=e,Su(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Su(a.add(o)))})).then((function(){return i.c[t]=e,ku(i,t)})).na((function(){r&&i.b--}))},e.get=function(t){return Iu(this).then((function(e){return Su(Au(xu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.T=function(t){var e=!1,n=this;return Iu(this).then((function(r){return e=!0,n.b++,Su(Au(xu(r,!0)).delete(t))})).then((function(){return delete n.c[t],ku(n,t)})).na((function(){e&&n.b--}))},e.ca=function(t){0==this.a.length&&function(t){Nu(t),function e(){t.f=setTimeout((function(){t.i=Ou(t).then((function(e){0<e.length&&G(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},e.ia=function(t){J(this.a,(function(e){return e==t})),0==this.a.length&&Nu(this)},(e=Lu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.T=function(t){return this.b.then((function(e){return e.T(t)}))},e.ca=function(t){this.a.push(t)},e.ia=function(t){J(this.a,(function(e){return e==t}))},(e=Ru.prototype).get=function(t){return Se(this.a[t])},e.set=function(t,e){return this.a[t]=e,Se()},e.T=function(t){return delete this.a[t],Se()},e.ca=function(){},e.ia=function(){},(e=Du.prototype).get=function(t){var e=this;return Se().then((function(){return Cr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Se().then((function(){var r=Rr(e);null===r?n.T(t):n.a.setItem(t,r)}))},e.T=function(t){var e=this;return Se().then((function(){e.a.removeItem(t)}))},e.ca=function(t){u.window&&un(u.window,"storage",t)},e.ia=function(t){u.window&&hn(u.window,"storage",t)},(e=Pu.prototype).get=function(){return Se(null)},e.set=function(){return Se()},e.T=function(){return Se()},e.ca=function(){},e.ia=function(){},(e=Mu.prototype).get=function(t){var e=this;return Se().then((function(){return Cr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Se().then((function(){var r=Rr(e);null===r?n.T(t):n.a.setItem(t,r)}))},e.T=function(t){var e=this;return Se().then((function(){e.a.removeItem(t)}))},e.ca=function(){},e.ia=function(){};var Fu,Vu,Bu={D:Du,ab:Mu},qu={D:Du,ab:Mu},zu={D:pu,ab:Pu},Gu={D:Du,ab:Pu},Hu={qd:"local",NONE:"none",sd:"session"};function Wu(){var t=!(Mr(Ar())||!yr()),e=Lr(),n=Sr();this.v=t,this.h=e,this.l=n,this.a={},Fu||(Fu=new Uu),t=Fu;try{this.g=!sr()&&qr()||!u.indexedDB?new t.a.D:new Lu(mr()?new Ru:new t.a.D)}catch(r){this.g=new Ru,this.h=!0}try{this.i=new t.a.ab}catch(r){this.i=new Ru}this.m=new Ru,this.f=E(this.Xb,this),this.b={}}function Ku(){return Vu||(Vu=new Wu),Vu}function Xu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function Yu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Ju(t,e,n){return n=Yu(e,n),"local"==e.D&&(t.b[n]=null),Xu(t,e.D).T(n)}function Qu(t){t.c&&(clearInterval(t.c),t.c=null)}function $u(t){this.a=t,this.b=Ku()}(e=Wu.prototype).get=function(t,e){return Xu(this,t.D).get(Yu(t,e))},e.set=function(t,e,n){var r=Yu(t,n),i=this,o=Xu(this,t.D);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.D&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=Yu(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),vt(this.a)&&(Xu(this,"local").ca(this.f),this.h||(sr()||!qr())&&u.indexedDB||!this.l||function(t){Qu(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Je({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Xb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=Yu(t,e),this.a[t]&&(J(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(Xu(this,"local").ia(this.f),Qu(this))},e.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Xu(this,"local").ia(this.f):Qu(this),this.v)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.lb(e))},Yt&&ie&&10==ie&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else G(t,E(this.lb,this))},e.lb=function(t){this.a[t]&&G(this.a[t],(function(t){t()}))};var Zu,tc={name:"authEvent",D:"local"};function ec(){this.a=Ku()}function nc(t,e){this.b=rc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===Zu&&(Zu=u.Int32Array?new Int32Array(fc):fc),this.reset()}A(nc,(function(){this.b=-1}));for(var rc=64,ic=rc-1,oc=[],ac=0;ac<ic;ac++)oc[ac]=0;var sc=Q(128,oc);function uc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],f=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var l=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&f^~c&h)+(0|Zu[e])|0)+(0|n[e])|0)|0,o=h,h=f,f=c,c=u+a|0,u=s,s=i,i=r,r=a+l|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+f|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function cc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(uc(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(uc(t),i=0)}}t.c=i,t.g+=n}nc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):$(this.h)};var fc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function hc(){nc.call(this,8,lc)}A(hc,nc);var lc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function pc(t,e,n,r,i,o){this.m=t,this.i=e,this.l=n,this.v=r||null,this.u=i||null,this.o=o,this.h=e+":"+n,this.A=new ec,this.g=new $u(this.h),this.f=null,this.b=[],this.a=this.c=null}function dc(t){return new x("invalid-cordova-configuration",t)}function vc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function gc(t){return t.f||(t.f=t.la().then((function(){return new we((function(e){t.Ea((function n(r){return e(r),t.Ra(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),yc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=eo(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Cr(jn(o=Un(i),"firebaseError")||null))?S(o):null)?new jo(r.c,r.b,null,null,o,null,r.S()):new jo(r.c,r.b,i,r.f,null,null,r.S())),i=o||n}vc(t,i)}))}var n=new jo("unknown",null,null,null,new x("no-auth-event")),r=!1,i=An(500).then((function(){return yc(t).then((function(){r||vc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(xr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Bo||(Bo=new Fo),function(t){var e=Bo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=xr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function yc(t){var e=null;return function(t){return t.b.get(tc,t.a).then((function(t){return Uo(t)}))}(t.g).then((function(n){return e=n,Ju((n=t.g).b,tc,n.a)})).then((function(){return e}))}function mc(t){this.a=t,this.b=Ku()}(e=pc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(gr(void 0)?vr().then((function(){return new we((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):ke(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof xr("universalLinks.subscribe",u))throw dc("cordova-universal-links-plugin-fix is not installed");if(void 0===xr("BuildInfo.packageName",u))throw dc("cordova-plugin-buildinfo is not installed");if("function"!=typeof xr("cordova.plugins.browsertab.openUrl",u))throw dc("cordova-plugin-browsertab is not installed");if("function"!=typeof xr("cordova.InAppBrowser.open",u))throw dc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new x("cordova-not-ready")}))},e.Nb=function(t,e){return e(new x("operation-not-supported-in-this-environment")),Se()},e.Lb=function(){return ke(new x("operation-not-supported-in-this-environment"))},e.Zb=function(){return!1},e.Wb=function(){return!0},e.Sb=function(){return!0},e.Mb=function(t,e,n,r){if(this.c)return ke(new x("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,f=null;return this.c=Se().then((function(){return Mo(e),gc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new jo(e,r,null,o,new x("no-auth-event"),null,i),s=xr("BuildInfo.packageName",u);if("string"!=typeof s)throw new x("invalid-cordova-configuration");var c=xr("BuildInfo.displayName",u),f={};if(Ar().toLowerCase().match(/iphone|ipad|ipod/))f.ibi=s;else{if(!Ar().toLowerCase().match(/android/))return ke(new x("operation-not-supported-in-this-environment"));f.apn=s}c&&(f.appDisplayName=c),o=function(t){var e=new hc;cc(e,t),t=[];var n=8*e.g;56>e.c?cc(e,sc,56-e.c):cc(e,sc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(uc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return W(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),f.sessionId=o;var h=lu(t.m,t.i,t.l,e,n,null,r,t.v,f,t.u,i,t.o);return t.la().then((function(){var e=t.h;return t.A.a.set(tc,a.w(),e)})).then((function(){var e=xr("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new x("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=xr("cordova.plugins.browsertab.openUrl",u)))throw new x("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=xr("cordova.InAppBrowser.open",u)))throw new x("invalid-cordova-configuration");e=Ar(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new we((function(t,e){s=function(){var e=xr("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=An(2e3).then((function(){e(new x("redirect-cancelled-by-user"))})))},f=function(){Fr()&&c()},o.addEventListener("resume",c,!1),Ar().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",f,!1)})).s((function(t){return yc(i).then((function(){throw t}))}))})).na((function(){c&&o.removeEventListener("resume",c,!1),f&&o.removeEventListener("visibilitychange",f,!1),a&&a.cancel(),s&&i.Ra(s),i.c=null}))},e.Ea=function(t){this.b.push(t),gc(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new jo("unknown",null,null,null,new x("no-auth-event")),t(e))}))},e.Ra=function(t){J(this.b,(function(e){return e==t}))};var bc={name:"pendingRedirect",D:"session"};function wc(t){return Ju(t.b,bc,t.a)}function _c(t,e,n,r){this.i={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=r,this.h=[],this.f=!1,this.l=E(this.o,this),this.b=new Mc,this.A=new Bc,this.g=new mc(Cc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=Ec(this.O,this.m,this.v,k,this.G)}function Ec(t,e,r,i,o){var a=n.SDK_VERSION||null;return gr()?new pc(t,e,r,a,i,o):new uu(t,e,r,a,i,o)}function Ic(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().s((function(n){throw t.a==e&&t.reset(),n}))}function Tc(t){t.a.Wb()&&Ic(t).s((function(e){var n=new jo("unknown",null,null,null,new x("operation-not-supported-in-this-environment"));Nc(e)&&t.o(n)})),t.a.Sb()||jc(t.b)}function Ac(t,e){X(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(bc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?wc(t.g).then((function(){Ic(t).s((function(e){var n=new jo("unknown",null,null,null,new x("operation-not-supported-in-this-environment"));Nc(e)&&t.o(n)}))})):Tc(t)})).s((function(){Tc(t)}))}function xc(t,e){J(t.h,(function(t){return t==e}))}_c.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=Ec(this.O,this.m,this.v,null,this.G),this.i={}},_c.prototype.o=function(t){if(!t)throw new x("invalid-auth-event");if(6e5<=T()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=T())),e=!0;break}}return jc(this.b),e};var Sc=new Ur(2e3,1e4),kc=new Ur(3e4,6e4);function Oc(t,e,n,r,i,o,a){return t.a.Lb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Nc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Lc(t,e,n,r,i){var o;return function(t){return t.b.set(bc,"pending",t.a)}(t.g).then((function(){return t.a.Mb(e,n,r,i).s((function(e){if(Nc(e))throw new x("operation-not-supported-in-this-environment");return o=e,wc(t.g).then((function(){throw o}))})).then((function(){return t.a.Zb()?new we((function(){})):wc(t.g).then((function(){return t.qa()})).then((function(){})).s((function(){}))}))}))}function Rc(t,e,n,r,i){return t.a.Nb(r,(function(t){e.ma(n,null,t,i)}),Sc.get())}_c.prototype.qa=function(){return this.b.qa()};var Dc={};function Cc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Pc(t,e,n,r){var i=Cc(e,n,r);return Dc[i]||(Dc[i]=new _c(t,e,n,r)),Dc[i]}function Mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function jc(t){t.g||(t.g=!0,Vc(t,!1,null,null))}function Uc(t){t.g&&!t.i&&Vc(t,!1,null,null)}function Fc(t,e){if(t.b=function(){return Se(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Vc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return ke(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Fc(t,n):Fc(t,{user:null}),t.f=[],t.c=[]}function Bc(){}function qc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function zc(t,e){this.a=e,Kr(this,"verificationId",t)}function Gc(t,e,n,r){return new Do(t).eb(e,n).then((function(t){return new zc(t,r)}))}function Hc(t){var e=Bi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new x("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Xr(this,{token:t,expirationTime:Br(1e3*e.exp),authTime:Br(1e3*e.auth_time),issuedAtTime:Br(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Wc(t,e,n){var r=e&&e[Xc];if(!r)throw new x("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new no(null,r),this.b=[];var i=this;G(e[Kc]||[],(function(t){(t=$r(t))&&i.b.push(t)})),Kr(this,"auth",this.a),Kr(this,"session",this.c),Kr(this,"hints",this.b)}Mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Mc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Vc(this,!0,null,t.a),Se()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Vc(t,s,e,null)})).s((function(e){Vc(t,s,null,e)}))}(this,t,e):ke(new x("invalid-auth-event")):(Vc(this,!1,null,null),Se())}else ke(new x("invalid-auth-event"))},Mc.prototype.qa=function(){var t=this;return new we((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new x("timeout");t.a&&t.a.cancel(),t.a=An(kc.get()).then((function(){t.b||(t.g=!0,Vc(t,!0,null,e))}))}(t))}))},Bc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ma(t.c,null,t.a,t.b),Se()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.S(),t.i).then((function(t){e.ma(r,t,null,n)})).s((function(t){e.ma(r,null,t,n)}))}(t,e):ke(new x("invalid-auth-event"))}else ke(new x("invalid-auth-event"))},zc.prototype.confirm=function(t){return t=Co(this.verificationId,t),this.a(t)};var Kc="mfaInfo",Xc="mfaPendingCredential";function Yc(t,e,n,r){x.call(this,"multi-factor-auth-required",r,e),this.b=new Wc(t,e,n),Kr(this,"resolver",this.b)}function Jc(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Yc(e,t.serverResponse,n,t.message)}catch(r){}return null}function Qc(){}function $c(t){Kr(this,"factorId",t.fa),this.a=t}function Zc(t){if($c.call(this,t),this.a.fa!=Do.PROVIDER_ID)throw new x("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function tf(t,e){for(var n in Ye.call(this,t),e)this[n]=e[n]}function ef(t,e){this.a=t,this.b=[],this.c=E(this.xc,this),un(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&G(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ei]=t.uid),t.displayName&&(r[Zr]=t.displayName),t.enrollmentTime&&(r[ti]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ni]=t.phoneNumber);try{e=new ri(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),nf(this,n)}function nf(t,e){t.b=e,Kr(t,"enrolledFactors",e)}function rf(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function of(t){this.c=t,this.b=this.a=null}function af(t){return t.b&&1e3*t.b.c||0}function sf(t,e){var n=e.refreshToken;t.b=Vi(e[Ka]||""),t.a=n}function uf(t,e){this.a=t||null,this.b=e||null,Xr(this,{lastSignInTime:Br(e||null),creationTime:Br(t||null)})}function cf(t,e,n,r,i,o){Xr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ff(t,e,r){this.G=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null;var i=n.SDK_VERSION?Tr(n.SDK_VERSION):null;this.a=new Ha(this.l,R(k),i),t.emulatorConfig&&Za(this.a,t.emulatorConfig),this.b=new of(this.a),mf(this,e[Ka]),sf(this.b,e),Kr(this,"refreshToken",this.b.a),_f(this,r||{}),wn.call(this),this.P=!1,this.o&&kr()&&(this.i=Pc(this.o,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new rf((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=af(t.b)-T()-3e5;return 0<e?e:0}))}(this),this.$=E(this.gb,this);var o=this;this.pa=null,this.Ba=function(t){o.wa(t.h)},this.ba=null,this.za=function(t){Za(o.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){pf(o,t.f)},this.aa=null,this.N=new ef(this,r),Kr(this,"multiFactor",this.N)}function hf(t,e){t.ba&&hn(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&un(e,"languageCodeChanged",t.Ba)}function lf(t,e){t.W&&hn(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&un(e,"emulatorConfigChanged",t.za)}function pf(t,e){t.X=e,es(t.a,n.SDK_VERSION?Tr(n.SDK_VERSION,t.X):null)}function df(t,e){t.aa&&hn(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&un(e,"frameworkChanged",t.Aa)}function vf(t){try{return n.app(t.m).auth()}catch(e){throw new x("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function gf(t){t.A||t.u.b||(t.u.start(),hn(t,"tokenChanged",t.$),un(t,"tokenChanged",t.$))}function yf(t){hn(t,"tokenChanged",t.$),t.u.stop()}function mf(t,e){t.ya=e,Kr(t,"_lat",e)}function bf(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return Ne(e).then((function(){return t}))}function wf(t){t.i&&!t.P&&(t.P=!0,Ac(t.i,t))}function _f(t,e){Xr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new uf(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Ef(){}function If(t){return Se().then((function(){if(t.A)throw new x("app-deleted")}))}function Tf(t){return W(t.providerData,(function(t){return t.providerId}))}function Af(t,e){e&&(xf(t,e.providerId),t.providerData.push(e))}function xf(t,e){J(t.providerData,(function(t){return t.providerId==e}))}function Sf(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Kr(t,e,n)}function kf(t,e){t!=e&&(Xr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Kr(t,"metadata",function(t){return new uf(t.a,t.b)}(e.metadata)):Kr(t,"metadata",new uf),G(e.providerData,(function(e){Af(t,e)})),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),Kr(t,"refreshToken",t.b.a),nf(t.N,e.N.b))}function Of(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return Qs(t.a,ks,{idToken:e}).then(E(t.Jc,t))}(t,e).then((function(){return n||Sf(t,"isAnonymous",!1),e}))}))}function Nf(t,e){e[Ka]&&t.ya!=e[Ka]&&(sf(t.b,e),t.dispatchEvent(new tf("tokenChanged")),mf(t,e[Ka]),Sf(t,"refreshToken",t.b.a))}function Lf(t,e){return Of(t).then((function(){if(X(Tf(t),e))return bf(t).then((function(){throw new x("provider-already-linked")}))}))}function Rf(t,e,n){return Yr({user:t,credential:Po(e),additionalUserInfo:e=Wi(e),operationType:n})}function Df(t,e){return Nf(t,e),t.reload().then((function(){return t}))}function Cf(t,e,r,i,o){if(!kr())return ke(new x("operation-not-supported-in-this-environment"));if(t.f&&!o)return ke(t.f);var a=Hi(r.providerId),s=Pr(t.uid+":::"),u=null;(!Lr()||yr())&&t.o&&r.isOAuthProvider&&(u=lu(t.o,t.l,t.m,e,r,null,s,n.SDK_VERSION||null,null,null,t.tenantId));var c=lr(u,a&&a.ua,a&&a.ta);return i=i().then((function(){if(Mf(t),!o)return t.I().then((function(){}))})).then((function(){return Oc(t.i,c,e,r,s,!!u,t.tenantId)})).then((function(){return new we((function(n,r){t.ma(e,null,new x("cancelled-popup-request"),t.h||null),t.g=n,t.O=r,t.h=s,t.c=Rc(t.i,t,e,c,s)}))})).then((function(t){return c&&hr(c),t?Yr(t):null})).s((function(t){throw c&&hr(c),t})),jf(t,i,o)}function Pf(t,e,n,r,i){if(!kr())return ke(new x("operation-not-supported-in-this-environment"));if(t.f&&!i)return ke(t.f);var o=null,a=Pr(t.uid+":::");return r=r().then((function(){if(Mf(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,bf(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Vf,t.w(),e.a)),e})).then((function(){return Lc(t.i,e,n,a,t.tenantId)})).s((function(e){if(o=e,t.ha)return Bf(t.ha);throw o})).then((function(){if(o)throw o})),jf(t,r,i)}function Mf(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new x("internal-error");throw new x("auth-domain-config-required")}}function jf(t,e,n){var r=function(t,e,n){return t.f&&!n?(e.cancel(),ke(t.f)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new tf("userInvalidated")),t.f=e),e}))}(t,e,n);return t.G.push(r),r.na((function(){Y(t.G,r)})),r.s((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Jc(e.w(),vf(t),E(t.ic,t))),n||e}))}function Uf(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ka]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=new ff(e,n,t);return t.providerData&&G(t.providerData,(function(t){t&&Af(r,Yr(t))})),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Ff(t){this.a=t,this.b=Ku()}Wc.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[Kc],delete n[Xc],mt(n,t),e.g(n)}))},A(Yc,x),Qc.prototype.rb=function(t,e,n){return e.type==ro?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),mt(n,{phoneVerificationInfo:Ro(t.a)}),Qs(e,xs,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:Ro(t.a)}),Qs(e,Ss,n)}))}(this,t,e)},A($c,Qc),A(Zc,$c),A(tf,Ye),(e=ef.prototype).xc=function(t){nf(this,function(t){var e=[];return G(t.mfaInfo||[],(function(t){(t=$r(t))&&e.push(t)})),e}(t.gd))},e.Qb=function(){return this.a.I().then((function(t){return new no(t,null)}))},e.ec=function(t,e){var n=this,r=this.a.a;return this.Qb().then((function(n){return t.rb(r,n,e)})).then((function(t){return Nf(n.a,t),n.a.reload()}))},e.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Qs(r,Js,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=H(e.b,(function(t){return t.uid!=n}));return nf(e,r),Nf(e.a,t),e.a.reload().s((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},e.w=function(){return{multiFactor:{enrolledFactors:W(this.b,(function(t){return t.w()}))}}},rf.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=An(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return t=u.document,e=null,Fr()||!t?Se():new we((function(n){e=function(){Fr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}));var t,e})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},rf.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},of.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:af(this)}},of.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?ke(new x("user-token-expired")):t||!this.b||T()>af(this)-3e4?this.a?function(t,e){return function(t,e){return new we((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ns(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Zs(t)):t.access_token&&t.refresh_token?n(t):r(new x("internal-error")):r(new x("network-request-failed"))}),"POST",Jn(e).toString(),t.g,t.v.get()):r(new x("internal-error"))}))}(t.c,e).then((function(e){return t.b=Vi(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Se(null):Se({accessToken:this.b.toString(),refreshToken:this.a})},uf.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},A(ff,wn),ff.prototype.wa=function(t){this.pa=t,$a(this.a,t)},ff.prototype.ka=function(){return this.pa},ff.prototype.Ga=function(){return $(this.X)},ff.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},Kr(ff.prototype,"providerId","firebase"),(e=ff.prototype).reload=function(){var t=this;return jf(this,If(this).then((function(){return Of(t).then((function(){return bf(t)})).then(Ef)})))},e.nc=function(t){return this.I(t).then((function(t){return new Hc(t)}))},e.I=function(t){var e=this;return jf(this,If(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new x("internal-error");return t.accessToken!=e.ya&&(mf(e,t.accessToken),e.dispatchEvent(new tf("tokenChanged"))),Sf(e,"refreshToken",t.refreshToken),t.accessToken})))},e.Jc=function(t){if(!(t=t.users)||!t.length)throw new x("internal-error");_f(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new cf(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Af(this,e[n]);Sf(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new tf("userReloaded",{gd:t}))},e.Kc=function(t){return Hr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},e.sb=function(t){var e=this,n=null;return jf(this,t.c(this.a,this.uid).then((function(t){return Nf(e,t),n=Rf(e,t,"reauthenticate"),e.f=null,e.reload()})).then((function(){return n})),!0)},e.Bc=function(t){return Hr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},e.pb=function(t){var e=this,n=null;return jf(this,Lf(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Rf(e,t,"link"),Df(e,t)})).then((function(){return n})))},e.Cc=function(t,e){var n=this;return jf(this,Lf(this,"phone").then((function(){return Gc(vf(n),t,e,E(n.pb,n))})))},e.Lc=function(t,e){var n=this;return jf(this,Se().then((function(){return Gc(vf(n),t,e,E(n.sb,n))})),!0)},e.Ab=function(t){var e=this;return jf(this,this.I().then((function(n){return e.a.Ab(n,t)})).then((function(t){return Nf(e,t),e.reload()})))},e.dd=function(t){var e=this;return jf(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Nf(e,t),e.reload()})))},e.Bb=function(t){var e=this;return jf(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Nf(e,t),e.reload()})))},e.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return If(this);var e=this;return jf(this,this.I().then((function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Nf(e,t),Sf(e,"displayName",t.displayName||null),Sf(e,"photoURL",t.photoUrl||null),G(e.providerData,(function(t){"password"===t.providerId&&(Kr(t,"displayName",e.displayName),Kr(t,"photoURL",e.photoURL))})),bf(e)})).then(Ef))},e.bd=function(t){var e=this;return jf(this,Of(this).then((function(n){return X(Tf(e),t)?function(t,e,n){return Qs(t,Is,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return G(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),G(Tf(e),(function(t){n[t]||xf(e,t)})),n[Do.PROVIDER_ID]||Kr(e,"phoneNumber",null),bf(e)})):bf(e).then((function(){throw new x("no-such-provider")}))})))},e.delete=function(){var t=this;return jf(this,this.I().then((function(e){return Qs(t.a,Es,{idToken:e})})).then((function(){t.dispatchEvent(new tf("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");hf(t,null),lf(t,null),df(t,null),t.G=[],t.A=!0,yf(t),Kr(t,"refreshToken",null),t.i&&xc(t.i,t)}))},e.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.h||null)==e&&this.g||"reauthViaPopup"==t&&(this.h||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},e.ma=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.h||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.h||null)?E(this.Jb,this):"reauthViaPopup"==t&&e==(this.h||null)?E(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?E(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?E(this.Kb,this):null},e.Dc=function(t){var e=this;return Cf(this,"linkViaPopup",t,(function(){return Lf(e,t.providerId).then((function(){return bf(e)}))}),!1)},e.Mc=function(t){return Cf(this,"reauthViaPopup",t,(function(){return Se()}),!0)},e.Ec=function(t){var e=this;return Pf(this,"linkViaRedirect",t,(function(){return Lf(e,t.providerId)}),!1)},e.Nc=function(t){return Pf(this,"reauthViaRedirect",t,(function(){return Se()}),!0)},e.Jb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return jf(this,this.I().then((function(n){return vs(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Rf(i,t,"link"),Df(i,t)})).then((function(){return o})))},e.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return jf(this,Se().then((function(){return ao(gs(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Rf(i,t,"reauthenticate"),Nf(i,t),i.f=null,i.reload()})).then((function(){return o})),!0)},e.tb=function(t){var e=this,n=null;return jf(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:ji(new Si(t))})).then((function(t){return e.a.tb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.Db=function(t,e){var n=this,r=null;return jf(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:ji(new Si(e))})).then((function(e){return n.a.Db(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},e.ic=function(t){var e=null,n=this;return jf(this,t=ao(Se(t),n.uid).then((function(t){return e=Rf(n,t,"reauthenticate"),Nf(n,t),n.f=null,n.reload()})).then((function(){return e})),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),G(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),mt(t,this.N.w()),t};var Vf={name:"redirectUser",D:"session"};function Bf(t){return Ju(t.b,Vf,t.a)}function qf(t){this.a=t,this.b=Ku(),this.c=null,this.f=function(t){var e=Hf("local"),n=Hf("session"),r=Hf("none");return function(t,e,n){var r=Yu(e,n),i=Xu(t,e.D);return t.get(e,n).then((function(o){var a=null;try{a=Cr(u.localStorage.getItem(r))}catch(s){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Gf,t.a).then((function(t){return t?Hf(t):e}))}))}))})).then((function(e){return t.c=e,zf(t,e.D)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Hf("local"),this.a,E(this.g,this))}function zf(t,e){var n,r=[];for(n in Hu)Hu[n]!==e&&r.push(Ju(t.b,Hf(Hu[n]),t.a));return r.push(Ju(t.b,Gf,t.a)),function(t){return new we((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Oe(t[s],I(o,s),a);else e(i)}))}(r)}qf.prototype.g=function(){var t=this,e=Hf("local");Yf(this,(function(){return Se().then((function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null})).then((function(n){if(n)return zf(t,"local").then((function(){t.c=e}))}))}))};var Gf={name:"persistence",D:"session"};function Hf(t){return{name:"authUser",D:t}}function Wf(t,e){return Yf(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function Kf(t){return Yf(t,(function(){return Ju(t.b,t.c,t.a)}))}function Xf(t,e,n){return Yf(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Uf(t||{})}))}))}function Yf(t,e){return t.f=t.f.then(e,e),t.f}function Jf(t){if(this.m=!1,Kr(this,"settings",new qc),Kr(this,"app",t),!ih(this).options||!ih(this).options.apiKey)throw new x("invalid-api-key");t=n.SDK_VERSION?Tr(n.SDK_VERSION):null,this.a=new Ha(ih(this).options&&ih(this).options.apiKey,R(k),t),this.R=[],this.u=[],this.P=[],this.ac=n.INTERNAL.createSubscribe(E(this.yc,this)),this.X=void 0,this.bc=n.INTERNAL.createSubscribe(E(this.zc,this)),nh(this,null),this.l=new qf(ih(this).options.apiKey+":"+ih(this).name),this.G=new Ff(ih(this).options.apiKey+":"+ih(this).name),this.$=uh(this,function(t){var e=ih(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Vf,t.a).then((function(t){return t&&e&&(t.authDomain=e),Uf(t||{})}))}(t.G,ih(t).options.authDomain).then((function(e){return(t.o=e)&&(e.ha=t.G),Bf(t.G)}));return uh(t,e)}(t).then((function(){return Xf(t.l,e,t.f)})).then((function(e){return e?(e.ha=t.G,t.o&&(t.o.ga||null)==(e.ga||null)?e:e.reload().then((function(){return Wf(t.l,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:Kf(t.l)}))):null})).then((function(e){nh(t,e||null)}));return uh(t,n)}(this)),this.i=uh(this,function(t){return t.$.then((function(){return eh(t)})).s((function(){})).then((function(){if(!t.m)return t.pa()})).s((function(){})).then((function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(Hf("local"),e.a,t.pa)}}))}(this)),this.ba=!1,this.pa=E(this.Yc,this),this.Ba=E(this.da,this),this.ya=E(this.kc,this),this.za=E(this.vc,this),this.Aa=E(this.wc,this),this.b=null,function(t){var e=ih(t).options.authDomain,n=ih(t).options.apiKey;e&&kr()&&(t.gb=t.$.then((function(){if(!t.m){if(t.b=Pc(e,n,ih(t).name,t.f),Ac(t.b,t),oh(t)&&wf(oh(t)),t.o){wf(t.o);var r=t.o;r.wa(t.ka()),hf(r,t),pf(r=t.o,t.N),df(r,t),Za((r=t.o).a,t.f),lf(r,t),t.o=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=E(this.delete,this),this.INTERNAL.logFramework=E(this.Fc,this),this.A=0,wn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function Qf(t){Ye.call(this,"languageCodeChanged"),this.h=t}function $f(t){Ye.call(this,"emulatorConfigChanged"),this.c=t}function Zf(t){Ye.call(this,"frameworkChanged"),this.f=t}function th(t){return t.gb||ke(new x("auth-domain-config-required"))}function eh(t){if(!kr())return ke(new x("operation-not-supported-in-this-environment"));var e=th(t).then((function(){return t.b.qa()})).then((function(t){return t?Yr(t):null}));return uh(t,e)}function nh(t,e){oh(t)&&(function(t,e){J(t.R,(function(t){return t==e}))}(oh(t),t.Ba),hn(oh(t),"tokenChanged",t.ya),hn(oh(t),"userDeleted",t.za),hn(oh(t),"userInvalidated",t.Aa),yf(oh(t))),e&&(e.R.push(t.Ba),un(e,"tokenChanged",t.ya),un(e,"userDeleted",t.za),un(e,"userInvalidated",t.Aa),0<t.A&&gf(e)),Kr(t,"currentUser",e),e&&(e.wa(t.ka()),hf(e,t),pf(e,t.N),df(e,t),Za(e.a,t.f),lf(e,t))}function rh(t,e){var n=null,r=null;return uh(t,e.then((function(e){return n=Po(e),r=Wi(e),function(t,e){var n={};return n.apiKey=ih(t).options.apiKey,n.authDomain=ih(t).options.authDomain,n.appName=ih(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then((function(){return function(t,e,n,r){var i=new ff(t,e);return n&&(i.ha=n),r&&pf(i,r),i.reload().then((function(){return i}))}(n,e,t.G,t.Ga())})).then((function(e){return oh(t)&&e.uid==oh(t).uid?(kf(oh(t),e),t.da(e)):(nh(t,e),wf(e),t.da(e))})).then((function(){sh(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Jc(e.w(),t,E(t.jc,t))),n||e})).then((function(){return Yr({user:oh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function ih(t){return t.app}function oh(t){return t.currentUser}function ah(t){return oh(t)&&oh(t)._lat||null}function sh(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](ah(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](ah(t))}}function uh(t,e){return t.R.push(e),e.na((function(){Y(t.R,e)})),e}function ch(){}function fh(){this.a={},this.b=1e12}qf.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new x("invalid-persistence-type"),n=new x("unsupported-persistence-type");t:{for(r in Hu)if(Hu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(br()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Tu()&&"none"!==t)throw n;break;default:if(!Sr()&&"none"!==t)throw n}}(t),Yf(this,(function(){return t!=n.c.D?n.b.get(n.c,n.a).then((function(r){return e=r,zf(n,t)})).then((function(){if(n.c=Hf(t),e)return n.b.set(n.c,e,n.a)})):Se()}))},A(Jf,wn),A(Qf,Ye),A($f,Ye),A(Zf,Ye),(e=Jf.prototype).wb=function(t){return uh(this,t=this.l.wb(t))},e.wa=function(t){this.aa===t||this.m||(this.aa=t,$a(this.a,this.aa),this.dispatchEvent(new Qf(this.ka())))},e.ka=function(){return this.aa},e.ed=function(){var t=u.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.fd=function(t){if(!this.f){if(!/^https?:\/\//.test(t))throw new x("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Vr("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&vr().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)})),this.f={url:t},this.settings.hb=!0,Za(this.a,this.f),this.dispatchEvent(new $f(this.f))}},e.Fc=function(t){this.N.push(t),es(this.a,n.SDK_VERSION?Tr(n.SDK_VERSION,this.N):null),this.dispatchEvent(new Zf(this.N))},e.Ga=function(){return $(this.N)},e.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},e.S=function(){return this.W},e.toJSON=function(){return{apiKey:ih(this).options.apiKey,authDomain:ih(this).options.authDomain,appName:ih(this).name,currentUser:oh(this)&&oh(this).w()}},e.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==e&&!!this.g;default:return!1}},e.ma=function(t,e,n,r){"signInViaPopup"==t&&this.h==r&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},e.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.h==e&&this.g?E(this.hc,this):null},e.hc=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return rh(i,ds(i.a,o))}))},e.Wc=function(t){if(!kr())return ke(new x("operation-not-supported-in-this-environment"));var e=this,r=Hi(t.providerId),i=Pr(),o=null;(!Lr()||yr())&&ih(this).options.authDomain&&t.isOAuthProvider&&(o=lu(ih(this).options.authDomain,ih(this).options.apiKey,ih(this).name,"signInViaPopup",t,null,i,n.SDK_VERSION||null,null,null,this.S(),this.f));var a=lr(o,r&&r.ua,r&&r.ta);return uh(this,r=th(this).then((function(n){return Oc(n,a,"signInViaPopup",t,i,!!o,e.S())})).then((function(){return new we((function(t,n){e.ma("signInViaPopup",null,new x("cancelled-popup-request"),e.h),e.g=t,e.O=n,e.h=i,e.c=Rc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&hr(a),t?Yr(t):null})).s((function(t){throw a&&hr(a),t})))},e.Xc=function(t){if(!kr())return ke(new x("operation-not-supported-in-this-environment"));var e=this;return uh(this,th(this).then((function(){return Yf(t=e.l,(function(){return t.b.set(Gf,t.c.D,t.a)}));var t})).then((function(){return Lc(e.b,"signInViaRedirect",t,void 0,e.S())})))},e.qa=function(){var t=this;return eh(this).then((function(e){return t.b&&Uc(t.b.b),e})).s((function(e){throw t.b&&Uc(t.b.b),e}))},e.cd=function(t){if(!t)return ke(new x("null-user"));if(this.W!=t.tenantId)return ke(new x("tenant-id-mismatch"));var e=this,n={};n.apiKey=ih(this).options.apiKey,n.authDomain=ih(this).options.authDomain,n.appName=ih(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Ka]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ff(e||{apiKey:t.l,authDomain:t.o,appName:t.m},o),n&&(e.ha=n),r&&pf(e,r),kf(e,t),e}(t,n,e.G,e.Ga());return uh(this,this.i.then((function(){if(ih(e).options.apiKey!=t.l)return r.reload()})).then((function(){return oh(e)&&t.uid==oh(e).uid?(kf(oh(e),t),e.da(t)):(nh(e,r),wf(r),e.da(r))})).then((function(){sh(e)})))},e.zb=function(){var t=this;return uh(this,this.i.then((function(){return t.b&&Uc(t.b.b),oh(t)?(nh(t,null),Kf(t.l).then((function(){sh(t)}))):Se()})))},e.Yc=function(){var t=this;return Xf(this.l,ih(this).options.authDomain).then((function(e){if(!t.m){var n;if(n=oh(t)&&e){n=oh(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return kf(oh(t),e),oh(t).I();(oh(t)||e)&&(nh(t,e),e&&(wf(e),e.ha=t.G),t.b&&Ac(t.b,t),sh(t))}}))},e.da=function(t){return Wf(this.l,t)},e.kc=function(){sh(this),this.da(oh(this))},e.vc=function(){this.zb()},e.wc=function(){this.zb()},e.jc=function(t){var e=this;return this.i.then((function(){return rh(e,Se(t))}))},e.yc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(oh(e))}))},e.zc=function(t){var e=this;!function(t,e){t.P.push(e),uh(t,t.i.then((function(){!t.m&&X(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(ah(t)))})))}(this,(function(){t.next(oh(e))}))},e.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(oh(r)):"function"==typeof t.next&&t.next(oh(r))})),this.ac(t,e,n)},e.Gc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(oh(r)):"function"==typeof t.next&&t.next(oh(r))})),this.bc(t,e,n)},e.mc=function(t){var e=this;return uh(this,this.i.then((function(){return oh(e)?oh(e).I(t).then((function(t){return{accessToken:t}})):null})))},e.Sc=function(t){var e=this;return this.i.then((function(){return rh(e,Qs(e.a,Hs,{token:t}))})).then((function(t){var n=t.user;return Sf(n,"isAnonymous",!1),e.da(n),t}))},e.Tc=function(t,e){var n=this;return this.i.then((function(){return rh(n,Qs(n.a,Ws,{email:t,password:e}))}))},e.dc=function(t,e){var n=this;return this.i.then((function(){return rh(n,Qs(n.a,ws,{email:t,password:e}))}))},e.Za=function(t){var e=this;return this.i.then((function(){return rh(e,t.ja(e.a))}))},e.Rc=function(t){return Hr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},e.yb=function(){var t=this;return this.i.then((function(){var e=oh(t);if(e&&e.isAnonymous){var n=Yr({providerId:null,isNewUser:!1});return Yr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return rh(t,t.a.yb()).then((function(e){var n=e.user;return Sf(n,"isAnonymous",!0),t.da(n),e}))}))},e.getUid=function(){return oh(this)&&oh(this).uid||null},e.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&oh(this)&&gf(oh(this))},e.Oc=function(t){var e=this;G(this.u,(function(n){n==t&&e.A--})),0>this.A&&(this.A=0),0==this.A&&oh(this)&&yf(oh(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.u.push(t),uh(this,this.i.then((function(){e.m||X(e.u,t)&&t(ah(e))})))},e.removeAuthTokenListener=function(t){J(this.u,(function(e){return e==t}))},e.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(Hf("local"),t.a,this.pa),this.b&&(xc(this.b,this),Uc(this.b.b)),Promise.resolve()},e.gc=function(t){return uh(this,function(t,e){return Qs(t,_s,{identifier:e,continueUri:Or()?ur():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},e.Ac=function(t){return!!Oo(t)},e.vb=function(t,e){var n=this;return uh(this,Se().then((function(){var t=new Si(e);if(!t.c)throw new x("argument-error",Ni+" must be true when sending sign in link to email");return ji(t)})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},e.hd=function(t){return this.Qa(t).then((function(t){return t.data.email}))},e.mb=function(t,e){return uh(this,this.a.mb(t,e).then((function(){})))},e.Qa=function(t){return uh(this,this.a.Qa(t).then((function(t){return new ii(t)})))},e.ib=function(t){return uh(this,this.a.ib(t).then((function(){})))},e.ub=function(t,e){var n=this;return uh(this,Se().then((function(){return void 0===e||vt(e)?{}:ji(new Si(e))})).then((function(e){return n.a.ub(t,e)})).then((function(){})))},e.Vc=function(t,e){return uh(this,Gc(this,t,e,E(this.Za,this)))},e.Uc=function(t,e){var n=this;return uh(this,Se().then((function(){var r=e||ur(),i=ko(t,r);if(!(r=Oo(r)))throw new x("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new x("tenant-id-mismatch");return n.Za(i)})))},ch.prototype.render=function(){},ch.prototype.reset=function(){},ch.prototype.getResponse=function(){},ch.prototype.execute=function(){};var hh=null;function lh(t,e){return(e=ph(e))&&t.a[e]||null}function ph(t){return(t=void 0===t?1e12:t)?t.toString():null}function dh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ue(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():un(this.f,"click",this.i)}function vh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function gh(){}function yh(){}fh.prototype.render=function(t,e){return this.a[this.b.toString()]=new dh(t,e),this.b++},fh.prototype.reset=function(t){var e=lh(this,t);t=ph(t),e&&t&&(e.delete(),delete this.a[t])},fh.prototype.getResponse=function(t){return(t=lh(this,t))?t.getResponse():null},fh.prototype.execute=function(t){(t=lh(this,t))&&t.execute()},dh.prototype.getResponse=function(){return vh(this),this.b},dh.prototype.execute=function(){vh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},dh.prototype.delete=function(){vh(this),this.g=!0,clearTimeout(this.a),this.a=null,hn(this.f,"click",this.i)},Kr(gh,"FACTOR_ID","phone"),yh.prototype.g=function(){return hh||(hh=new fh),Se(hh)},yh.prototype.c=function(){};var mh=null;function bh(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var wh=new wt(It,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),_h=new Ur(3e4,6e4);bh.prototype.g=function(t){var e=this;return new we((function(n,r){var i=setTimeout((function(){r(new x("network-request-failed"))}),_h.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new x("internal-error"));delete u[e.a]},Se(Ua(St(wh,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(i),r(new x("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},bh.prototype.c=function(){this.b--};var Eh=null;function Ih(t,e,n,r,i,o,a){if(Kr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,a?(mh||(mh=new yh),a=mh):(Eh||(Eh=new bh),a=Eh),this.v=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[xh])throw new x("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Sh],!u.document)throw new x("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ue(e)||!this.i&&ue(e).hasChildNodes())throw new x("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Ha(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Th];this.a[Th]=function(t){if(kh(s,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=xr(c,u);"function"==typeof e&&e(t)}};var f=this.a[Ah];this.a[Ah]=function(){if(kh(s,null),"function"==typeof f)f();else if("string"==typeof f){var t=xr(f,u);"function"==typeof t&&t()}}}var Th="callback",Ah="expired-callback",xh="sitekey",Sh="size";function kh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function Oh(t,e){return t.h.push(e),e.na((function(){Y(t.h,e)})),e}function Nh(t){if(t.A)throw new x("internal-error","RecaptchaVerifier instance has been destroyed.")}function Lh(t,e,r){var i=!1;try{this.b=r||n.app()}catch(s){throw new x("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new x("invalid-api-key");r=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=n.SDK_VERSION?Tr(n.SDK_VERSION,a):null,Ih.call(this,r,t,e,(function(){try{var t=o.b.auth().ka()}catch(e){t=null}return t}),a,R(k),i)}function Rh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new x("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!o){if(e=e[i],0>i||i>=Dh.length)throw new x("internal-error","Argument validator received an unsupported number of arguments.");n=Dh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new x("argument-error",t+" failed: "+r)}(e=Ih.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Oh(this,Se().then((function(){if(Or()&&!mr())return vr();throw new x("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.v.g(t.u())})).then((function(e){return t.g=e,Qs(t.o,Cs,{})})).then((function(e){t.a[xh]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},e.render=function(){Nh(this);var t=this;return Oh(this,this.Ia().then((function(){if(null===t.c){var e=t.m;if(!t.i){var n=ue(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!se&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Gt(a.name),'"'),a.type){o.push(' type="',Gt(a.type),'"');var s={};mt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=pe(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):ce(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!p(o)||g(o)&&0<o.nodeType?r(o):G(de(o)?$(o):o,r)}}(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){Nh(this);var t=this;return Oh(this,this.render().then((function(e){return new we((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){J(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){Nh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Nh(this),this.A=!0,this.v.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ue(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},A(Lh,Ih);var Dh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ch(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Ph(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Mh(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:g}}function jh(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function Uh(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Fh(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ja||!n)}}}function Vh(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Bh(t){return g(t)&&"string"==typeof t.uid}function qh(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function zh(t,e){for(var n in e){var r=e[n].name;t[r]=Wh(r,t[n],e[n].j)}}function Gh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){Rh(t,[n],[r],!0),this[e]=r}),r,n,e[n].jb),enumerable:!0})}}function Hh(t,e,n,r){t[e]=Wh(e,n,r)}function Wh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Rh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}zh(Jf.prototype,{ib:{name:"applyActionCode",j:[Ch("code")]},Qa:{name:"checkActionCode",j:[Ch("code")]},mb:{name:"confirmPasswordReset",j:[Ch("code"),Ch("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ch("email"),Ch("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Ch("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Ch("emailLink")]},Gc:{name:"onAuthStateChanged",j:[qh(Mh(),jh(),"nextOrObserver"),jh("opt_error",!0),jh("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[qh(Mh(),jh(),"nextOrObserver"),jh("opt_error",!0),jh("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Ch("email"),qh(Mh("opt_actionCodeSettings",!0),Uh(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Ch("email"),Mh("actionCodeSettings")]},wb:{name:"setPersistence",j:[Ch("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Fh()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Fh()]},Sc:{name:"signInWithCustomToken",j:[Ch("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Ch("email"),Ch("password")]},Uc:{name:"signInWithEmailLink",j:[Ch("email"),Ch("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Ch("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[qh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ff)}},Uh(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Ch("url")]},hd:{name:"verifyPasswordResetCode",j:[Ch("code")]}}),Gh(Jf.prototype,{lc:{name:"languageCode",jb:qh(Ch(),Uh(),"languageCode")},ti:{name:"tenantId",jb:qh(Ch(),Uh(),"tenantId")}}),Jf.Persistence=Hu,Jf.Persistence.LOCAL="local",Jf.Persistence.SESSION="session",Jf.Persistence.NONE="none",zh(ff.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Ph("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Ph("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Fh()]},pb:{name:"linkWithCredential",j:[Fh()]},Cc:{name:"linkWithPhoneNumber",j:[Ch("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Fh()]},sb:{name:"reauthenticateWithCredential",j:[Fh()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Ch("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[qh(Mh("opt_actionCodeSettings",!0),Uh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},bd:{name:"unlink",j:[Ch("provider")]},Ab:{name:"updateEmail",j:[Ch("email")]},Bb:{name:"updatePassword",j:[Ch("password")]},dd:{name:"updatePhoneNumber",j:[Fh("phone")]},Cb:{name:"updateProfile",j:[Mh("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Ch("email"),qh(Mh("opt_actionCodeSettings",!0),Uh(null,!0),"opt_actionCodeSettings",!0)]}}),zh(fh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),zh(ch.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),zh(we.prototype,{na:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Gh(qc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Ph("appVerificationDisabledForTesting")}}),zh(zc.prototype,{confirm:{name:"confirm",j:[Ch("verificationCode")]}}),Hh(oo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[lo,xo,Lo,co],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[qh(Ch(),Mh(),"json")]),Hh(So,"credential",(function(t,e){return new Ao(t,e)}),[Ch("email"),Ch("password")]),zh(Ao.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),zh(yo.prototype,{Ca:{name:"addScope",j:[Ch("scope")]},Ka:{name:"setCustomParameters",j:[Mh("customOAuthParameters")]}}),Hh(yo,"credential",mo,[qh(Ch(),Mh(),"token")]),Hh(So,"credentialWithLink",ko,[Ch("email"),Ch("emailLink")]),zh(bo.prototype,{Ca:{name:"addScope",j:[Ch("scope")]},Ka:{name:"setCustomParameters",j:[Mh("customOAuthParameters")]}}),Hh(bo,"credential",wo,[qh(Ch(),Mh(),"token")]),zh(_o.prototype,{Ca:{name:"addScope",j:[Ch("scope")]},Ka:{name:"setCustomParameters",j:[Mh("customOAuthParameters")]}}),Hh(_o,"credential",Eo,[qh(Ch(),qh(Mh(),Uh()),"idToken"),qh(Ch(),Uh(),"accessToken",!0)]),zh(Io.prototype,{Ka:{name:"setCustomParameters",j:[Mh("customOAuthParameters")]}}),Hh(Io,"credential",To,[qh(Ch(),Mh(),"token"),Ch("secret",!0)]),zh(go.prototype,{Ca:{name:"addScope",j:[Ch("scope")]},credential:{name:"credential",j:[qh(Ch(),qh(Mh(),Uh()),"optionsOrIdToken"),qh(Ch(),Uh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Mh("customOAuthParameters")]}}),zh(fo.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),zh(so.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),Hh(Do,"credential",Co,[Ch("verificationId"),Ch("verificationCode")]),zh(Do.prototype,{eb:{name:"verifyPhoneNumber",j:[qh(Ch(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Vh(t.session,ro)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Vh(t.session,io)&&Bh(t.multiFactorHint):t.session&&t.multiFactorUid?Vh(t.session,io)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),zh(No.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),zh(x.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),zh(zo.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),zh(qo.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),zh(Yc.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),zh(Wc.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),zh(ef.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Ch("displayName",!0)]},ad:{name:"unenroll",j:[qh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Bh},Ch(),"multiFactorInfoIdentifier")]}}),zh(Lh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Hh(mi,"parseLink",xi,[Ch("link")]),Hh(gh,"assertion",(function(t){return new Zc(t)}),[Fh("phone")]),function(){if(void 0===n||!n.INTERNAL||!n.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ai,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:oi,VERIFY_AND_CHANGE_EMAIL:si,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Jf,AuthCredential:oo,Error:x};Hh(t,"EmailAuthProvider",So,[]),Hh(t,"FacebookAuthProvider",yo,[]),Hh(t,"GithubAuthProvider",bo,[]),Hh(t,"GoogleAuthProvider",_o,[]),Hh(t,"TwitterAuthProvider",Io,[]),Hh(t,"OAuthProvider",go,[Ch("providerId")]),Hh(t,"SAMLAuthProvider",vo,[Ch("providerId")]),Hh(t,"PhoneAuthProvider",Do,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Jf)}}]),Hh(t,"RecaptchaVerifier",Lh,[qh(Ch(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Mh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof n.app.App)}}]),Hh(t,"ActionCodeURL",mi,[]),Hh(t,"PhoneMultiFactorGenerator",gh,[]),n.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Jf(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),n.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:E((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:E(t.mc,t),addAuthTokenListener:E(t.cc,t),removeAuthTokenListener:E(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),n.registerVersion("@firebase/auth","0.15.0"),n.INTERNAL.extendNamespace({User:ff})}()}).apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var gt={};(function(t){(function(){(function(){var e;function n(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function r(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:n(t)}}var i,o="function"==typeof Object.create?Object.create:function(t){function e(){}return e.prototype=t,new e},a="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},s=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(t,e){if(e)t:{var n=s;t=t.split(".");for(var r=0;r<t.length-1;r++){var i=t[r];if(!(i in n))break t;n=n[i]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&a(n,t,{configurable:!0,writable:!0,value:e})}}if("function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{var c;t:{var f={};try{f.__proto__={Ha:!0},c=f.Ha;break t}catch(J){}c=!1}i=c?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var h=i;function l(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}u("Symbol",(function(t){function e(t,e){this.a=t,a(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.a};var n=0;return function t(r){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e("jscomp_symbol_"+(r||"")+"_"+n++,r)}})),u("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<e.length;r++){var i=s[e[r]];"function"==typeof i&&"function"!=typeof i.prototype[t]&&a(i.prototype,t,{configurable:!0,writable:!0,value:function(){return l(n(this))}})}return t})),u("WeakMap",(function(t){function e(t){if(this.a=(c+=Math.random()+1).toString(),t){t=r(t);for(var e;!(e=t.next()).done;)e=e.value,this.set(e[0],e[1])}}function n(){}function i(t){var e=typeof t;return"object"===e&&null!==t||"function"===e}function o(t){if(!p(t,u)){var e=new n;a(t,u,{value:e})}}function s(t){var e=Object[t];e&&(Object[t]=function(t){return t instanceof n?t:(Object.isExtensible(t)&&o(t),e(t))})}if(function(){if(!t||!Object.seal)return!1;try{var e=Object.seal({}),n=Object.seal({}),r=new t([[e,2],[n,3]]);return 2==r.get(e)&&3==r.get(n)&&(r.delete(e),r.set(n,4),!r.has(e)&&4==r.get(n))}catch(i){return!1}}())return t;var u="$jscomp_hidden_"+Math.random();s("freeze"),s("preventExtensions"),s("seal");var c=0;return e.prototype.set=function(t,e){if(!i(t))throw Error("Invalid WeakMap key");if(o(t),!p(t,u))throw Error("WeakMap key fail: "+t);return t[u][this.a]=e,this},e.prototype.get=function(t){return i(t)&&p(t,u)?t[u][this.a]:void 0},e.prototype.has=function(t){return i(t)&&p(t,u)&&p(t[u],this.a)},e.prototype.delete=function(t){return!!(i(t)&&p(t,u)&&p(t[u],this.a))&&delete t[u][this.a]},e})),u("Map",(function(t){function e(){var t={};return t.O=t.next=t.head=t}function n(t,e){var n=t.a;return l((function(){if(n){for(;n.head!=t.a;)n=n.O;for(;n.next!=n.head;)return n=n.next,{done:!1,value:e(n)};n=null}return{done:!0,value:void 0}}))}function i(t,e){var n=e&&typeof e;"object"==n||"function"==n?a.has(e)?n=a.get(e):(n=""+ ++s,a.set(e,n)):n="p_"+e;var r=t.b[n];if(r&&p(t.b,n))for(t=0;t<r.length;t++){var i=r[t];if(e!=e&&i.key!=i.key||e===i.key)return{id:n,list:r,index:t,D:i}}return{id:n,list:r,index:-1,D:void 0}}function o(t){if(this.b={},this.a=e(),this.size=0,t){t=r(t);for(var n;!(n=t.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!t||"function"!=typeof t||!t.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),n=new t(r([[e,"s"]]));if("s"!=n.get(e)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),o=i.next();return!o.done&&o.value[0]==e&&"s"==o.value[1]&&!((o=i.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!i.next().done)}catch(a){return!1}}())return t;var a=new WeakMap;o.prototype.set=function(t,e){var n=i(this,t=0===t?0:t);return n.list||(n.list=this.b[n.id]=[]),n.D?n.D.value=e:(n.D={next:this.a,O:this.a.O,head:this.a,key:t,value:e},n.list.push(n.D),this.a.O.next=n.D,this.a.O=n.D,this.size++),this},o.prototype.delete=function(t){return!(!(t=i(this,t)).D||!t.list||(t.list.splice(t.index,1),t.list.length||delete this.b[t.id],t.D.O.next=t.D.next,t.D.next.O=t.D.O,t.D.head=null,this.size--,0))},o.prototype.clear=function(){this.b={},this.a=this.a.O=e(),this.size=0},o.prototype.has=function(t){return!!i(this,t).D},o.prototype.get=function(t){return(t=i(this,t).D)&&t.value},o.prototype.entries=function(){return n(this,(function(t){return[t.key,t.value]}))},o.prototype.keys=function(){return n(this,(function(t){return t.key}))},o.prototype.values=function(){return n(this,(function(t){return t.value}))},o.prototype.forEach=function(t,e){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,t.call(e,n[1],n[0],this)},o.prototype[Symbol.iterator]=o.prototype.entries;var s=0;return o})),u("Set",(function(t){function e(t){if(this.a=new Map,t){t=r(t);for(var e;!(e=t.next()).done;)this.add(e.value)}this.size=this.a.size}return function(){if(!t||"function"!=typeof t||!t.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),n=new t(r([e]));if(!n.has(e)||1!=n.size||n.add(e)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),o=i.next();return!o.done&&o.value[0]==e&&o.value[1]==e&&!(o=i.next()).done&&o.value[0]!=e&&4==o.value[0].x&&o.value[1]==o.value[0]&&i.next().done}catch(a){return!1}}()?t:(e.prototype.add=function(t){return t=0===t?0:t,this.a.set(t,t),this.size=this.a.size,this},e.prototype.delete=function(t){return t=this.a.delete(t),this.size=this.a.size,t},e.prototype.clear=function(){this.a.clear(),this.size=0},e.prototype.has=function(t){return this.a.has(t)},e.prototype.entries=function(){return this.a.entries()},e.prototype.values=function(){return this.a.values()},e.prototype.keys=e.prototype.values,e.prototype[Symbol.iterator]=e.prototype.values,e.prototype.forEach=function(t,e){var n=this;this.a.forEach((function(r){return t.call(e,r,r,n)}))},e)})),u("Array.prototype.values",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r={next:function(){if(n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,(function(t,e){return e}))}}));var v=v||{},g=this||self;function y(){}function m(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function b(t){var e=m(t);return"array"==e||"object"==e&&"number"==typeof t.length}function w(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function _(t){return Object.prototype.hasOwnProperty.call(t,E)&&t[E]||(t[E]=++I)}var E="closure_uid_"+(1e9*Math.random()>>>0),I=0;function T(t,e,n){return t.call.apply(t.bind,arguments)}function A(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?T:A).apply(null,arguments)}function S(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var k=Date.now;function O(t,e){function n(){}n.prototype=e.prototype,t.P=e.prototype,t.prototype=new n,t.prototype.constructor=t}function N(){0!=L&&(R[_(this)]=this),this.j=this.j,this.i=this.i}var L=0,R={};N.prototype.j=!1,N.prototype.la=function(){if(!this.j&&(this.j=!0,this.H(),0!=L)){var t=_(this);if(0!=L&&this.i&&0<this.i.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete R[t]}},N.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var D=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},C=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function P(t){return Array.prototype.concat.apply([],arguments)}function M(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function j(t){return/^[\s\xa0]*$/.test(t)}var U,F=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function V(t,e){return-1!=t.indexOf(e)}function B(t,e){return t<e?-1:t>e?1:0}t:{var q=g.navigator;if(q){var z=q.userAgent;if(z){U=z;break t}}U=""}function G(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function H(t){var e,n={};for(e in t)n[e]=t[e];return n}var W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function K(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<W.length;o++)n=W[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function X(t){return X[" "](t),t}X[" "]=y;var Y,J,Q=V(U,"Opera"),$=V(U,"Trident")||V(U,"MSIE"),Z=V(U,"Edge"),tt=Z||$,et=V(U,"Gecko")&&!(V(U.toLowerCase(),"webkit")&&!V(U,"Edge"))&&!(V(U,"Trident")||V(U,"MSIE"))&&!V(U,"Edge"),nt=V(U.toLowerCase(),"webkit")&&!V(U,"Edge");function rt(){var t=g.document;return t?t.documentMode:void 0}t:{var it="",ot=(J=U,et?/rv:([^\);]+)(\)|;)/.exec(J):Z?/Edge\/([\d\.]+)/.exec(J):$?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(J):nt?/WebKit\/(\S+)/.exec(J):Q?/(?:Version)[ \/]?(\S+)/.exec(J):void 0);if(ot&&(it=ot?ot[1]:""),$){var at=rt();if(null!=at&&at>parseFloat(it)){Y=String(at);break t}}Y=it}var st,ut={};function ct(t){return function(t,e){var n=ut;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=F(String(Y)).split("."),r=F(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=B(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||B(0==a[2].length,0==s[2].length)||B(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}g.document&&$?st=rt()||parseInt(Y,10)||void 0:st=void 0;var ft=st,ht=!$||9<=Number(ft),lt=$&&!ct("9"),pt=function(){if(!g.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{g.addEventListener("test",y,e),g.removeEventListener("test",y,e)}catch(n){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function vt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(et){t:{try{X(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:yt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},O(vt,dt);var yt={2:"touch",3:"pen",4:"mouse"};vt.prototype.b=function(){vt.P.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var mt="closure_listenable_"+(1e6*Math.random()|0),bt=0;function wt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ea=i,this.key=++bt,this.$=this.aa=!1}function _t(t){t.$=!0,t.listener=null,t.proxy=null,t.src=null,t.ea=null}function Et(t){this.src=t,this.a={},this.b=0}function It(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=D(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(_t(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Tt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.$&&o.listener==e&&o.capture==!!n&&o.ea==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Tt(t,e,r,i);return-1<a?(e=t[a],n||(e.aa=!1)):((e=new wt(e,this.src,o,!!r,i)).aa=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),xt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=Pt(r),e&&e[mt]?e.ya(n,r,w(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=Pt(n),t&&t[mt]?t.xa(e,n,w(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=w(i)?!!i.capture:!!i;if(a&&!ht)return null;var s=Dt(t);if(s||(t[At]=s=new Et(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Rt,e=ht?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)pt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Nt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){if("number"!=typeof t&&t&&!t.$){var e=t.src;if(e&&e[mt])It(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Nt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Dt(e))?(It(n,t),0==n.b&&(n.src=null,e[At]=null)):_t(t)}}}function Nt(t){return t in xt?xt[t]:xt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ea||t.src;return t.aa&&Ot(t),n.call(r,e)}function Rt(t,e){if(t.$)return!0;if(!ht){if(!e)t:{e=["window","event"];for(var n=g,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new vt(e,this))}return Lt(t,new vt(e,this))}function Dt(t){return(t=t[At])instanceof Et?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pt(t){return"function"==m(t)?t:(t[Ct]||(t[Ct]=function(e){return t.handleEvent(e)}),t[Ct])}function Mt(){N.call(this),this.c=new Et(this),this.K=this,this.C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.$&&a.capture==n){var s=a.listener,u=a.ea||a.src;a.aa&&It(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}O(Mt,N),Mt.prototype[mt]=!0,(e=Mt.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},e.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=w(i)?!!i.capture:!!i,r=Pt(r),e&&e[mt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Tt(a=e.a[n],r,i,o))&&(_t(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=Dt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Tt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ot(r))}(this,t,e,n,r)},e.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.K;var r=t.type||t;if("string"==typeof t)t=new dt(t,n);else if(t instanceof dt)t.target=t.target||n;else{var i=t;K(t=new dt(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=jt(a,r,!0,t)&&i}if(i=jt(a=t.a=n,r,!0,t)&&i,i=jt(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=jt(a=t.a=e[o],r,!1,t)&&i;return i},e.H=function(){if(Mt.P.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},e.xa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},e.ya=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=g.JSON.stringify;function Ft(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Vt(){this.b=this.a=null}Ft.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Bt,qt=new Ft((function(){return new Gt}),(function(t){t.reset()}));function zt(){var t=Xt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Gt(){this.next=this.b=this.a=null}function Ht(t){g.setTimeout((function(){throw t}),0)}function Wt(t,e){Bt||function(){var t=g.Promise.resolve(void 0);Bt=function(){t.then(Yt)}}(),Kt||(Bt(),Kt=!0),Xt.add(t,e)}Vt.prototype.add=function(t,e){var n=qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Gt.prototype.reset=function(){this.next=this.b=this.a=null};var Kt=!1,Xt=new Vt;function Yt(){for(var t;t=zt();){try{t.a.call(t.b)}catch(n){Ht(n)}var e=qt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Kt=!1}function Jt(t,e){Mt.call(this),this.b=t||1,this.a=e||g,this.f=x(this.ab,this),this.g=k()}function Qt(t){t.ca=!1,t.N&&(t.a.clearTimeout(t.N),t.N=null)}function $t(t,e,n){if("function"==m(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:g.setTimeout(t,e||0)}function Zt(t,e,n){N.call(this),this.g=null!=n?t.bind(n):t,this.h=e,this.b=null,this.c=!1,this.a=null}if(O(Jt,Mt),(e=Jt.prototype).ca=!1,e.N=null,e.ab=function(){if(this.ca){var t=k()-this.g;0<t&&t<.8*this.b?this.N=this.a.setTimeout(this.f,this.b-t):(this.N&&(this.a.clearTimeout(this.N),this.N=null),this.dispatchEvent("tick"),this.ca&&(Qt(this),this.start()))}},e.start=function(){this.ca=!0,this.N||(this.N=this.a.setTimeout(this.f,this.b),this.g=k())},e.H=function(){Jt.P.H.call(this),Qt(this),delete this.a},Zt.prototype=o(N.prototype),Zt.prototype.constructor=Zt,h)h(Zt,N);else for(var te in N)if("prototype"!=te)if(Object.defineProperties){var ee=Object.getOwnPropertyDescriptor(N,te);ee&&Object.defineProperty(Zt,te,ee)}else Zt[te]=N[te];function ne(t){N.call(this),this.b=t,this.a={}}Zt.P=N.prototype,Zt.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t((function(){e.a=null,e.c&&(e.c=!1,t(e))}),e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},Zt.prototype.H=function(){N.prototype.H.call(this),this.a&&(g.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},O(ne,N);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){G(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Ot(t)}),t),t.a={}}function ae(){this.a=!0}function se(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Ut(n)}catch(s){return e}}(t,n)+(r?" "+r:"")}))}ne.prototype.H=function(){ne.P.H.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ae.prototype.info=function(){};var ue=null;function ce(){return ue=ue||new Mt}function fe(t){dt.call(this,"serverreachability",t)}function he(t){var e=ce();e.dispatchEvent(new fe(e,t))}function le(t){dt.call(this,"statevent",t)}function pe(t){var e=ce();e.dispatchEvent(new le(e,t))}function de(t){dt.call(this,"timingevent",t)}function ve(t,e){if("function"!=m(t))throw Error("Fn must not be null and must be a function");return g.setTimeout((function(){t()}),e)}O(fe,dt),O(le,dt),O(de,dt);var ge={NO_ERROR:0,bb:1,jb:2,ib:3,fb:4,hb:5,kb:6,Fa:7,TIMEOUT:8,nb:9},ye={eb:"complete",rb:"success",Ga:"error",Fa:"abort",pb:"ready",qb:"readystatechange",TIMEOUT:"timeout",lb:"incrementaldata",ob:"progress",gb:"downloadprogress",sb:"uploadprogress"};function me(){}function be(t){var e;return(e=t.a)||(e=t.a={}),e}function we(){}me.prototype.a=null;var _e,Ee={OPEN:"a",cb:"b",Ga:"c",mb:"d"};function Ie(){dt.call(this,"d")}function Te(){dt.call(this,"c")}function Ae(){}function xe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.V=r||1,this.K=new ne(this),this.T=Se,t=tt?125:void 0,this.U=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.I=this.u=this.W=this.o=null,this.s=[],this.a=null,this.F=0,this.h=this.m=null,this.R=-1,this.v=!1,this.S=0,this.G=null,this.Y=this.C=this.X=this.J=!1}O(Ie,dt),O(Te,dt),O(Ae,me),_e=new Ae;var Se=45e3,ke={},Oe={};function Ne(t,e,n){t.I=1,t.i=$e(We(e)),t.j=n,t.J=!0,Le(t,null)}function Le(t,e){t.u=k(),Ce(t),t.l=We(t.i);var n=t.l,r=t.V;Array.isArray(r)||(r=[String(r)]),ln(n.b,"t",r),t.F=0,t.a=ar(t.g,t.g.C?e:null),0<t.S&&(t.G=new Zt(x(t.Ea,t,t.a),t.S)),ie(t.K,t.a,"readystatechange",t.Za),e=t.B?H(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.da(t.l,t.m,t.j,e)):(t.m="GET",t.a.da(t.l,t.m,null,e)),he(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var f=c[0];c=c[1];var h=f.split("_");a=2<=h.length&&"type"==h[1]?a+(f+"=")+c+"&":a+(f+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.V,t.j)}function Re(t,e,n){for(var r=!0;!t.v&&t.F<n.length;){var i=De(t,n);if(i==Oe){4==e&&(t.h=4,pe(14),r=!1),se(t.c,t.f,null,"[Incomplete Response]");break}if(i==ke){t.h=4,pe(15),se(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}se(t.c,t.f,i,null),Fe(t,i)}4==e&&0==n.length&&(t.h=1,pe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.Y&&(t.Y=!0,(e=t.g).a==t&&e.X&&!e.G&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.G=!0)):(se(t.c,t.f,n,"[Invalid Chunked Response]"),Ue(t),je(t))}function De(t,e){var n=t.F,r=e.indexOf("\n",n);return-1==r?Oe:(n=Number(e.substring(n,r)),isNaN(n)?ke:(r+=1)+n>e.length?Oe:(e=e.substr(r,n),t.F=r+n,e))}function Ce(t){t.W=k()+t.T,Pe(t,t.T)}function Pe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(x(t.Xa,t),e)}function Me(t){t.o&&(g.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.A||t.v||er(t.g,t)}function Ue(t){Me(t);var e=t.G;e&&"function"==typeof e.la&&e.la(),t.G=null,Qt(t.U),oe(t.K),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Fe(t,e){try{var n=t.g;if(0!=n.A&&(n.a==t||bn(n.b,t)))if(n.J=t.R,!t.C&&bn(n.b,t)&&3==n.A){try{var r=n.ra.a.parse(e)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;tr(n),zn(n)}Qn(n),pe(18)}}else n.qa=i[1],0<n.qa-n.T&&37500>i[2]&&n.I&&0==n.o&&!n.m&&(n.m=ve(x(n.Ua,n),6e3));if(1>=mn(n.b)&&n.ga){try{n.ga()}catch(g){}n.ga=void 0}}else rr(n,11)}else if((t.C||n.a==t)&&tr(n),!j(e))for(e=r=n.ra.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.T=i[0],i=i[1],2==n.A)if("c"==i[0]){n.K=i[1],n.ia=i[2];var o=i[3];null!=o&&(n.ja=o,n.c.info("VER="+n.ja));var a=i[4];null!=a&&(n.ma=a,n.c.info("SVER="+n.ma));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.F=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var f=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(f){var h=u.b;!h.a&&(V(f,"spdy")||V(f,"quic")||V(f,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(wn(h,h.b),h.b=null))}if(u.v){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(u.pa=l,Qe(u.B,u.v,l))}}n.A=3,n.f&&n.f.va(),n.X&&(n.R=k()-t.u,n.c.info("Handshake RTT: "+n.R+"ms"));var p=t;if((u=n).na=or(u,u.C?u.ia:null,u.ha),p.C){_n(u.b,p);var d=p,v=u.F;v&&d.setTimeout(v),d.o&&(Me(d),Ce(d)),u.a=p}else Jn(u);0<n.g.length&&Wn(n)}else"stop"!=i[0]&&"close"!=i[0]||rr(n,7);else 3==n.A&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?rr(n,7):qn(n):"noop"!=i[0]&&n.f&&n.f.ua(i),n.o=0);he(4)}catch(g){}}function Ve(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(b(t)||"string"==typeof t)C(t,e,void 0);else{if(t.M&&"function"==typeof t.M)var n=t.M();else if(t.L&&"function"==typeof t.L)n=void 0;else if(b(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.L&&"function"==typeof t.L)return t.L();if("string"==typeof t)return t.split("");if(b(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.M(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(e=xe.prototype).setTimeout=function(t){this.T=t},e.Za=function(t){t=t.target;var e=this.G;e&&3==Un(t)?e.f():this.Ea(t)},e.Ea=function(t){try{if(t==this.a)t:{var e=Un(this.a),n=this.a.wa(),r=this.a.Z();if(!(3>e||3==e&&!tt&&!this.a.ba())){this.v||4!=e||7==n||he(8==n||0>=r?3:2),Me(this);var i=this.a.Z();this.R=i;var o=this.a.ba();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.V,e,i),this.b){if(this.X&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,pe(12),Ue(this),je(this);break t}se(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,u)}this.J?(Re(this,e,o),tt&&this.b&&3==e&&(ie(this.K,this.U,"tick",this.Ya),this.U.start())):(se(this.c,this.f,o,null),Fe(this,o)),4==e&&Ue(this),this.b&&!this.v&&(4==e?er(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,pe(12)):(this.h=0,pe(13)),Ue(this),je(this)}}}catch(c){}},e.Ya=function(){if(this.a){var t=Un(this.a),e=this.a.ba();this.F<e.length&&(Me(this),Re(this,t,e),this.b&&4!=t&&Ce(this))}},e.cancel=function(){this.v=!0,Ue(this)},e.Xa=function(){this.o=null;var t=k();0<=t-this.W?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.I&&(he(3),pe(17)),Ue(this),this.h=2,je(this)):Pe(this,this.W-t)},(e=Be.prototype).L=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.M=function(){return qe(this),this.a.concat()},e.get=function(t,e){return ze(this.b,t)?this.b[t]:e},e.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.M(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He){this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b;var n=new un;n.c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Je(this,n),this.i=t.i}else t&&(n=String(t).match(Ge))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=Ze(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=Ze(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function We(t){return new He(t)}function Ke(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?Ze(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){e instanceof un?(t.b=e,function(t,e){e&&!t.f&&(cn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),ln(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=tn(e,an)),t.b=new un(e,t.a))}function Qe(t,e,n){t.b.set(e,n)}function $e(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^k()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function tn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,en),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function en(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(tn(e,nn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(tn(e,nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(tn(n,"/"==n.charAt(0)?on:rn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",tn(n,sn)),t.join("")};var nn=/[#\/\?@]/g,rn=/[#\?:]/g,on=/[#\?]/g,an=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(t){t.a||(t.a=new Be,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function fn(t,e){cn(t),e=pn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function hn(t,e){return cn(t),e=pn(t,e),ze(t.a.b,e)}function ln(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(pn(t,e),M(n)),t.b+=n.length)}function pn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function dn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=g.PerformanceNavigationTiming?0<(t=g.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(g.ka&&g.ka.Aa&&g.ka.Aa()&&g.ka.Aa().tb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(e=un.prototype).add=function(t,e){cn(this),this.c=null,t=pn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.forEach=function(t,e){cn(this),this.a.forEach((function(n,r){C(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.M=function(){cn(this);for(var t=this.a.L(),e=this.a.M(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.L=function(t){cn(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=P(e,this.a.get(pn(this,t))));else{t=this.a.L();for(var n=0;n<t.length;n++)e=P(e,t[n])}return e},e.set=function(t,e){return cn(this),this.c=null,hn(this,t=pn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.L(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.M(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.L(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var gn=10;function yn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function mn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function wn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function En(t){if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){for(var e=t.c,n=(t=r(t.a.values())).next();!n.done;n=t.next())e=e.concat(n.value.s);return e}return M(t.c)}function In(){}function Tn(){this.a=new In}function An(t,e,n){var r=n||"";try{Ve(t,(function(t,n){var i=t;w(t)&&(i=Ut(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(d){throw e.push(r+"type="+encodeURIComponent("_badmap")),d}}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}vn.prototype.cancel=function(){if(this.c=En(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){for(var t=r(this.a.values()),e=t.next();!e.done;e=t.next())e.value.cancel();this.a.clear()}},In.prototype.stringify=function(t){return g.JSON.stringify(t,void 0)},In.prototype.parse=function(t){return g.JSON.parse(t,void 0)};var Sn=g.JSON.parse;function kn(t){Mt.call(this),this.headers=new Be,this.I=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.v=this.l=this.u=!1,this.o=0,this.m=null,this.J=On,this.F=this.G=!1}O(kn,Mt);var On="",Nn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Dn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Mn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pn(t){if(t.b&&void 0!==v&&(!t.s[1]||4!=Un(t)||2!=t.Z()))if(t.l&&4==Un(t))$t(t.Ba,0,t);else if(t.dispatchEvent("readystatechange"),4==Un(t)){t.b=!1;try{var e,n=t.Z();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ge)[1]||null;if(!o&&g.self&&g.self.location){var a=g.self.location.protocol;o=a.substr(0,a.length-1)}i=!Nn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var s=2<Un(t)?t.a.statusText:""}catch(u){s=""}t.f=s+" ["+t.Z()+"]",Cn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?y:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(d){}}}function jn(t){t.a&&t.F&&(t.a.ontimeout=null),t.m&&(g.clearTimeout(t.m),t.m=null)}function Un(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return G(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?(encodeURIComponent(String(e)),null!=n&&encodeURIComponent(String(n))):Qe(t,e,n))}function Vn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.ma=0,this.g=[],this.c=new ae,this.ia=this.na=this.B=this.ha=this.a=this.pa=this.v=this.Y=this.i=this.S=this.l=null,this.Oa=this.U=0,this.La=Vn("failFast",!1,t),this.I=this.m=this.j=this.h=this.f=null,this.V=!0,this.J=this.qa=this.T=-1,this.W=this.o=this.u=0,this.Ia=Vn("baseRetryDelayMs",5e3,t),this.Ta=Vn("retryDelaySeedMs",1e4,t),this.Ma=Vn("forwardChannelMaxRetries",2,t),this.oa=Vn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.F=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.K="",this.b=new vn(t&&t.concurrentRequestLimit),this.ra=new Tn,this.fa=t&&t.fastHandshake||!1,this.Ka=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.V=!1),this.X=!this.fa&&this.V&&t&&t.c||!1,this.ga=void 0,this.R=0,this.G=!1,this.s=null}function qn(t){if(Gn(t),3==t.A){var e=t.U++,n=We(t.B);Qe(n,"SID",t.K),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Xn(t,n),(e=new xe(t,t.c,e,void 0)).I=2,e.i=$e(We(n)),n=!1,g.navigator&&g.navigator.sendBeacon&&(n=g.navigator.sendBeacon(e.i.toString(),"")),!n&&g.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.da(e.i)),e.u=k(),Ce(e)}ir(t)}function zn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function Gn(t){zn(t),t.j&&(g.clearTimeout(t.j),t.j=null),tr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&g.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new dn(t.Oa++,e)),3==t.A&&Wn(t)}function Wn(t){yn(t.b)||t.h||(t.h=!0,Wt(t.Da,t),t.u=0)}function Kn(t,e){var n;n=e?e.f:t.U++;var r=We(t.B);Qe(r,"SID",t.K),Qe(r,"RID",n),Qe(r,"AID",t.T),Xn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new xe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.oa)+Math.round(.5*t.oa*Math.random())),wn(t.b,n),Ne(n,r,e)}function Xn(t,e){t.f&&Ve({},(function(t,n){Qe(e,n,t)}))}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,f=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{An(f,a,"req"+c+"_")}catch(h){r&&r(f)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.W=1,Wt(t.Ca,t),t.o=0)}function Qn(t){return!(t.a||t.j||3<=t.o||(t.W++,t.j=ve(x(t.Ca,t),nr(t,t.o)),t.o++,0))}function $n(t){null!=t.s&&(g.clearTimeout(t.s),t.s=null)}function Zn(t){t.a=new xe(t,t.c,"rpc",t.W),null===t.i&&(t.a.B=t.l),t.a.S=0;var e=We(t.na);Qe(e,"RID","rpc"),Qe(e,"SID",t.K),Qe(e,"CI",t.I?"0":"1"),Qe(e,"AID",t.T),Xn(t,e),Qe(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.F&&t.a.setTimeout(t.F);var n=t.a;t=t.ia,n.I=1,n.i=$e(We(e)),n.j=null,n.J=!0,Le(n,t)}function tr(t){null!=t.m&&(g.clearTimeout(t.m),t.m=null)}function er(t,e){var n=null;if(t.a==e){tr(t),$n(t),t.a=null;var r=2}else{if(!bn(t.b,e))return;n=e.s,_n(t.b,e),r=1}if(t.J=e.R,0!=t.A)if(e.b)if(1==r){n=e.j?e.j.length:0,e=k()-e.u;var i=t.u;(r=ce()).dispatchEvent(new de(r,n,e,i)),Wn(t)}else Jn(t);else if(3==(i=e.h)||0==i&&0<t.J||!(1==r&&function(t,e){return!(mn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.A||2==t.A||t.u>=(t.La?0:t.Ma)||(t.h=ve(x(t.Da,t,e),nr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Qn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:rr(t,5);break;case 4:rr(t,10);break;case 3:rr(t,6);break;default:rr(t,2)}}function nr(t,e){var n=t.Ia+Math.floor(Math.random()*t.Ta);return t.f||(n*=2),n*e}function rr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=x(t.$a,t);n||(n=new He("//www.google.com/images/cleardot.gif"),g.location&&"http"==g.location.protocol||Ke(n,"https"),$e(n)),function(t,e){var n=new ae;if(g.Image){var r=new Image;r.onload=S(xn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=S(xn,n,r,"TestLoadImage: error",!1,e),r.onabort=S(xn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=S(xn,n,r,"TestLoadImage: timeout",!1,e),g.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else pe(2);t.A=0,t.f&&t.f.ta(e),ir(t),Gn(t)}function ir(t){t.A=0,t.J=-1,t.f&&(0==En(t.b).length&&0==t.g.length||(t.b.c.length=0,M(t.g),t.g.length=0),t.f.sa())}function or(t,e,n){var r=function(t){return t instanceof He?We(t):new He(t,void 0)}(n);if(""!=r.c)e&&Xe(r,e+"."+r.c),Ye(r,r.h);else{var i=g.location;r=function(t,e,n,r){var i=new He(null,void 0);return t&&Ke(i,t),e&&Xe(i,e),n&&Ye(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.Y&&G(t.Y,(function(t,e){Qe(r,e,t)})),e=t.v,n=t.pa,e&&n&&Qe(r,e,n),Qe(r,"VER",t.ja),Xn(t,r),r}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Na)).G=t.C,e}function sr(){}function ur(){if($&&!(10<=Number(ft)))throw Error("Environmental error: no available transport.")}function cr(t,e){Mt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.S=t,(t=e&&e.httpHeadersOverwriteParam)&&!j(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!j(e)&&(this.a.v=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new lr(this)}function fr(t){Ie.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Te.call(this),this.status=1}function lr(t){this.a=t}(e=kn.prototype).da=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.I?be(this.I):be(_e),this.a.onreadystatechange=x(this.Ba,this);try{this.v=!0,this.a.open(e,String(t),!0),this.v=!1}catch(o){return void Dn(this,o)}t=n||"";var i=new Be(this.headers);r&&Ve(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.M()),n=g.FormData&&t instanceof g.FormData,!(0<=D(Ln,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.J&&(this.a.responseType=this.J),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{jn(this),0<this.o&&((this.F=function(t){return $&&ct(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=x(this.za,this)):this.m=$t(this.za,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Dn(this,o)}},e.za=function(){void 0!==v&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},e.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),kn.P.H.call(this)},e.Ba=function(){this.j||(this.v||this.l||this.g?Pn(this):this.Wa())},e.Wa=function(){Pn(this)},e.Z=function(){try{return 2<Un(this)?this.a.status:-1}catch(J){return-1}},e.ba=function(){try{return this.a?this.a.responseText:""}catch(J){return""}},e.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sn(e)}},e.wa=function(){return this.h},e.Sa=function(){return"string"==typeof this.f?this.f:String(this.f)},(e=Bn.prototype).ja=8,e.A=1,e.Da=function(t){if(this.h)if(this.h=null,1==this.A){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;var e,n=new xe(this,this.c,t,void 0),r=this.l;if(this.S&&(r?K(r=H(r),this.S):r=this.S),null===this.i&&(n.B=r),this.fa)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Qe(i=We(this.B),"RID",t),Qe(i,"CVER",22),this.v&&Qe(i,"X-HTTP-Session-Id",this.v),Xn(this,i),this.i&&r&&Fn(i,this.i,r),wn(this.b,n),this.Ka&&Qe(i,"TYPE","init"),this.fa?(Qe(i,"$req",e),Qe(i,"SID","null"),n.X=!0,Ne(n,i,null)):Ne(n,i,e),this.A=2}}else 3==this.A&&(t?Kn(this,t):0==this.g.length||yn(this.b)||Kn(this))},e.Ca=function(){if(this.j=null,Zn(this),this.X&&!(this.G||null==this.a||0>=this.R)){var t=2*this.R;this.c.info("BP detection timer enabled: "+t),this.s=ve(x(this.Va,this),t)}},e.Va=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.I=!1,this.G=!0,zn(this),Zn(this))},e.Ua=function(){null!=this.m&&(this.m=null,zn(this),Qn(this),pe(19))},e.$a=function(t){t?(this.c.info("Successfully pinged google.com"),pe(2)):(this.c.info("Failed to ping google.com"),pe(1))},(e=sr.prototype).va=function(){},e.ua=function(){},e.ta=function(){},e.sa=function(){},e.Ja=function(){},ur.prototype.a=function(t,e){return new cr(t,e)},O(cr,Mt),(e=cr.prototype).addEventListener=function(t,e,n,r){cr.P.addEventListener.call(this,t,e,n,r)},e.removeEventListener=function(t,e,n,r){cr.P.removeEventListener.call(this,t,e,n,r)},e.Qa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;pe(0),t.ha=e,t.Y=n||{},t.I=t.V,t.B=or(t,null,t.ha),Wn(t)},e.close=function(){qn(this.a)},e.Ra=function(t){if("string"==typeof t){var e={};e.__data__=t,Hn(this.a,e)}else this.g?((e={}).__data__=Ut(t),Hn(this.a,e)):Hn(this.a,t)},e.H=function(){this.a.f=null,delete this.f,qn(this.a),delete this.a,cr.P.H.call(this)},O(fr,Ie),O(hr,Te),O(lr,sr),lr.prototype.va=function(){this.a.dispatchEvent("a")},lr.prototype.ua=function(t){this.a.dispatchEvent(new fr(t))},lr.prototype.ta=function(t){this.a.dispatchEvent(new hr(t))},lr.prototype.sa=function(){this.a.dispatchEvent("b")},ur.prototype.createWebChannel=ur.prototype.a,cr.prototype.send=cr.prototype.Ra,cr.prototype.open=cr.prototype.Qa,cr.prototype.close=cr.prototype.close,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,ye.COMPLETE="complete",we.EventType=Ee,Ee.OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",Mt.prototype.listen=Mt.prototype.xa,kn.prototype.listenOnce=kn.prototype.ya,kn.prototype.getLastError=kn.prototype.Sa,kn.prototype.getLastErrorCode=kn.prototype.wa,kn.prototype.getStatus=kn.prototype.Z,kn.prototype.getResponseJson=kn.prototype.Pa,kn.prototype.getResponseText=kn.prototype.ba,kn.prototype.send=kn.prototype.da,gt.createWebChannelTransport=function(){return new ur},gt.ErrorCode=ge,gt.EventType=ye,gt.WebChannel=we,gt.XhrIo=kn}).apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var yt,mt,bt={},wt=bt={};function _t(){throw new Error("setTimeout has not been defined")}function Et(){throw new Error("clearTimeout has not been defined")}function It(t){if(yt===setTimeout)return setTimeout(t,0);if((yt===_t||!yt)&&setTimeout)return yt=setTimeout,setTimeout(t,0);try{return yt(t,0)}catch(d){try{return yt.call(null,t,0)}catch(d){return yt.call(this,t,0)}}}!function(){try{yt="function"==typeof setTimeout?setTimeout:_t}catch(d){yt=_t}try{mt="function"==typeof clearTimeout?clearTimeout:Et}catch(d){mt=Et}}();var Tt,At=[],xt=!1,St=-1;function kt(){xt&&Tt&&(xt=!1,Tt.length?At=Tt.concat(At):St=-1,At.length&&Ot())}function Ot(){if(!xt){var t=It(kt);xt=!0;for(var e=At.length;e;){for(Tt=At,At=[];++St<e;)Tt&&Tt[St].run();St=-1,e=At.length}Tt=null,xt=!1,function(t){if(mt===clearTimeout)return clearTimeout(t);if((mt===Et||!mt)&&clearTimeout)return mt=clearTimeout,clearTimeout(t);try{mt(t)}catch(d){try{return mt.call(null,t)}catch(d){return mt.call(this,t)}}}(t)}}function Nt(t,e){this.fun=t,this.array=e}function Lt(){}wt.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];At.push(new Nt(t,e)),1!==At.length||xt||It(Ot)},Nt.prototype.run=function(){this.fun.apply(null,this.array)},wt.title="browser",wt.browser=!0,wt.env={},wt.argv=[],wt.version="",wt.versions={},wt.on=Lt,wt.addListener=Lt,wt.once=Lt,wt.off=Lt,wt.removeListener=Lt,wt.removeAllListeners=Lt,wt.emit=Lt,wt.prependListener=Lt,wt.prependOnceListener=Lt,wt.listeners=function(t){return[]},wt.binding=function(t){throw new Error("process.binding is not supported")},wt.cwd=function(){return"/"},wt.chdir=function(t){throw new Error("process.chdir is not supported")},wt.umask=function(){return 0};var Rt={};(function(t){(function(){"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});var e,n=(e=et)&&"object"==typeof e&&"default"in e?e:{default:e},r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},i=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return F.__extends(e,t),e}(Error),o=new W.Logger("@firebase/firestore");function a(){return o.logLevel}function s(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(o.logLevel<=W.LogLevel.DEBUG){var r=e.map(f);o.debug.apply(o,F.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(o.logLevel<=W.LogLevel.ERROR){var r=e.map(f);o.error.apply(o,F.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function c(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(o.logLevel<=W.LogLevel.WARN){var r=e.map(f);o.warn.apply(o,F.__spreadArrays(["Firestore (7.24.0): "+t],r))}}function f(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function h(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+t;throw u(e),new Error(e)}function l(t,e){t||h()}function p(t,e){return t}function d(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function v(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var y=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&h(),void 0===n?n=t.length-e:n>t.length-e&&h(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.prototype.R=function(){return this.A().join("/")},e.prototype.toString=function(){return this.R()},e.g=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=[],a=0,s=t;a<s.length;a++){var u=s[a];if(u.indexOf("//")>=0)throw new i(r.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");o.push.apply(o,u.split("/").filter((function(t){return t.length>0})))}return new e(o)},e.P=function(){return new e([])},e}(y),b=/^[_a-zA-Z][_a-zA-Z0-9]*$/,w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.V=function(t){return b.test(t)},e.prototype.R=function(){return this.A().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.V(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.R()},e.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},e.v=function(){return new e(["__name__"])},e.S=function(t){for(var n=[],o="",a=0,s=function(){if(0===o.length)throw new i(r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(o),o=""},u=!1;a<t.length;){var c=t[a];if("\\"===c){if(a+1===t.length)throw new i(r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var f=t[a+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new i(r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);o+=f,a+=2}else"`"===c?(u=!u,a++):"."!==c||u?(o+=c,a++):(s(),a++)}if(s(),u)throw new i(r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.P=function(){return new e([])},e}(y),_=function(){function t(t){this.path=t}return t.D=function(e){return new t(m.g(e))},t.C=function(e){return new t(m.g(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===m.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return m.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new m(e.slice()))},t}();function E(t,e){if(0!==e.length)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+z(e.length,"argument")+".")}function I(t,e,n){if(e.length!==n)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires "+z(n,"argument")+", but was called with "+z(e.length,"argument")+".")}function T(t,e,n){if(e.length<n)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires at least "+z(n,"argument")+", but was called with "+z(e.length,"argument")+".")}function A(t,e,n,o){if(e.length<n||e.length>o)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+o+" arguments, but was called with "+z(e.length,"argument")+".")}function x(t,e,n,r){R(t,e,q(n)+" argument",r)}function S(t,e,n,r){void 0!==r&&x(t,e,n,r)}function k(t,e,n,r){R(t,e,n+" option",r)}function O(t,e,n,r){void 0!==r&&k(t,e,n,r)}function N(t,e,n,o,a){void 0!==o&&function(t,e,n,o,a){for(var s=[],u=0,c=a;u<c.length;u++){var f=c[u];if(f===o)return;s.push(C(f))}var h=C(o);throw new i(r.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+s.join(", "))}(t,0,n,o,a)}function L(t,e,n,o){if(!e.some((function(t){return t===o})))throw new i(r.INVALID_ARGUMENT,"Invalid value "+C(o)+" provided to function "+t+"() for its "+q(n)+" argument. Acceptable values: "+e.join(", "));return o}function R(t,e,n,o){if(!("object"===e?D(o):"non-empty string"===e?"string"==typeof o&&""!==o:typeof o===e)){var a=C(o);throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+a)}}function D(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function C(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":h()}function P(t,e,n){if(void 0===n)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+q(e)+" argument, but it was undefined.")}function M(t,e,n){v(e,(function(e,o){if(n.indexOf(e)<0)throw new i(r.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function j(t,e,n,o){var a=C(o);return new i(r.INVALID_ARGUMENT,"Function "+t+"() requires its "+q(n)+" argument to be a "+e+", but it was: "+a)}function U(t,e,n){if(n<=0)throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires its "+q(e)+" argument to be a positive number, but it was: "+n+".")}function q(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function z(t,e){return t+" "+e+(1===t?"":"s")}function G(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var H=function(){function t(){}return t.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=G(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function K(t,e){return t<e?-1:t>e?1:0}function X(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Y(t){return t+"\0"}var J=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.M,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return K(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();J.B=new J("");var Q=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t(J.fromBase64String(e))}catch(e){throw new i(r.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(J.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();function $(){if("undefined"==typeof Uint8Array)throw new i(r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Z(){if("undefined"==typeof atob)throw new i(r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.fromBase64String=function(t){I("Blob.fromBase64String",arguments,1),x("Blob.fromBase64String","string",1,t),Z();try{return new e(J.fromBase64String(t))}catch(t){throw new i(r.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){if(I("Blob.fromUint8Array",arguments,1),$(),!(t instanceof Uint8Array))throw j("Blob.fromUint8Array","Uint8Array",1,t);return new e(J.fromUint8Array(t))},e.prototype.toBase64=function(){return I("Blob.toBase64",arguments,0),Z(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return I("Blob.toUint8Array",arguments,0),$(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Q),nt=function(t,e,n,r,i,o){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o},rt=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return K(this.projectId,t.projectId)||K(this.database,t.database)},t}(),it=function(){function t(t,e){this.K=t,this.G=e,this.H={}}return t.prototype.get=function(t){var e=this.K(t),n=this.H[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.G(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.K(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.K(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){v(this.H,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.m=function(){return g(this.H)},t}(),ot=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new i(r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new i(r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new i(r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new i(r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.Y=function(t){return this.seconds===t.seconds?K(this.nanoseconds,t.nanoseconds):K(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),at=function(){function t(t){this.timestamp=t}return t.J=function(e){return new t(e)},t.min=function(){return new t(new ot(0,0))},t.prototype.L=function(t){return this.timestamp.Y(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.Z=function(){return this.timestamp},t}();function st(t){return null==t}function ut(t){return 0===t&&1/t==-1/0}function ct(t){return"number"==typeof t&&Number.isInteger(t)&&!ut(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ft=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.tt=null};function ht(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new ft(t,e,n,r,i,o,a)}function lt(t){var e=p(t);if(null===e.tt){var n=e.path.R();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.R()+t.op.toString()+ie(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.R()+e.dir;var e})).join(","),st(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ar(e.startAt)),e.endAt&&(n+="|ub:",n+=ar(e.endAt)),e.tt=n}return e.tt}function pt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!hr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!te(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ur(t.startAt,e.startAt)&&ur(t.endAt,e.endAt)}function dt(t){return _.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vt,yt,mt=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=at.min()),void 0===o&&(o=at.min()),void 0===a&&(a=J.B),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.st=function(e){return new t(this.target,this.targetId,this.et,e,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.it=function(e,n){return new t(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.rt=function(e){return new t(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,e,this.resumeToken)},t}(),bt=function(t){this.count=t};function wt(t){switch(t){case r.OK:return h();case r.CANCELLED:case r.UNKNOWN:case r.DEADLINE_EXCEEDED:case r.RESOURCE_EXHAUSTED:case r.INTERNAL:case r.UNAVAILABLE:case r.UNAUTHENTICATED:return!1;case r.INVALID_ARGUMENT:case r.NOT_FOUND:case r.ALREADY_EXISTS:case r.PERMISSION_DENIED:case r.FAILED_PRECONDITION:case r.ABORTED:case r.OUT_OF_RANGE:case r.UNIMPLEMENTED:case r.DATA_LOSS:return!0;default:return h()}}function _t(t){if(void 0===t)return u("GRPC error has no .code"),r.UNKNOWN;switch(t){case vt.OK:return r.OK;case vt.CANCELLED:return r.CANCELLED;case vt.UNKNOWN:return r.UNKNOWN;case vt.DEADLINE_EXCEEDED:return r.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return r.RESOURCE_EXHAUSTED;case vt.INTERNAL:return r.INTERNAL;case vt.UNAVAILABLE:return r.UNAVAILABLE;case vt.UNAUTHENTICATED:return r.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return r.INVALID_ARGUMENT;case vt.NOT_FOUND:return r.NOT_FOUND;case vt.ALREADY_EXISTS:return r.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return r.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return r.FAILED_PRECONDITION;case vt.ABORTED:return r.ABORTED;case vt.OUT_OF_RANGE:return r.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return r.UNIMPLEMENTED;case vt.DATA_LOSS:return r.DATA_LOSS;default:return h()}}(yt=vt||(vt={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";var Et=function(){function t(t,e){this.i=t,this.root=e||Tt.EMPTY}return t.prototype.ot=function(e,n){return new t(this.i,this.root.ot(e,n,this.i).copy(null,null,Tt.at,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,Tt.at,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(){return this.root.ut()},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.forEach=function(t){this.ht((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ht((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.lt=function(t){return this.root.lt(t)},t.prototype._t=function(){return new It(this.root,null,this.i,!1)},t.prototype.ft=function(t){return new It(this.root,t,this.i,!1)},t.prototype.dt=function(){return new It(this.root,null,this.i,!0)},t.prototype.wt=function(t){return new It(this.root,t,this.i,!0)},t}(),It=function(){function t(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}return t.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},t.prototype.At=function(){return this.Et.length>0},t.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},t}(),Tt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},t.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.ct=function(){return this.min().key},t.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},t.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).gt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.yt()||e.left.left.yt()||(e=e.Vt()),(e=e.copy(null,null,null,e.left.Pt(),null)).gt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.yt()||i.left.left.yt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.yt()&&(i=i.bt()),i.right.m()||i.right.yt()||i.right.left.yt()||(i=i.vt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.gt()},t.prototype.yt=function(){return this.color},t.prototype.gt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.St()),t.left.yt()&&t.left.left.yt()&&(t=t.bt()),t.left.yt()&&t.right.yt()&&(t=t.Dt()),t},t.prototype.Vt=function(){var t=this.Dt();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},t.prototype.vt=function(){var t=this.Dt();return t.left.left.yt()&&(t=(t=t.bt()).Dt()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.bt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},t.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw h();if(this.right.yt())throw h();var t=this.left.Nt();if(t!==this.right.Nt())throw h();return t+(this.yt()?0:1)},t}();Tt.EMPTY=null,Tt.RED=!0,Tt.at=!1,Tt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw h()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ot=function(t,e,n){return new Tt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ht=function(t){return!1},t.prototype.lt=function(t){return!1},t.prototype.ct=function(){return null},t.prototype.ut=function(){return null},t.prototype.yt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Nt=function(){return 0},t}());var At=function(){function t(t){this.i=t,this.data=new Et(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ct()},t.prototype.last=function(){return this.data.ut()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ht((function(e,n){return t(e),!1}))},t.prototype.Ft=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.xt=function(t,e){var n;for(n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},t.prototype.$t=function(t){var e=this.data.ft(t);return e.At()?e.It().key:null},t.prototype._t=function(){return new xt(this.data._t())},t.prototype.ft=function(t){return new xt(this.data.ft(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),xt=function(){function t(t){this.Mt=t}return t.prototype.It=function(){return this.Mt.It().key},t.prototype.At=function(){return this.Mt.At()},t}(),St=new Et(_.i);function kt(){return St}function Ot(){return kt()}var Nt=new Et(_.i);function Lt(){return Nt}var Dt=new Et(_.i),Ct=new At(_.i);function Pt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ct,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Mt=new At(K);function jt(){return Mt}var Ut=function(){function t(t){this.i=t?function(e,n){return t(e,n)||_.i(e.key,n.key)}:function(t,e){return _.i(t.key,e.key)},this.Ot=Lt(),this.Lt=new Et(this.i)}return t.Bt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Ot.get(t)},t.prototype.get=function(t){return this.Ot.get(t)},t.prototype.first=function(){return this.Lt.ct()},t.prototype.last=function(){return this.Lt.ut()},t.prototype.m=function(){return this.Lt.m()},t.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Lt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Lt.ht((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.ot(t.key,t),e.Lt.ot(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Lt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Lt._t(),r=e.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Ot=e,r.Lt=n,r},t}(),Ft=function(){function t(){this.qt=new Et(_.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);n?0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):h():this.qt=this.qt.ot(e,t)},t.prototype.Ut=function(){var t=[];return this.qt.ht((function(e,n){t.push(n)})),t},t}(),Vt=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=a,this.Kt=s}return t.Gt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ut.Bt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Wt.isEqual(t.Wt)&&Hn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Bt=function(){function t(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Yt=r,this.Jt=i}return t.Xt=function(e,n){var r=new Map;return r.set(e,qt.Zt(e,n)),new t(at.min(),r,jt(),kt(),Pt())},t}(),qt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}return t.Zt=function(e,n){return new t(J.B,n,Pt(),Pt(),Pt())},t}(),zt=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},Gt=function(t,e){this.targetId=t,this.oe=e},Ht=function(t,e,n,r){void 0===n&&(n=J.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Wt=function(){function t(){this.ae=0,this.ce=Yt(),this.ue=J.B,this.he=!1,this.le=!0}return Object.defineProperty(t.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),t.prototype.de=function(t){t.O()>0&&(this.le=!0,this.ue=t)},t.prototype.we=function(){var t=Pt(),e=Pt(),n=Pt();return this.ce.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:h()}})),new qt(this.ue,this.he,t,e,n)},t.prototype.me=function(){this.le=!1,this.ce=Yt()},t.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},t.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},t.prototype.Ie=function(){this.ae+=1},t.prototype.Ae=function(){this.ae-=1},t.prototype.Re=function(){this.le=!0,this.he=!0},t}(),Kt=function(){function t(t){this.ge=t,this.Pe=new Map,this.ye=kt(),this.Ve=Xt(),this.pe=new At(K)}return t.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof On?this.ve(r,t.re):t.re instanceof Nn&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var a=o[i];this.Se(a,t.key,t.re)}},t.prototype.De=function(t){var e=this;this.Ce(t,(function(n){var r=e.Ne(n);switch(t.state){case 0:e.Fe(n)&&r.de(t.resumeToken);break;case 1:r.Ae(),r._e||r.me(),r.de(t.resumeToken);break;case 2:r.Ae(),r._e||e.removeTarget(n);break;case 3:e.Fe(n)&&(r.Re(),r.de(t.resumeToken));break;case 4:e.Fe(n)&&(e.xe(n),r.de(t.resumeToken));break;default:h()}}))},t.prototype.Ce=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Fe(r)&&e(r)}))},t.prototype.$e=function(t){var e=t.targetId,n=t.oe.count,r=this.ke(e);if(r){var i=r.target;if(dt(i))if(0===n){var o=new _(i.path);this.Se(e,o,new Nn(o,at.min()))}else l(1===n);else this.Me(e)!==n&&(this.xe(e),this.pe=this.pe.add(e))}},t.prototype.Oe=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.ke(i);if(o){if(r.te&&dt(o.target)){var a=new _(o.target.path);null!==e.ye.get(a)||e.Le(i,a)||e.Se(i,a,new Nn(a,t))}r.fe&&(n.set(i,r.we()),r.me())}}));var r=Pt();this.Ve.forEach((function(t,n){var i=!0;n.xt((function(t){var n=e.ke(t);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Bt(t,n,this.pe,this.ye,r);return this.ye=kt(),this.Ve=Xt(),this.pe=new At(K),i},t.prototype.ve=function(t,e){if(this.Fe(t)){var n=this.Le(t,e.key)?2:0;this.Ne(t).Te(e.key,n),this.ye=this.ye.ot(e.key,e),this.Ve=this.Ve.ot(e.key,this.Be(e.key).add(t))}},t.prototype.Se=function(t,e,n){if(this.Fe(t)){var r=this.Ne(t);this.Le(t,e)?r.Te(e,1):r.Ee(e),this.Ve=this.Ve.ot(e,this.Be(e).delete(t)),n&&(this.ye=this.ye.ot(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.Me=function(t){var e=this.Ne(t).we();return this.ge.qe(t).size+e.ee.size-e.se.size},t.prototype.Ie=function(t){this.Ne(t).Ie()},t.prototype.Ne=function(t){var e=this.Pe.get(t);return e||(e=new Wt,this.Pe.set(t,e)),e},t.prototype.Be=function(t){var e=this.Ve.get(t);return e||(e=new At(K),this.Ve=this.Ve.ot(t,e)),e},t.prototype.Fe=function(t){var e=null!==this.ke(t);return e||s("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ge.Ue(t)},t.prototype.xe=function(t){var e=this;this.Pe.set(t,new Wt),this.ge.qe(t).forEach((function(n){e.Se(t,n,null)}))},t.prototype.Le=function(t,e){return this.ge.qe(t).has(e)},t}();function Xt(){return new Et(_.i)}function Yt(){return new Et(_.i)}function Jt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Qt(t){var e=oe(t.mapValue.fields.__local_write_time__.timestampValue);return new ot(e.seconds,e.nanos)}var $t=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Jt(t)?4:10:h()}function te(t,e){var n=Zt(t);if(n!==Zt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qt(t).isEqual(Qt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=oe(t.timestampValue),r=oe(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return se(t.bytesValue).isEqual(se(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ae(t.geoPointValue.latitude)===ae(e.geoPointValue.latitude)&&ae(t.geoPointValue.longitude)===ae(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ae(t.integerValue)===ae(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ae(t.doubleValue),r=ae(e.doubleValue);return n===r?ut(n)===ut(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return X(t.arrayValue.values||[],e.arrayValue.values||[],te);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(d(n)!==d(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!te(n[i],r[i])))return!1;return!0}(t,e);default:return h()}}function ee(t,e){return void 0!==(t.values||[]).find((function(t){return te(t,e)}))}function ne(t,e){var n=Zt(t),r=Zt(e);if(n!==r)return K(n,r);switch(n){case 0:return 0;case 1:return K(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ae(t.integerValue||t.doubleValue),r=ae(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return re(t.timestampValue,e.timestampValue);case 4:return re(Qt(t),Qt(e));case 5:return K(t.stringValue,e.stringValue);case 6:return function(t,e){var n=se(t),r=se(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=K(n[i],r[i]);if(0!==o)return o}return K(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=K(ae(t.latitude),ae(e.latitude));return 0!==n?n:K(ae(t.longitude),ae(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ne(n[i],r[i]);if(o)return o}return K(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=K(r[a],o[a]);if(0!==s)return s;var u=ne(n[r[a]],i[o[a]]);if(0!==u)return u}return K(r.length,o.length)}(t.mapValue,e.mapValue);default:throw h()}}function re(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return K(t,e);var n=oe(t),r=oe(e),i=K(n.seconds,r.seconds);return 0!==i?i:K(n.nanos,r.nanos)}function ie(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=oe(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?se(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,_.C(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var a=o[i];r?r=!1:n+=",",n+=a+":"+t(e.fields[a])}return n+"}"}(e.mapValue):h();var n,r}(t)}function oe(t){if(l(!!t),"string"==typeof t){var e=0,n=$t.exec(t);if(l(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ae(t.seconds),nanos:ae(t.nanos)}}function ae(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function se(t){return"string"==typeof t?J.fromBase64String(t):J.fromUint8Array(t)}function ue(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function ce(t){return!!t&&"integerValue"in t}function fe(t){return!!t&&"arrayValue"in t}function he(t){return!!t&&"nullValue"in t}function le(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function pe(t){return!!t&&"mapValue"in t}var de={asc:"ASCENDING",desc:"DESCENDING"},ve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ge=function(t,e){this.U=t,this.Qe=e};function ye(t){return{integerValue:""+t}}function me(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ut(e)?"-0":e}}function be(t,e){return ct(e)?ye(e):me(t,e)}function we(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function _e(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function Ee(t,e){return we(t,e.Z())}function Ie(t){return l(!!t),at.J(function(t){var e=oe(t);return new ot(e.seconds,e.nanos)}(t))}function Te(t,e){return function(t){return new m(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).R()}function Ae(t){var e=m.g(t);return l(We(e)),e}function xe(t,e){return Te(t.U,e.path)}function Se(t,e){var n=Ae(e);return l(n.get(1)===t.U.projectId),l(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new _(Le(n))}function ke(t,e){return Te(t.U,e)}function Oe(t){var e=Ae(t);return 4===e.length?m.P():Le(e)}function Ne(t){return new m(["projects",t.U.projectId,"databases",t.U.database]).R()}function Le(t){return l(t.length>4&&"documents"===t.get(4)),t.u(5)}function Re(t,e,n){return{name:xe(t,e),fields:n.proto.mapValue.fields}}function De(t,e){var n;if(e instanceof yn)n={update:Re(t,e.key,e.value)};else if(e instanceof In)n={delete:xe(t,e.key)};else if(e instanceof mn)n={update:Re(t,e.key,e.data),updateMask:He(e.We)};else if(e instanceof wn)n={transform:{document:xe(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Qe)return{fieldPath:e.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof $e)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof tn)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof nn)return{fieldPath:e.field.R(),increment:n.je};throw h()}(0,t)}))}};else{if(!(e instanceof Tn))return h();n={verify:xe(t,e.key)}}return e.Ge.Ke||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ee(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:h()}(t,e.Ge)),n}function Ce(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?cn.updateTime(Ie(t.updateTime)):void 0!==t.exists?cn.exists(t.exists):cn.ze()}(e.currentDocument):cn.ze();if(e.update){e.update.name;var r=Se(t,e.update.name),i=new An({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new an(e.map((function(t){return w.S(t)})))}(e.updateMask);return new mn(r,i,o,n)}return new yn(r,i,n)}if(e.delete){var a=Se(t,e.delete);return new In(a,n)}if(e.transform){var s=Se(t,e.transform.document),u=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)l("REQUEST_TIME"===e.setToServerValue),n=new Qe;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new $e(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new tn(i)}else"increment"in e?n=new nn(t,e.increment):h();var o=w.S(e.fieldPath);return new sn(o,n)}(t,e)}));return l(!0===n.exists),new wn(s,u)}if(e.verify){var c=Se(t,e.verify);return new Tn(c,n)}return h()}function Pe(t,e){return{documents:[ke(t,e.path)]}}function Me(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ke(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ke(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(le(t.value))return{unaryFilter:{field:Be(t.field),op:"IS_NAN"}};if(he(t.value))return{unaryFilter:{field:Be(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(le(t.value))return{unaryFilter:{field:Be(t.field),op:"IS_NOT_NAN"}};if(he(t.value))return{unaryFilter:{field:Be(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Be(t.field),op:Ve(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Be(t.field),direction:Fe(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.Qe||st(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=je(e.startAt)),e.endAt&&(n.structuredQuery.endAt=je(e.endAt)),n}function je(t){return{before:t.before,values:t.position}}function Ue(t){var e=!!t.before,n=t.values||[];return new or(n,e)}function Fe(t){return de[t]}function Ve(t){return ve[t]}function Be(t){return{fieldPath:t.R()}}function qe(t){return w.S(t.fieldPath)}function ze(t){return Jn.create(qe(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return h()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ge(t){switch(t.unaryFilter.op){case"IS_NAN":var e=qe(t.unaryFilter.field);return Jn.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=qe(t.unaryFilter.field);return Jn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=qe(t.unaryFilter.field);return Jn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=qe(t.unaryFilter.field);return Jn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return h()}}function He(t){var e=[];return t.fields.forEach((function(t){return e.push(t.R())})),{fieldPaths:e}}function We(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ke=function(){this.He=void 0};function Xe(t,e,n){return t instanceof Qe?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof $e?Ze(t,e):t instanceof tn?en(t,e):function(t,e){var n=Je(t,e),r=rn(n)+rn(t.je);return ce(n)&&ce(t.je)?ye(r):me(t.serializer,r)}(t,e)}function Ye(t,e,n){return t instanceof $e?Ze(t,e):t instanceof tn?en(t,e):n}function Je(t,e){return t instanceof nn?ce(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e}(Ke),$e=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return F.__extends(e,t),e}(Ke);function Ze(t,e){for(var n=on(e),r=function(t){n.some((function(e){return te(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var tn=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return F.__extends(e,t),e}(Ke);function en(t,e){for(var n=on(e),r=function(t){n=n.filter((function(e){return!te(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var nn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.je=n,r}return F.__extends(e,t),e}(Ke);function rn(t){return ae(t.integerValue||t.doubleValue)}function on(t){return fe(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var an=function(){function t(t){this.fields=t,t.sort(w.i)}return t.prototype.Ye=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return X(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),sn=function(t,e){this.field=t,this.transform=e},un=function(t,e){this.version=t,this.transformResults=e},cn=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ze=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function fn(t,e){return void 0!==t.updateTime?e instanceof On&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof On}var hn=function(){};function ln(t,e,n){return t instanceof yn?function(t,e,n){return new On(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof mn?function(t,e,n){if(!fn(t.Ge,e))return new Ln(t.key,n.version);var r=bn(t,e);return new On(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof wn?function(t,e,n){if(l(null!=n.transformResults),!fn(t.Ge,e))return new Ln(t.key,n.version);var r=_n(t,e),i=function(t,e,n){var r=[];l(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=null;e instanceof On&&(s=e.field(o.field)),r.push(Ye(a,s,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,a=En(t,r.data(),i);return new On(t.key,o,a,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Nn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function pn(t,e,n,r){return t instanceof yn?function(t,e){if(!fn(t.Ge,e))return e;var n=gn(e);return new On(t.key,n,t.value,{Je:!0})}(t,e):t instanceof mn?function(t,e){if(!fn(t.Ge,e))return e;var n=gn(e),r=bn(t,e);return new On(t.key,n,r,{Je:!0})}(t,e):t instanceof wn?function(t,e,n,r){if(!fn(t.Ge,e))return e;var i=_n(t,e),o=function(t,e,n,r){for(var i=[],o=0,a=t;o<a.length;o++){var s=a[o],u=s.transform,c=null;n instanceof On&&(c=n.field(s.field)),null===c&&r instanceof On&&(c=r.field(s.field)),i.push(Xe(u,c,e))}return i}(t.fieldTransforms,n,e,r),a=En(t,i.data(),o);return new On(t.key,i.version,a,{Je:!0})}(t,e,r,n):function(t,e){return fn(t.Ge,e)?new Nn(t.key,at.min()):e}(t,e)}function dn(t,e){return t instanceof wn?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e instanceof On?e.field(o.field):void 0,s=Je(o.transform,a||null);null!=s&&(n=null==n?(new xn).set(o.field,s):n.set(o.field,s))}return n?n.Xe():null}(t,e):null}function vn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.We.isEqual(e.We):2!==t.type||X(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof $e&&e instanceof $e||t instanceof tn&&e instanceof tn?X(t.elements,e.elements,te):t instanceof nn&&e instanceof nn?te(t.je,e.je):t instanceof Qe&&e instanceof Qe}(t.transform,e.transform)}(t,e)})))}function gn(t){return t instanceof On?t.version:at.min()}var yn=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ge=r,i.type=0,i}return F.__extends(e,t),e}(hn),mn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.We=r,o.Ge=i,o.type=1,o}return F.__extends(e,t),e}(hn);function bn(t,e){return function(t,e){var n=new xn(e);return t.We.fields.forEach((function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Xe()}(t,e instanceof On?e.data():An.empty())}var wn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ge=cn.exists(!0),r}return F.__extends(e,t),e}(hn);function _n(t,e){return e}function En(t,e,n){for(var r=new xn(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var In=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=3,r}return F.__extends(e,t),e}(hn),Tn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ge=n,r.type=4,r}return F.__extends(e,t),e}(hn),An=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!pe(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return te(this.proto,t.proto)},t}(),xn=function(){function t(t){void 0===t&&(t=An.empty()),this.Ze=t,this.tn=new Map}return t.prototype.set=function(t,e){return this.en(t,e),this},t.prototype.delete=function(t){return this.en(t,null),this},t.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Zt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Xe=function(){var t=this.nn(w.P(),this.tn);return null!=t?new An(t):this.Ze},t.prototype.nn=function(t,e){var n=this,r=!1,i=this.Ze.field(t),o=pe(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var a=n.nn(t.child(i),e);null!=a&&(o[i]=a,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Sn(t){var e=[];return v(t.fields||{},(function(t,n){var r=new w([t]);if(pe(n)){var i=Sn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new an(e)}var kn=function(t,e){this.key=t,this.version=e},On=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).sn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return F.__extends(e,t),e.prototype.field=function(t){return this.sn.field(t)},e.prototype.data=function(){return this.sn},e.prototype.rn=function(){return this.sn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(kn),Nn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return F.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(kn),Ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(kn),Rn=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=a,this.endAt=s,this.cn=null,this.un=null,this.startAt,this.endAt};function Dn(t,e,n,r,i,o,a,s){return new Rn(t,e,n,r,i,o,a,s)}function Cn(t){return new Rn(t)}function Pn(t){return!st(t.limit)&&"F"===t.an}function Mn(t){return!st(t.limit)&&"L"===t.an}function jn(t){return t.on.length>0?t.on[0].field:null}function Un(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Fn(t){return null!==t.collectionGroup}function Vn(t){var e=p(t);if(null===e.cn){e.cn=[];var n=Un(e),r=jn(e);if(null!==n&&null===r)n.p()||e.cn.push(new cr(n)),e.cn.push(new cr(w.v(),"asc"));else{for(var i=!1,o=0,a=e.on;o<a.length;o++){var s=a[o];e.cn.push(s),s.field.p()&&(i=!0)}if(!i){var u=e.on.length>0?e.on[e.on.length-1].dir:"asc";e.cn.push(new cr(w.v(),u))}}}return e.cn}function Bn(t){var e=p(t);if(!e.un)if("F"===e.an)e.un=ht(e.path,e.collectionGroup,Vn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Vn(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new cr(o.field,a))}var s=e.endAt?new or(e.endAt.position,!e.endAt.before):null,u=e.startAt?new or(e.startAt.position,!e.startAt.before):null;e.un=ht(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.un}function qn(t,e,n){return new Rn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zn(t,e){return new Rn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Gn(t,e){return new Rn(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Hn(t,e){return pt(Bn(t),Bn(e))&&t.an===e.an}function Wn(t){return lt(Bn(t))+"|lt:"+t.an}function Kn(t){return"Query(target="+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.R()+" "+e.op+" "+ie(e.value);var e})).join(", ")+"]"),st(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.R()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ar(t.startAt)),t.endAt&&(e+=", endAt: "+ar(t.endAt)),"Target("+e+")"}(Bn(t))+"; limitType="+t.an+")"}function Xn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):_.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.on;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!sr(t.startAt,Vn(t),e)||t.endAt&&sr(t.endAt,Vn(t),e))}(t,e)}function Yn(t){return function(e,n){for(var r=!1,i=0,o=Vn(t);i<o.length;i++){var a=o[i],s=fr(a,e,n);if(0!==s)return s;r=r||a.field.p()}return 0}}var Jn=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return F.__extends(e,t),e.create=function(t,n,o){if(t.p())return"in"===n||"not-in"===n?this.ln(t,n,o):new Qn(t,n,o);if(he(o)){if("=="!==n&&"!="!==n)throw new i(r.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new e(t,n,o)}if(le(o)){if("=="!==n&&"!="!==n)throw new i(r.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new e(t,n,o)}return"array-contains"===n?new er(t,o):"in"===n?new nr(t,o):"not-in"===n?new rr(t,o):"array-contains-any"===n?new ir(t,o):new e(t,n,o)},e.ln=function(t,e,n){return"in"===e?new $n(t,n):new Zn(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this._n(ne(e,this.value)):null!==e&&Zt(this.value)===Zt(e)&&this._n(ne(e,this.value))},e.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return h()}},e.prototype.hn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Qn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=_.C(r.referenceValue),i}return F.__extends(e,t),e.prototype.matches=function(t){var e=_.i(t.key,this.key);return this._n(e)},e}(Jn),$n=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=tr("in",n),r}return F.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Jn),Zn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=tr("not-in",n),r}return F.__extends(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Jn);function tr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return _.C(t.referenceValue)}))}var er=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return F.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return fe(e)&&ee(e.arrayValue,this.value)},e}(Jn),nr=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return F.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ee(this.value.arrayValue,e)},e}(Jn),rr=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return F.__extends(e,t),e.prototype.matches=function(t){if(ee(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ee(this.value.arrayValue,e)},e}(Jn),ir=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return F.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!fe(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ee(e.value.arrayValue,t)}))},e}(Jn),or=function(t,e){this.position=t,this.before=e};function ar(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ie(t)})).join(",")}function sr(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.p()?_.i(_.C(a.referenceValue),n.key):ne(a,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ur(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!te(t.position[n],e.position[n]))return!1;return!0}var cr=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fr(t,e,n){var r=t.field.p()?_.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ne(r,i):h()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return h()}}function hr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var lr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},pr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}return t.prototype.reset=function(){this.En=0},t.prototype.Rn=function(){this.En=this.Tn},t.prototype.gn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&s("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,(function(){return e.An=Date.now(),t()})),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},t.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},t.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.En},t}(),dr=function(){function t(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t((function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)}),(function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Dn&&h(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(e,this.result):new t((function(t,i){r.bn=function(n){r.Nn(e,n).next(t,i)},r.vn=function(e){r.Cn(n,e).next(t,i)}}))},t.prototype.Fn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.xn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Nn=function(e,n){return e?this.xn((function(){return e(n)})):t.resolve(n)},t.prototype.Cn=function(e,n){return e?this.xn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.$n=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.kn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},t}(),vr=function(){function e(t,n,r){this.name=t,this.version=n,this.Mn=r,12.2===e.On(V.getUA())&&u("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return s("SimpleDb","Removing database:",t),_r(window.indexedDB.deleteDatabase(t)).Fn()},e.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(e.Bn())return!0;var t=V.getUA(),n=e.On(t),r=0<n&&n<10,i=e.qn(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.Bn=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.Un)},e.Qn=function(t,e){return t.store(e)},e.On=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.qn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Wn=function(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n=this;return F.__generator(this,(function(o){switch(o.label){case 0:return this.db?[3,2]:(s("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,o){var a=indexedDB.open(n.name,n.version);a.onsuccess=function(t){var n=t.target.result;e(n)},a.onblocked=function(){o(new yr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var n=e.target.error;"VersionError"===n.name?o(new i(r.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(new yr(t,n))},a.onupgradeneeded=function(t){s("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Mn.createOrUpgrade(e,a.transaction,t.oldVersion,n.version).next((function(){s("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=o.sent(),o.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(t){return n.jn(t)}),this.db)]}}))}))},e.prototype.Kn=function(t){this.jn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return F.__awaiter(this,void 0,void 0,(function(){var i,o,a,u,c;return F.__generator(this,(function(f){switch(f.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,c,f,h;return F.__generator(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,u.Wn(t)];case 2:return u.db=l.sent(),e=br.open(u.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),dr.reject(t)})).Fn(),c={},a.catch((function(){})),[4,e.Gn];case 3:return[2,(c.value=(l.sent(),a),c)];case 4:return f=l.sent(),h="FirebaseError"!==f.name&&o<3,s("SimpleDb","Transaction failed with error:",f.message,"Retrying:",h),u.close(),h?[3,5]:[2,{value:Promise.reject(f)}];case 5:return[2]}}))},u=this,f.label=1;case 1:return[5,a()];case 2:if("object"==typeof(c=f.sent()))return[2,c.value];f.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),gr=function(){function t(t){this.zn=t,this.Hn=!1,this.Yn=null}return Object.defineProperty(t.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Hn=!0},t.prototype.Xn=function(t){this.Yn=t},t.prototype.delete=function(){return _r(this.zn.delete())},t}(),yr=function(t){function e(e,n){var i=this;return(i=t.call(this,r.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",i}return F.__extends(e,t),e}(i);function mr(t){return"IndexedDbTransactionError"===t.name}var br=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Zn=new lr,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){e.error?n.Zn.reject(new yr(t,e.error)):n.Zn.resolve()},this.transaction.onerror=function(e){var r=Ir(e.target.error);n.Zn.reject(new yr(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new yr(n,e)}},Object.defineProperty(t.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(s("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new wr(e)},t}(),wr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(s("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(s("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),_r(n)},t.prototype.add=function(t){return s("SimpleDb","ADD",this.store.name,t,t),_r(this.store.add(t))},t.prototype.get=function(t){var e=this;return _r(this.store.get(t)).next((function(n){return void 0===n&&(n=null),s("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return s("SimpleDb","DELETE",this.store.name,t),_r(this.store.delete(t))},t.prototype.count=function(){return s("SimpleDb","COUNT",this.store.name),_r(this.store.count())},t.prototype.ts=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.es(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ns=function(t,e){s("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(t,e,n){return n.delete()}))},t.prototype.rs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.es(r,e)},t.prototype.os=function(t){var e=this.cursor({});return new dr((function(n,r){e.onerror=function(t){var e=Ir(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.es=function(t,e){var n=[];return new dr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new gr(i),a=e(i.primaryKey,i.value,o);if(a instanceof dr){var s=a.catch((function(t){return o.done(),dr.reject(t)}));n.push(s)}o.Sn?r():null===o.Jn?i.continue():i.continue(o.Jn)}else r()}})).next((function(){return dr.$n(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function _r(t){return new dr((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ir(t.target.error);n(e)}}))}var Er=!1;function Ir(t){var e=vr.On(V.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new i("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Er||(Er=!0,setTimeout((function(){throw r}),0)),r}}return t}function Tr(){return"undefined"!=typeof window?window:null}function Ar(){return"undefined"!=typeof document?document:null}var xr=function(){function t(t,e,n,r,i){this.cs=t,this.dn=e,this.us=n,this.op=r,this.hs=i,this.ls=new lr,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(t){}))}return t._s=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.fs=setTimeout((function(){return e.ds()}),t)},t.prototype.pn=function(){return this.ds()},t.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new i(r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.ds=function(){var t=this;this.cs.ws((function(){return null!==t.fs?(t.clearTimeout(),t.op().then((function(e){return t.ls.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},t}(),Sr=function(){function t(){var t=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new pr(this,"async_queue_retry"),this.Vs=function(){var e=Ar();e&&s("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.ys.Vn()};var e=Ar();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vs)}return Object.defineProperty(t.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),t.prototype.ws=function(t){this.enqueue(t)},t.prototype.bs=function(t){this.vs(),this.Ss(t)},t.prototype.Ds=function(){if(!this.Is){this.Is=!0;var t=Ar();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vs)}},t.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise((function(t){})):this.Ss(t)},t.prototype.Cs=function(t){var e=this;this.ws((function(){return e.Es.push(t),e.Ns()}))},t.prototype.Ns=function(){return F.__awaiter(this,void 0,void 0,(function(){var t,e=this;return F.__generator(this,(function(n){switch(n.label){case 0:if(0===this.Es.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return n.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!mr(t=n.sent()))throw t;return s("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Es.length>0&&this.ys.gn((function(){return e.Ns()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ss=function(t){var e=this,n=this.Ts.then((function(){return e.gs=!0,t().catch((function(t){throw e.Rs=t,e.gs=!1,u("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gs=!1,t}))}));return this.Ts=n,n},t.prototype.yn=function(t,e,n){var r=this;this.vs(),this.Ps.indexOf(t)>-1&&(e=0);var i=xr._s(this,t,e,n,(function(t){return r.Fs(t)}));return this.As.push(i),i},t.prototype.vs=function(){this.Rs&&h()},t.prototype.xs=function(){},t.prototype.$s=function(){return F.__awaiter(this,void 0,void 0,(function(){var t;return F.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Ts];case 1:e.sent(),e.label=2;case 2:if(t!==this.Ts)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.ks=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},t.prototype.Ms=function(t){var e=this;return this.$s().then((function(){e.As.sort((function(t,e){return t.us-e.us}));for(var n=0,r=e.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==t&&i.dn===t)break}return e.$s()}))},t.prototype.Os=function(t){this.Ps.push(t)},t.prototype.Fs=function(t){var e=this.As.indexOf(t);this.As.splice(e,1)},t}();function kr(t,e){if(u("AsyncQueue",e+": "+t),mr(t))return new i(r.UNAVAILABLE,e+": "+t);throw t}var Or=function(){this.Ls=void 0,this.listeners=[]},Nr=function(){this.Bs=new it((function(t){return Wn(t)}),Hn),this.onlineState="Unknown",this.qs=new Set};function Lr(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return F.__generator(this,(function(c){switch(c.label){case 0:if(n=p(t),r=e.query,i=!1,(o=n.Bs.get(r))||(i=!0,o=new Or),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.Us(r)];case 2:return a.Ls=c.sent(),[3,4];case 3:return s=c.sent(),u=kr(s,"Initialization of query '"+Kn(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.Bs.set(r,o),o.listeners.push(e),e.Qs(n.onlineState),o.Ls&&e.Ws(o.Ls)&&Dr(n),[2]}}))}))}function Rr(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a;return F.__generator(this,(function(s){return n=p(t),r=e.query,i=!1,(o=n.Bs.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.Bs.delete(r),n.js(r))]:[2]}))}))}function Dr(t){t.qs.forEach((function(t){t.next()}))}var Cr=function(){function t(t,e,n){this.query=t,this.Ks=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Ws=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Vt(t.query,t.docs,t.Qt,e,t.Wt,t.fromCache,t.jt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.Ks.next(t),o=!0):this.Ys(t,this.onlineState)&&(this.Js(t),o=!0),this.zs=t,o},t.prototype.onError=function(t){this.Ks.error(t)},t.prototype.Qs=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,t)&&(this.Js(this.zs),e=!0),e},t.prototype.Ys=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.m()&&"Offline"!==e)},t.prototype.Hs=function(t){if(t.docChanges.length>0)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Js=function(t){t=Vt.Gt(t.query,t.docs,t.Wt,t.fromCache),this.Gs=!0,this.Ks.next(t)},t}(),Pr=function(){function t(t){this.uid=t}return t.prototype.Zs=function(){return null!=this.uid},t.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Pr.UNAUTHENTICATED=new Pr(null),Pr.ei=new Pr("google-credentials-uid"),Pr.ni=new Pr("first-party-uid");var Mr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}return t.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},t}();function jr(t,e){return"firestore_clients_"+t+"_"+e}function Ur(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Zs()&&(r+="_"+e.uid),r}function Fr(t,e){return"firestore_targets_"+t+"_"+e}Mr.ai=-1;var Vr=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ci=function(e,n,r){var o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error),s=void 0;return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(s=new i(o.error.code,o.error.message)),a?new t(e,n,o.state,s):(u("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Br=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ci=function(e,n){var r=JSON.parse(n),o="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),a=void 0;return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(a=new i(r.error.code,r.error.message)),o?new t(e,r.state,a):(u("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),qr=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ci=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=jt(),a=0;i&&a<r.activeTargetIds.length;++a)i=ct(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(u("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),zr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ci=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(u("SharedClientState","Failed to parse online state: "+e),null)},t}(),Gr=function(){function t(){this.activeTargetIds=jt()}return t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Hr=function(){function t(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new Et(K),this.Ei=!1,this.Ii=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=jr(this.persistenceKey,this._i),this.Ri=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ti=this.Ti.ot(this._i,new Gr),this.gi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Vi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return t.Ln=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return F.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,f,h=this;return F.__generator(this,(function(l){switch(l.label){case 0:return[4,this.fi.pi()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(jr(this.persistenceKey,r)))&&(o=qr.ci(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(a=this.storage.getItem(this.Vi))&&(s=this.vi(a))&&this.Si(s),u=0,c=this.Ii;u<c.length;u++)f=c[u],this.mi(f);return this.Ii=[],this.window.addEventListener("unload",(function(){return h.Di()})),this.Ei=!0,[2]}}))}))},t.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},t.prototype.Ci=function(){return this.Ni(this.Ti)},t.prototype.Fi=function(t){var e=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.xi=function(t){this.$i(t,"pending")},t.prototype.ki=function(t,e,n){this.$i(t,e,n),this.Mi(t)},t.prototype.Oi=function(t){var e="not-current";if(this.Fi(t)){var n=this.storage.getItem(Fr(this.persistenceKey,t));if(n){var r=Br.ci(t,n);r&&(e=r.state)}}return this.Li.hi(t),this.bi(),e},t.prototype.Bi=function(t){this.Li.li(t),this.bi()},t.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},t.prototype.Ui=function(t){this.removeItem(Fr(this.persistenceKey,t))},t.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},t.prototype.ji=function(t,e,n){var r=this;e.forEach((function(t){r.Mi(t)})),this.currentUser=t,n.forEach((function(t){r.xi(t)}))},t.prototype.Ki=function(t){this.Gi(t)},t.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return s("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){s("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){s("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.mi=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(s("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void u("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return F.__awaiter(e,void 0,void 0,(function(){var t,e,r,i,o,a;return F.__generator(this,(function(s){if(this.Ei){if(null!==n.key)if(this.gi.test(n.key)){if(null==n.newValue)return t=this.zi(n.key),[2,this.Hi(t,null)];if(e=this.Yi(n.key,n.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(r=this.Ji(n.key,n.newValue)))return[2,this.Xi(r)]}else if(this.yi.test(n.key)){if(null!==n.newValue&&(i=this.Zi(n.key,n.newValue)))return[2,this.tr(i)]}else if(n.key===this.Vi){if(null!==n.newValue&&(o=this.vi(n.newValue)))return[2,this.Si(o)]}else n.key===this.Ri&&(a=function(t){var e=Mr.ai;if(null!=t)try{var n=JSON.parse(t);l("number"==typeof n),e=n}catch(t){u("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Mr.ai&&this.si(a)}else this.Ii.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),t.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},t.prototype.$i=function(t,e,n){var r=new Vr(this.currentUser,t,e,n),i=Ur(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ui())},t.prototype.Mi=function(t){var e=Ur(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Gi=function(t){var e={clientId:this._i,onlineState:t};this.storage.setItem(this.Vi,JSON.stringify(e))},t.prototype.Wi=function(t,e,n){var r=Fr(this.persistenceKey,t),i=new Br(t,e,n);this.setItem(r,i.ui())},t.prototype.zi=function(t){var e=this.gi.exec(t);return e?e[1]:null},t.prototype.Yi=function(t,e){var n=this.zi(t);return qr.ci(n,e)},t.prototype.Ji=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Vr.ci(new Pr(i),r,e)},t.prototype.Zi=function(t,e){var n=this.yi.exec(t),r=Number(n[1]);return Br.ci(r,e)},t.prototype.vi=function(t){return zr.ci(t)},t.prototype.Xi=function(t){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fi.er(t.batchId,t.state,t.error)]:(s("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},t.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.fi.sr(a,s).then((function(){n.Ti=r}))},t.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},t.prototype.Ni=function(t){var e=jt();return t.forEach((function(t,n){e=e.kt(n.activeTargetIds)})),e},t}(),Wr=function(){function t(){this.ir=new Gr,this.rr={},this.di=null,this.si=null}return t.prototype.xi=function(t){},t.prototype.ki=function(t,e,n){},t.prototype.Oi=function(t){return this.ir.hi(t),this.rr[t]||"not-current"},t.prototype.Qi=function(t,e,n){this.rr[t]=e},t.prototype.Bi=function(t){this.ir.li(t)},t.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.Ui=function(t){delete this.rr[t]},t.prototype.Ci=function(){return this.ir.activeTargetIds},t.prototype.Fi=function(t){return this.ir.activeTargetIds.has(t)},t.prototype.start=function(){return this.ir=new Gr,Promise.resolve()},t.prototype.ji=function(t,e,n){},t.prototype.Ki=function(t){},t.prototype.Di=function(){},t.prototype.oi=function(t){},t}(),Kr=function(){function t(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}return t.prototype.cr=function(t,e,n){for(var r=n.ur,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ln(o,e,r[i]))}return e},t.prototype.hr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=pn(i,e,e,this.ar))}for(var o=e,a=0,s=this.mutations;a<s.length;a++){var u=s[a];u.key.isEqual(t)&&(e=pn(u,e,o,this.ar))}return e},t.prototype.lr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.hr(r.key,t.get(r.key));i&&(n=n.ot(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Pt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&X(this.mutations,t.mutations,(function(t,e){return vn(t,e)}))&&X(this.baseMutations,t.baseMutations,(function(t,e){return vn(t,e)}))},t}(),Xr=function(){function t(t,e,n,r){this.batch=t,this._r=e,this.ur=n,this.dr=r}return t.from=function(e,n,r){l(e.mutations.length===r.length);for(var i=Dt,o=e.mutations,a=0;a<o.length;a++)i=i.ot(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Yr=function(){function t(){this.wr=new it((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.mr=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),t.prototype.Er=function(t,e){this.Ir(),this.readTime=e,this.wr.set(t.key,t)},t.prototype.Ar=function(t,e){this.Ir(),e&&(this.readTime=e),this.wr.set(t,null)},t.prototype.Rr=function(t,e){this.Ir();var n=this.wr.get(e);return void 0!==n?dr.resolve(n):this.gr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Ir(),this.mr=!0,this.yr(t)},t.prototype.Ir=function(){},t}(),Jr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Qr=function(){function t(){this.Vr=[]}return t.prototype.pr=function(t){this.Vr.push(t)},t.prototype.br=function(){this.Vr.forEach((function(t){return t()}))},t}(),$r=function(){function t(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}return t.prototype.Cr=function(t,e){var n=this;return this.Sr.Nr(t,e).next((function(r){return n.Fr(t,e,r)}))},t.prototype.Fr=function(t,e,n){return this.vr.Rr(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].hr(e,t);return t}))},t.prototype.$r=function(t,e,n){var r=Ot();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].hr(t,e);r=r.ot(t,e)})),r},t.prototype.kr=function(t,e){var n=this;return this.vr.getEntries(t,e).next((function(e){return n.Mr(t,e)}))},t.prototype.Mr=function(t,e){var n=this;return this.Sr.Or(t,e).next((function(r){var i=n.$r(t,e,r),o=kt();return i.forEach((function(t,e){e||(e=new Nn(t,at.min())),o=o.ot(t,e)})),o}))},t.prototype.Lr=function(t,e,n){return function(t){return _.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Br(t,e.path):Fn(e)?this.qr(t,e,n):this.Ur(t,e,n)},t.prototype.Br=function(t,e){return this.Cr(t,new _(e)).next((function(t){var e=Lt();return t instanceof On&&(e=e.ot(t.key,t)),e}))},t.prototype.qr=function(t,e,n){var r=this,i=e.collectionGroup,o=Lt();return this.Dr.Qr(t,i).next((function(a){return dr.forEach(a,(function(a){var s=function(t,e){return new Rn(e,null,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(e,a.child(i));return r.Ur(t,s,n).next((function(t){t.forEach((function(t,e){o=o.ot(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Ur=function(t,e,n){var r,i,o=this;return this.vr.Lr(t,e,n).next((function(n){return r=n,o.Sr.Wr(t,e)})).next((function(e){return i=e,o.jr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,f=r.get(c),h=pn(u,f,f,o.ar);r=h instanceof On?r.ot(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Xn(e,n)||(r=r.remove(t))})),r}))},t.prototype.jr=function(t,e,n){for(var r=Pt(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof mn&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.vr.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof On&&(c=c.ot(t,e))})),c}))},t}(),Zr=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kr=n,this.Gr=r}return t.zr=function(e,n){for(var r=Pt(),i=Pt(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function ti(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=K(n,i);return 0===a?K(r,o):a}var ei=function(){function t(t){this.Hr=t,this.buffer=new At(ti),this.Yr=0}return t.prototype.Jr=function(){return++this.Yr},t.prototype.Xr=function(t){var e=[t,this.Jr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ti(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ni={Zr:!1,eo:0,no:0,so:0},ri=function(){function t(t,e,n){this.io=t,this.ro=e,this.oo=n}return t.ao=function(e){return new t(e,t.co,t.uo)},t}();ri.ho=-1,ri.lo=1048576,ri._o=41943040,ri.co=10,ri.uo=1e3,ri.fo=new ri(ri._o,ri.co,ri.uo),ri.do=new ri(ri.ho,0,0);var ii=function(){function t(t,e){this.wo=t,this.cs=e,this.mo=!1,this.To=null}return t.prototype.start=function(t){this.wo.params.io!==ri.ho&&this.Eo(t)},t.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(t.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),t.prototype.Eo=function(t){var e=this,n=this.mo?3e5:6e4;s("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.cs.yn("lru_garbage_collection",n,(function(){return F.__awaiter(e,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:this.To=null,this.mo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Io(this.wo)];case 2:return n.sent(),[3,7];case 3:return mr(e=n.sent())?(s("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,To(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Eo(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),oi=function(){function t(t,e){this.Ao=t,this.params=e}return t.prototype.Ro=function(t,e){return this.Ao.Po(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.yo=function(t,e){var n=this;if(0===e)return dr.resolve(Mr.ai);var r=new ei(e);return this.Ao.Ce(t,(function(t){return r.Xr(t.sequenceNumber)})).next((function(){return n.Ao.Vo(t,(function(t){return r.Xr(t)}))})).next((function(){return r.maxValue}))},t.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},t.prototype.bo=function(t,e){return this.Ao.bo(t,e)},t.prototype.vo=function(t,e){var n=this;return this.params.io===ri.ho?(s("LruGarbageCollector","Garbage collection skipped; disabled"),dr.resolve(ni)):this.So(t).next((function(r){return r<n.params.io?(s("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),ni):n.Do(t,e)}))},t.prototype.So=function(t){return this.Ao.So(t)},t.prototype.Do=function(t,e){var n,r,i,o,u,c,f,h=this,l=Date.now();return this.Ro(t,this.params.ro).next((function(e){return e>h.params.oo?(s("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+e),r=h.params.oo):r=e,o=Date.now(),h.yo(t,r)})).next((function(r){return n=r,u=Date.now(),h.po(t,n,e)})).next((function(e){return i=e,c=Date.now(),h.bo(t,n)})).next((function(t){return f=Date.now(),a()<=W.LogLevel.DEBUG&&s("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(u-o)+"ms\n\tRemoved "+i+" targets in "+(c-u)+"ms\n\tRemoved "+t+" documents in "+(f-c)+"ms\nTotal Duration: "+(f-l)+"ms"),dr.resolve({Zr:!0,eo:r,no:i,so:t})}))},t}();function ai(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ui(e)),e=si(t.get(n),e);return ui(e)}function si(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function ui(t){return t+"\x01\x01"}function ci(t){var e=t.length;if(l(e>=2),2===e)return l("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),m.P();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("\x01",o);switch((a<0||a>n)&&h(),t.charAt(a+1)){case"\x01":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(o,a),i+="\0";break;case"\x11":i+=t.substring(o,a+1);break;default:h()}o=a+2}return new m(r)}var fi=function(t){this.Co=t};function hi(t,e){if(e.document)return function(t,e,n){var r=Se(t,e.name),i=Ie(e.updateTime),o=new An({mapValue:{fields:e.fields}});return new On(r,i,o,{hasCommittedMutations:!!n})}(t.Co,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=_.$(e.noDocument.path),r=gi(e.noDocument.readTime);return new Nn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=_.$(e.unknownDocument.path),o=gi(e.unknownDocument.version);return new Ln(i,o)}return h()}function li(t,e,n){var r=pi(n),i=e.key.path.h().A();if(e instanceof On){var o=function(t,e){return{name:xe(t,e.key),fields:e.rn().mapValue.fields,updateTime:we(t,e.version.Z())}}(t.Co,e),a=e.hasCommittedMutations;return new qi(null,null,o,a,r,i)}if(e instanceof Nn){var s=e.key.path.A(),u=vi(e.version),c=e.hasCommittedMutations;return new qi(null,new Vi(s,u),null,c,r,i)}if(e instanceof Ln){var f=e.key.path.A(),l=vi(e.version);return new qi(new Bi(f,l),null,null,!0,r,i)}return h()}function pi(t){var e=t.Z();return[e.seconds,e.nanoseconds]}function di(t){var e=new ot(t[0],t[1]);return at.J(e)}function vi(t){var e=t.Z();return new Pi(e.seconds,e.nanoseconds)}function gi(t){var e=new ot(t.seconds,t.nanoseconds);return at.J(e)}function yi(t,e){var n=(e.baseMutations||[]).map((function(e){return Ce(t.Co,e)})),r=e.mutations.map((function(e){return Ce(t.Co,e)})),i=ot.fromMillis(e.localWriteTimeMs);return new Kr(e.batchId,i,n,r)}function mi(t){var e,n,r=gi(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?gi(t.lastLimboFreeSnapshotVersion):at.min();return void 0!==t.query.documents?(l(1===(n=t.query).documents.length),e=Bn(Cn(Oe(n.documents[0])))):e=function(t){var e=Oe(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){l(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=function t(e){return e?void 0!==e.unaryFilter?[Ge(e)]:void 0!==e.fieldFilter?[ze(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):h():[]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new cr(qe(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return st(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ue(n.startAt));var f=null;return n.endAt&&(f=Ue(n.endAt)),Bn(Dn(e,i,s,a,u,"F",c,f))}(t.query),new mt(e,t.targetId,0,t.lastListenSequenceNumber,r,i,J.fromBase64String(t.resumeToken))}function bi(t,e){var n,r=vi(e.nt),i=vi(e.lastLimboFreeSnapshotVersion);n=dt(e.target)?Pe(t.Co,e.target):Me(t.Co,e.target);var o=e.resumeToken.toBase64();return new Gi(e.targetId,lt(e.target),r,o,e.sequenceNumber,i,n)}var wi=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.Fo={}}return t.xo=function(e,n,r,i){return l(""!==e.uid),new t(e.Zs()?e.uid:"",n,r,i)},t.prototype.$o=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ii(t).rs({index:Ui.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.ko=function(t,e,n,r){var i=this,o=Ti(t),a=Ii(t);return a.add({}).next((function(s){l("number"==typeof s);for(var u=new Kr(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return De(t.Co,e)})),i=n.mutations.map((function(e){return De(t.Co,e)}));return new Ui(e,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,u),f=[],h=new At((function(t,e){return K(t.R(),e.R())})),p=0,d=r;p<d.length;p++){var v=d[p],g=Fi.key(i.userId,v.key.path,s);h=h.add(v.key.path.h()),f.push(a.put(c)),f.push(o.put(g,Fi.PLACEHOLDER))}return h.forEach((function(e){f.push(i.Dr.Mo(t,e))})),t.pr((function(){i.Fo[s]=u.keys()})),dr.$n(f).next((function(){return u}))}))},t.prototype.Oo=function(t,e){var n=this;return Ii(t).get(e).next((function(t){return t?(l(t.userId===n.userId),yi(n.serializer,t)):null}))},t.prototype.Lo=function(t,e){var n=this;return this.Fo[e]?dr.resolve(this.Fo[e]):this.Oo(t,e).next((function(t){if(t){var r=t.keys();return n.Fo[e]=r,r}return null}))},t.prototype.Bo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ii(t).rs({index:Ui.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(l(e.batchId>=r),o=yi(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ii(t).rs({index:Ui.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ii(t).ts(Ui.userMutationsIndex,n).next((function(t){return t.map((function(t){return yi(e.serializer,t)}))}))},t.prototype.Nr=function(t,e){var n=this,r=Fi.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ti(t).rs({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],f=ci(u);if(s===n.userId&&e.path.isEqual(f))return Ii(t).get(c).next((function(t){if(!t)throw h();l(t.userId===n.userId),o.push(yi(n.serializer,t))}));a.done()})).next((function(){return o}))},t.prototype.Or=function(t,e){var n=this,r=new At(K),i=[];return e.forEach((function(e){var o=Fi.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Ti(t).rs({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=ci(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),dr.$n(i).next((function(){return n.Qo(t,r)}))},t.prototype.Wr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Fi.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new At(K);return Ti(t).rs({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],f=ci(u);a===n.userId&&r.T(f)?f.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Qo(t,s)}))},t.prototype.Qo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ii(t).get(e).next((function(t){if(null===t)throw h();l(t.userId===n.userId),r.push(yi(n.serializer,t))})))})),dr.$n(i).next((function(){return r}))},t.prototype.Wo=function(t,e){var n=this;return Ei(t.jo,this.userId,e).next((function(r){return t.pr((function(){n.Ko(e.batchId)})),dr.forEach(r,(function(e){return n.No.Go(t,e)}))}))},t.prototype.Ko=function(t){delete this.Fo[t]},t.prototype.zo=function(t){var e=this;return this.$o(t).next((function(n){if(!n)return dr.resolve();var r=IDBKeyRange.lowerBound(Fi.prefixForUser(e.userId)),i=[];return Ti(t).rs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ci(t[1]);i.push(o)}else r.done()})).next((function(){l(0===i.length)}))}))},t.prototype.Ho=function(t,e){return _i(t,this.userId,e)},t.prototype.Yo=function(t){var e=this;return Ai(t).get(this.userId).next((function(t){return t||new ji(e.userId,-1,"")}))},t}();function _i(t,e,n){var r=Fi.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Ti(t).rs({range:o,ss:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function Ei(t,e,n){var r=t.store(Ui.store),i=t.store(Fi.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.rs({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){l(1===s)})));for(var c=[],f=0,h=n.mutations;f<h.length;f++){var p=h[f],d=Fi.key(e,p.key.path,n.batchId);o.push(i.delete(d)),c.push(p.key)}return dr.$n(o).next((function(){return c}))}function Ii(t){return ao.Qn(t,Ui.store)}function Ti(t){return ao.Qn(t,Fi.store)}function Ai(t){return ao.Qn(t,ji.store)}var xi=function(){function t(t,e){this.serializer=t,this.Dr=e}return t.prototype.Er=function(t,e,n){return Oi(t).put(Ni(e),n)},t.prototype.Ar=function(t,e){var n=Oi(t),r=Ni(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Jo(t,r)}))},t.prototype.Rr=function(t,e){var n=this;return Oi(t).get(Ni(e)).next((function(t){return n.Xo(t)}))},t.prototype.Zo=function(t,e){var n=this;return Oi(t).get(Ni(e)).next((function(t){var e=n.Xo(t);return e?{ta:e,size:Li(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ot();return this.ea(t,e,(function(t,e){var i=n.Xo(e);r=r.ot(t,i)})).next((function(){return r}))},t.prototype.na=function(t,e){var n=this,r=Ot(),i=new Et(_.i);return this.ea(t,e,(function(t,e){var o=n.Xo(e);o?(r=r.ot(t,o),i=i.ot(t,Li(e))):(r=r.ot(t,null),i=i.ot(t,0))})).next((function(){return{sa:r,ia:i}}))},t.prototype.ea=function(t,e,n){if(e.m())return dr.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e._t(),o=i.It();return Oi(t).rs({range:r},(function(t,e,r){for(var a=_.$(t);o&&_.i(o,a)<0;)n(o,null),o=i.It();o&&o.isEqual(a)&&(n(o,e),o=i.At()?i.It():null),o?r.Xn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},t.prototype.Lr=function(t,e,n){var r=this,i=Lt(),o=e.path.length+1,a={};if(n.isEqual(at.min())){var s=e.path.A();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.A(),c=pi(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=qi.collectionReadTimeIndex}return Oi(t).rs(a,(function(t,n,a){if(t.length===o){var s=hi(r.serializer,n);e.path.T(s.key.path)?s instanceof On&&Xn(e,s)&&(i=i.ot(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.ra=function(t){return new Si(this,!!t&&t.oa)},t.prototype.aa=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ki(t).get(zi.key).next((function(t){return l(!!t),t}))},t.prototype.Jo=function(t,e){return ki(t).put(zi.key,e)},t.prototype.Xo=function(t){if(t){var e=hi(this.serializer,t);return e instanceof Nn&&e.version.isEqual(at.min())?null:e}return null},t}(),Si=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ca=e,r.oa=n,r.ua=new it((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return F.__extends(e,t),e.prototype.yr=function(t){var e=this,n=[],r=0,i=new At((function(t,e){return K(t.R(),e.R())}));return this.wr.forEach((function(o,a){var s=e.ua.get(o);if(a){var u=li(e.ca.serializer,a,e.readTime);i=i.add(o.path.h());var c=Li(u);r+=c-s,n.push(e.ca.Er(t,o,u))}else if(r-=s,e.oa){var f=li(e.ca.serializer,new Nn(o,at.min()),e.readTime);n.push(e.ca.Er(t,o,f))}else n.push(e.ca.Ar(t,o))})),i.forEach((function(r){n.push(e.ca.Dr.Mo(t,r))})),n.push(this.ca.updateMetadata(t,r)),dr.$n(n)},e.prototype.gr=function(t,e){var n=this;return this.ca.Zo(t,e).next((function(t){return null===t?(n.ua.set(e,0),null):(n.ua.set(e,t.size),t.ta)}))},e.prototype.Pr=function(t,e){var n=this;return this.ca.na(t,e).next((function(t){var e=t.sa;return t.ia.forEach((function(t,e){n.ua.set(t,e)})),e}))},e}(Yr);function ki(t){return ao.Qn(t,zi.store)}function Oi(t){return ao.Qn(t,qi.store)}function Ni(t){return t.path.A()}function Li(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw h();e=t.noDocument}return JSON.stringify(e).length}var Ri=function(){function t(){this.ha=new Di}return t.prototype.Mo=function(t,e){return this.ha.add(e),dr.resolve()},t.prototype.Qr=function(t,e){return dr.resolve(this.ha.getEntries(e))},t}(),Di=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new At(m.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new At(m.i)).A()},t}(),Ci=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;l(n<r&&n>=0&&r<=10);var o=new br("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Mi.store)}(t),function(t){t.createObjectStore(ji.store,{keyPath:ji.keyPath}),t.createObjectStore(Ui.store,{keyPath:Ui.keyPath,autoIncrement:!0}).createIndex(Ui.userMutationsIndex,Ui.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Fi.store)}(t),Xi(t),function(t){t.createObjectStore(qi.store)}(t));var a=dr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Hi.store),t.deleteObjectStore(Gi.store),t.deleteObjectStore(Wi.store)}(t),Xi(t)),a=a.next((function(){return t=o.store(Wi.store),e=new Wi(0,0,at.min().Z(),0),t.put(Wi.key,e);var t,e}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Ui.store).ts().next((function(n){t.deleteObjectStore(Ui.store),t.createObjectStore(Ui.store,{keyPath:Ui.keyPath,autoIncrement:!0}).createIndex(Ui.userMutationsIndex,Ui.userMutationsKeyPath,{unique:!0});var r=e.store(Ui.store),i=n.map((function(t){return r.put(t)}));return dr.$n(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(Yi.store,{keyPath:Yi.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(zi.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(qi.store);e.createIndex(qi.readTimeIndex,qi.readTimeIndexPath,{unique:!1}),e.createIndex(qi.collectionReadTimeIndex,qi.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.rewriteCanonicalIds(o)}))),a},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(qi.store).rs((function(t,n){e+=Li(n)})).next((function(){var n=new zi(e);return t.store(zi.store).put(zi.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(ji.store),r=t.store(Ui.store);return n.ts().next((function(n){return dr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(Ui.userMutationsIndex,i).next((function(r){return dr.forEach(r,(function(r){l(r.userId===n.userId);var i=yi(e.serializer,r);return Ei(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Hi.store),n=t.store(qi.store);return t.store(Wi.store).get(Wi.key).next((function(t){var r=[];return n.rs((function(n,i){var o=new m(n),a=[0,ai(o)];r.push(e.get(a).next((function(n){return n?dr.resolve():function(n){return e.put(new Hi(0,ai(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return dr.$n(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ki.store,{keyPath:Ki.keyPath});var n=e.store(Ki.store),r=new Di,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:ai(i)})}};return e.store(qi.store).rs({ss:!0},(function(t,e){var n=new m(t);return i(n.h())})).next((function(){return e.store(Fi.store).rs({ss:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ci(n));return i(r.h())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Gi.store);return n.rs((function(t,r){var i=mi(r),o=bi(e.serializer,i);return n.put(o)}))},t}(),Pi=function(t,e){this.seconds=t,this.nanoseconds=e},Mi=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Mi.store="owner",Mi.key="owner";var ji=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ji.store="mutationQueues",ji.keyPath="userId";var Ui=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ui.store="mutations",Ui.keyPath="batchId",Ui.userMutationsIndex="userMutationsIndex",Ui.userMutationsKeyPath=["userId","batchId"];var Fi=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ai(e)]},t.key=function(t,e,n){return[t,ai(e),n]},t}();Fi.store="documentMutations",Fi.PLACEHOLDER=new Fi;var Vi=function(t,e){this.path=t,this.readTime=e},Bi=function(t,e){this.path=t,this.version=e},qi=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};qi.store="remoteDocuments",qi.readTimeIndex="readTimeIndex",qi.readTimeIndexPath="readTime",qi.collectionReadTimeIndex="collectionReadTimeIndex",qi.collectionReadTimeIndexPath=["parentPath","readTime"];var zi=function(t){this.byteSize=t};zi.store="remoteDocumentGlobal",zi.key="remoteDocumentGlobalKey";var Gi=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Gi.store="targets",Gi.keyPath="targetId",Gi.queryTargetsIndexName="queryTargetsIndex",Gi.queryTargetsKeyPath=["canonicalId","targetId"];var Hi=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Hi.store="targetDocuments",Hi.keyPath=["targetId","path"],Hi.documentTargetsIndex="documentTargetsIndex",Hi.documentTargetsKeyPath=["path","targetId"];var Wi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Wi.key="targetGlobalKey",Wi.store="targetGlobal";var Ki=function(t,e){this.collectionId=t,this.parent=e};function Xi(t){t.createObjectStore(Hi.store,{keyPath:Hi.keyPath}).createIndex(Hi.documentTargetsIndex,Hi.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Gi.store,{keyPath:Gi.keyPath}).createIndex(Gi.queryTargetsIndexName,Gi.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Wi.store)}Ki.store="collectionParents",Ki.keyPath=["collectionId","parent"];var Yi=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Yi.store="clientMetadata",Yi.keyPath="clientId";var Ji=F.__spreadArrays(F.__spreadArrays(F.__spreadArrays([ji.store,Ui.store,Fi.store,qi.store,Gi.store,Mi.store,Wi.store,Hi.store],[Yi.store]),[zi.store]),[Ki.store]),Qi=function(){function t(){this.la=new Di}return t.prototype.Mo=function(t,e){var n=this;if(!this.la.has(e)){var r=e._(),i=e.h();t.pr((function(){n.la.add(e)}));var o={collectionId:r,parent:ai(i)};return $i(t).put(o)}return dr.resolve()},t.prototype.Qr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Y(e),""],!1,!0);return $i(t).ts(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ci(o.parent))}return n}))},t}();function $i(t){return ao.Qn(t,Ki.store)}var Zi=function(){function t(t){this._a=t}return t.prototype.next=function(){return this._a+=2,this._a},t.fa=function(){return new t(0)},t.da=function(){return new t(-1)},t}(),to=function(){function t(t,e){this.No=t,this.serializer=e}return t.prototype.wa=function(t){var e=this;return this.ma(t).next((function(n){var r=new Zi(n.highestTargetId);return n.highestTargetId=r.next(),e.Ta(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ea=function(t){return this.ma(t).next((function(t){return at.J(new ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ia=function(t){return this.ma(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Aa=function(t,e,n){var r=this;return this.ma(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.Z()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ta(t,i)}))},t.prototype.Ra=function(t,e){var n=this;return this.ga(t,e).next((function(){return n.ma(t).next((function(r){return r.targetCount+=1,n.Pa(e,r),n.Ta(t,r)}))}))},t.prototype.ya=function(t,e){return this.ga(t,e)},t.prototype.Va=function(t,e){var n=this;return this.pa(t,e.targetId).next((function(){return eo(t).delete(e.targetId)})).next((function(){return n.ma(t)})).next((function(e){return l(e.targetCount>0),e.targetCount-=1,n.Ta(t,e)}))},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return eo(t).rs((function(a,s){var u=mi(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Va(t,u)))})).next((function(){return dr.$n(o)})).next((function(){return i}))},t.prototype.Ce=function(t,e){return eo(t).rs((function(t,n){var r=mi(n);e(r)}))},t.prototype.ma=function(t){return no(t).get(Wi.key).next((function(t){return l(null!==t),t}))},t.prototype.Ta=function(t,e){return no(t).put(Wi.key,e)},t.prototype.ga=function(t,e){return eo(t).put(bi(this.serializer,e))},t.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.ba=function(t){return this.ma(t).next((function(t){return t.targetCount}))},t.prototype.va=function(t,e){var n=lt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return eo(t).rs({range:r,index:Gi.queryTargetsIndexName},(function(t,n,r){var o=mi(n);pt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Sa=function(t,e,n){var r=this,i=[],o=ro(t);return e.forEach((function(e){var a=ai(e.path);i.push(o.put(new Hi(n,a))),i.push(r.No.Da(t,n,e))})),dr.$n(i)},t.prototype.Ca=function(t,e,n){var r=this,i=ro(t);return dr.forEach(e,(function(e){var o=ai(e.path);return dr.$n([i.delete([n,o]),r.No.Na(t,n,e)])}))},t.prototype.pa=function(t,e){var n=ro(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Fa=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ro(t),i=Pt();return r.rs({range:n,ss:!0},(function(t,e,n){var r=ci(t[1]),o=new _(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ho=function(t,e){var n=ai(e.path),r=IDBKeyRange.bound([n],[Y(n)],!1,!0),i=0;return ro(t).rs({index:Hi.documentTargetsIndex,ss:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ue=function(t,e){return eo(t).get(e).next((function(t){return t?mi(t):null}))},t}();function eo(t){return ao.Qn(t,Gi.store)}function no(t){return ao.Qn(t,Wi.store)}function ro(t){return ao.Qn(t,Hi.store)}var io="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jo=e,r.xa=n,r}return F.__extends(e,t),e}(Qr),ao=function(){function t(e,n,o,a,s,c,f,h,l,p){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=o,this.fn=s,this.window=c,this.document=f,this.$a=l,this.ka=p,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(t){return Promise.resolve()},!t.Ln())throw new i(r.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new co(this,a),this.Wa=n+"main",this.serializer=new fi(h),this.ja=new vr(this.Wa,10,new Ci(this.serializer)),this.Ka=new to(this.No,this.serializer),this.Dr=new Qi,this.vr=function(t,e){return new xi(t,e)}(this.serializer,this.Dr),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===p&&u("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Qn=function(t,e){if(t instanceof oo)return vr.Qn(t.jo,e);throw h()},t.prototype.start=function(){var t=this;return this.za().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new i(r.FAILED_PRECONDITION,io);return t.Ha(),t.Ya(),t.Ja(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ka.Ia(e)}))})).then((function(e){t.Ma=new Mr(e,t.$a)})).then((function(){t.Oa=!0})).catch((function(e){return t.ja&&t.ja.close(),Promise.reject(e)}))},t.prototype.Xa=function(t){var e=this;return this.Qa=function(n){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(e){return this.Ei?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Za=function(t){var e=this;this.ja.Kn((function(n){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.tc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws((function(){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.za=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return uo(e).put(new Yi(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ec(e).next((function(e){e||(t.isPrimary=!1,t.fn.Cs((function(){return t.Qa(!1)})))}))})).next((function(){return t.nc(e)})).next((function(n){return t.isPrimary&&!n?t.sc(e).next((function(){return!1})):!!n&&t.ic(e).next((function(){return!0}))}))})).catch((function(e){if(mr(e))return s("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return s("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.fn.Cs((function(){return t.Qa(e)})),t.isPrimary=e}))},t.prototype.ec=function(t){var e=this;return so(t).get(Mi.key).next((function(t){return dr.resolve(e.rc(t))}))},t.prototype.oc=function(t){return uo(t).delete(this.clientId)},t.prototype.ac=function(){return F.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o=this;return F.__generator(this,(function(a){switch(a.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Qn(e,Yi.store);return n.ts().next((function(t){var e=o.uc(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return dr.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=a.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.hc(i.clientId));a.label=2;case 2:return[2]}}))}))},t.prototype.Ja=function(){var t=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,(function(){return t.za().then((function(){return t.ac()})).then((function(){return t.Ja()}))}))},t.prototype.rc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nc=function(t){var e=this;return this.ka?dr.resolve(!0):so(t).get(Mi.key).next((function(n){if(null!==n&&e.cc(n.leaseTimestampMs,5e3)&&!e.lc(n.ownerId)){if(e.rc(n)&&e.networkEnabled)return!0;if(!e.rc(n)){if(!n.allowTabSynchronization)throw new i(r.FAILED_PRECONDITION,io);return!1}}return!(!e.networkEnabled||!e.inForeground)||uo(t).ts().next((function(t){return void 0===e.uc(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&s("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Di=function(){return F.__awaiter(this,void 0,void 0,(function(){var t=this;return F.__generator(this,(function(e){switch(e.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[Mi.store,Yi.store],(function(e){var n=new oo(e,Mr.ai);return t.sc(n).next((function(){return t.oc(n)}))}))];case 1:return e.sent(),this.ja.close(),this.wc(),[2]}}))}))},t.prototype.uc=function(t,e){var n=this;return t.filter((function(t){return n.cc(t.updateTimeMs,e)&&!n.lc(t.clientId)}))},t.prototype.pi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return uo(e).ts().next((function(e){return t.uc(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return wi.xo(t,this.serializer,this.Dr,this.No)},t.prototype.Tc=function(){return this.Ka},t.prototype.Ec=function(){return this.vr},t.prototype.Ic=function(){return this.Dr},t.prototype.runTransaction=function(t,e,n){var o=this;s("IndexedDbPersistence","Starting transaction:",t);var a,c="readonly"===e?"readonly":"readwrite";return this.ja.runTransaction(t,c,Ji,(function(s){return a=new oo(s,o.Ma?o.Ma.next():Mr.ai),"readwrite-primary"===e?o.ec(a).next((function(t){return!!t||o.nc(a)})).next((function(e){if(!e)throw u("Failed to obtain primary lease for action '"+t+"'."),o.isPrimary=!1,o.fn.Cs((function(){return o.Qa(!1)})),new i(r.FAILED_PRECONDITION,Jr);return n(a)})).next((function(t){return o.ic(a).next((function(){return t}))})):o.Ac(a).next((function(){return n(a)}))})).then((function(t){return a.br(),t}))},t.prototype.Ac=function(t){var e=this;return so(t).get(Mi.key).next((function(t){if(null!==t&&e.cc(t.leaseTimestampMs,5e3)&&!e.lc(t.ownerId)&&!e.rc(t)&&!(e.ka||e.allowTabSynchronization&&t.allowTabSynchronization))throw new i(r.FAILED_PRECONDITION,io)}))},t.prototype.ic=function(t){var e=new Mi(this.clientId,this.allowTabSynchronization,Date.now());return so(t).put(Mi.key,e)},t.Ln=function(){return vr.Ln()},t.prototype.sc=function(t){var e=this,n=so(t);return n.get(Mi.key).next((function(t){return e.rc(t)?(s("IndexedDbPersistence","Releasing primary lease."),n.delete(Mi.key)):dr.resolve()}))},t.prototype.cc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(u("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws((function(){return t.inForeground="visible"===t.document.visibilityState,t.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},t.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},t.prototype.Ya=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e._c(),e.fn.ws((function(){return e.Di()}))},this.window.addEventListener("unload",this.La))},t.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},t.prototype.lc=function(t){var e;try{var n=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.hc(t)));return s("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return u("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(e){u("Failed to set zombie client id.",e)}},t.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(e){}},t.prototype.hc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function so(t){return ao.Qn(t,Mi.store)}function uo(t){return ao.Qn(t,Yi.store)}var co=function(){function t(t,e){this.db=t,this.wo=new oi(this,e)}return t.prototype.Po=function(t){var e=this.Rc(t);return this.db.Tc().ba(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Rc=function(t){var e=0;return this.Vo(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ce=function(t,e){return this.db.Tc().Ce(t,e)},t.prototype.Vo=function(t,e){return this.gc(t,(function(t,n){return e(n)}))},t.prototype.Da=function(t,e,n){return fo(t,n)},t.prototype.Na=function(t,e,n){return fo(t,n)},t.prototype.po=function(t,e,n){return this.db.Tc().po(t,e,n)},t.prototype.Go=function(t,e){return fo(t,e)},t.prototype.Pc=function(t,e){return function(t,e){var n=!1;return Ai(t).os((function(r){return _i(t,r,e).next((function(t){return t&&(n=!0),dr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.bo=function(t,e){var n=this,r=this.db.Ec().ra(),i=[],o=0;return this.gc(t,(function(a,s){if(s<=e){var u=n.Pc(t,a).next((function(e){if(!e)return o++,r.Rr(t,a).next((function(){return r.Ar(a),ro(t).delete([0,ai(a.path)])}))}));i.push(u)}})).next((function(){return dr.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.st(t.xa);return this.db.Tc().ya(t,n)},t.prototype.yc=function(t,e){return fo(t,e)},t.prototype.gc=function(t,e){var n,r=ro(t),i=Mr.ai;return r.rs({index:Hi.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Mr.ai&&e(new _(ci(n)),i),i=s,n=a):i=Mr.ai})).next((function(){i!==Mr.ai&&e(new _(ci(n)),i)}))},t.prototype.So=function(t){return this.db.Ec().aa(t)},t}();function fo(t,e){return ro(t).put(function(t,e){return new Hi(0,ai(t.path),e)}(e,t.xa))}function ho(t,e){var n=t.projectId;return t.j||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var lo=function(){function t(t,e,n){this.persistence=t,this.Vc=e,this.bc=new Et(K),this.vc=new it((function(t){return lt(t)}),pt),this.Sc=at.min(),this.Sr=t.mc(n),this.Dc=t.Ec(),this.Ka=t.Tc(),this.Cc=new $r(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}return t.prototype.Io=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.vo(n,e.bc)}))},t}();function po(t,e){var n=p(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Dc.ra({oa:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=dr.resolve();return o.forEach((function(t){a=a.next((function(){return r.Rr(e,t)})).next((function(e){var o=e,a=n.dr.get(t);l(null!==a),(!o||o.version.L(a)<0)&&(o=i.cr(t,o,n))&&r.Er(o,n._r)}))})),a.next((function(){return t.Sr.Wo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Cc.kr(t,r)}))}))}function vo(t){var e=p(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ka.Ea(t)}))}function go(t,e){var n=p(t),r=e.nt,i=n.bc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Dc.ra({oa:!0});i=n.bc;var a=[];e.zt.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.Ka.Ca(t,e.se,o).next((function(){return n.Ka.Sa(t,e.ee,o)})));var u=e.resumeToken;if(u.O()>0){var c=s.it(u,r).st(t.xa);i=i.ot(o,c),function(t,e,n){return l(e.resumeToken.O()>0),0===t.resumeToken.O()||e.nt.X()-t.nt.X()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(s,c,e)&&a.push(n.Ka.ya(t,c))}}}));var u=kt(),c=Pt();if(e.Yt.forEach((function(t,e){c=c.add(t)})),a.push(o.getEntries(t,c).next((function(i){e.Yt.forEach((function(c,f){var h=i.get(c);f instanceof Nn&&f.version.isEqual(at.min())?(o.Ar(c,r),u=u.ot(c,f)):null==h||f.version.L(h.version)>0||0===f.version.L(h.version)&&h.hasPendingWrites?(o.Er(f,r),u=u.ot(c,f)):s("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",f.version),e.Jt.has(c)&&a.push(n.persistence.No.yc(t,c))}))}))),!r.isEqual(at.min())){var f=n.Ka.Ea(t).next((function(e){return n.Ka.Aa(t,t.xa,r)}));a.push(f)}return dr.$n(a).next((function(){return o.apply(t)})).next((function(){return n.Cc.Mr(t,u)}))})).then((function(t){return n.bc=i,t}))}function yo(t,e){var n=p(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Sr.Bo(t,e)}))}function mo(t,e){var n=p(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ka.va(t,e).next((function(i){return i?(r=i,dr.resolve(r)):n.Ka.wa(t).next((function(i){return r=new mt(e,i,0,t.xa),n.Ka.Ra(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.bc.get(t.targetId);return(null===r||t.nt.L(r.nt)>0)&&(n.bc=n.bc.ot(t.targetId,t),n.vc.set(e,t.targetId)),t}))}function bo(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a;return F.__generator(this,(function(u){switch(u.label){case 0:r=p(t),i=r.bc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.No.removeTarget(t,i)}))];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!mr(a=u.sent()))throw a;return s("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.bc=r.bc.remove(e),r.vc.delete(i.target),[2]}}))}))}function wo(t,e,n){var r=p(t),i=at.min(),o=Pt();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=p(t),i=r.vc.get(n);return void 0!==i?dr.resolve(r.bc.get(i)):r.Ka.va(e,n)}(r,t,Bn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ka.Fa(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Vc.Lr(t,e,n?i:at.min(),n?o:Pt())})).next((function(t){return{documents:t,Fc:o}}))}))}function _o(t,e){var n=p(t),r=p(n.Ka),i=n.bc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ue(t,e).next((function(t){return t?t.target:null}))}))}function Eo(t){var e=p(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=p(t),i=kt(),o=pi(n),a=Oi(e),s=IDBKeyRange.lowerBound(o,!0);return a.rs({index:qi.readTimeIndex,range:s},(function(t,e){var n=hi(r.serializer,e);i=i.ot(n.key,n),o=e.readTime})).next((function(){return{xc:i,readTime:di(o)}}))}(e.Dc,t,e.Sc)})).then((function(t){var n=t.xc,r=t.readTime;return e.Sc=r,n}))}function Io(t){return F.__awaiter(this,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){return[2,(e=p(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Oi(t),n=at.min();return e.rs({index:qi.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=di(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Sc=t}))]}))}))}function To(t){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(e){if(t.code!==r.FAILED_PRECONDITION||t.message!==Jr)throw t;return s("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Ao=function(){function t(){this.$c=new At(xo.kc),this.Mc=new At(xo.Oc)}return t.prototype.m=function(){return this.$c.m()},t.prototype.Da=function(t,e){var n=new xo(t,e);this.$c=this.$c.add(n),this.Mc=this.Mc.add(n)},t.prototype.Lc=function(t,e){var n=this;t.forEach((function(t){return n.Da(t,e)}))},t.prototype.Na=function(t,e){this.Bc(new xo(t,e))},t.prototype.qc=function(t,e){var n=this;t.forEach((function(t){return n.Na(t,e)}))},t.prototype.Uc=function(t){var e=this,n=new _(new m([])),r=new xo(n,t),i=new xo(n,t+1),o=[];return this.Mc.Ft([r,i],(function(t){e.Bc(t),o.push(t.key)})),o},t.prototype.Qc=function(){var t=this;this.$c.forEach((function(e){return t.Bc(e)}))},t.prototype.Bc=function(t){this.$c=this.$c.delete(t),this.Mc=this.Mc.delete(t)},t.prototype.Wc=function(t){var e=new _(new m([])),n=new xo(e,t),r=new xo(e,t+1),i=Pt();return this.Mc.Ft([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ho=function(t){var e=new xo(t,0),n=this.$c.$t(e);return null!==n&&t.isEqual(n.key)},t}(),xo=function(){function t(t,e){this.key=t,this.jc=e}return t.kc=function(t,e){return _.i(t.key,e.key)||K(t.jc,e.jc)},t.Oc=function(t,e){return K(t.jc,e.jc)||_.i(t.key,e.key)},t}(),So=function(t,e){this.user=e,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+t},ko=function(){function t(){this.Gc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.zc=function(){},t.prototype.Hc=function(t){this.Gc=t,t(Pr.UNAUTHENTICATED)},t.prototype.Yc=function(){this.Gc=null},t}(),Oo=function(){function t(t){var e=this;this.Jc=null,this.currentUser=Pr.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){e.Zc++,e.currentUser=e.tu(),e.Xc=!0,e.Gc&&e.Gc(e.currentUser)},this.Zc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),t.get().then((function(t){e.auth=t,e.Jc&&e.auth.addAuthTokenListener(e.Jc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.Zc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.Zc!==e?(s("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(l("string"==typeof n.accessToken),new So(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.zc=function(){this.forceRefresh=!0},t.prototype.Hc=function(t){this.Gc=t,this.Xc&&t(this.currentUser)},t.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},t.prototype.tu=function(){var t=this.auth&&this.auth.getUid();return l(null===t||"string"==typeof t),new Pr(t)},t}(),No=function(){function t(t,e){this.eu=t,this.nu=e,this.type="FirstParty",this.user=Pr.ni}return Object.defineProperty(t.prototype,"Kc",{get:function(){var t={"X-Goog-AuthUser":this.nu},e=this.eu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Lo=function(){function t(t,e){this.eu=t,this.nu=e}return t.prototype.getToken=function(){return Promise.resolve(new No(this.eu,this.nu))},t.prototype.Hc=function(t){t(Pr.ni)},t.prototype.Yc=function(){},t.prototype.zc=function(){},t}(),Ro=function(){function t(t,e,n,r,i,o){this.fn=t,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new pr(t,e)}return t.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.uu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.hu()},t.prototype.stop=function(){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.lu=function(){this.state=0,this.ys.reset()},t.prototype._u=function(){var t=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,(function(){return t.fu()})))},t.prototype.du=function(t){this.wu(),this.stream.send(t)},t.prototype.fu=function(){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(t){return this.uu()?[2,this.close(0)]:[2]}))}))},t.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},t.prototype.close=function(t,e){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(n){switch(n.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==t?this.ys.reset():e&&e.code===r.RESOURCE_EXHAUSTED?(u(e.toString()),u("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):e&&e.code===r.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.mu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Eu(this.ou),n=this.ou;this.ru.getToken().then((function(e){t.ou===n&&t.Iu(e)}),(function(n){e((function(){var e=new i(r.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Au(e)}))}))},t.prototype.Iu=function(t){var e=this,n=this.Eu(this.ou);this.stream=this.Ru(t),this.stream.gu((function(){n((function(){return e.state=2,e.listener.gu()}))})),this.stream.Tu((function(t){n((function(){return e.Au(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.hu=function(){var t=this;this.state=4,this.ys.gn((function(){return F.__awaiter(t,void 0,void 0,(function(){return F.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Au=function(t){return s("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Eu=function(t){var e=this;return function(n){e.fn.ws((function(){return e.ou===t?n():(s("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Do=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,a}return F.__extends(e,t),e.prototype.Ru=function(t){return this.iu.Pu("Listen",t)},e.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var o=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:h()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(t,e){return t.Qe?(l(void 0===e||"string"==typeof e),J.fromBase64String(e||"")):(l(void 0===e||e instanceof Uint8Array),J.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,c=u&&function(t){var e=void 0===t.code?r.UNKNOWN:_t(t.code);return new i(e,t.message||"")}(u);n=new Ht(o,a,s,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=Se(t,f.document.name),d=Ie(f.document.updateTime),v=new An({mapValue:{fields:f.document.fields}}),g=new On(p,d,v,{}),y=f.targetIds||[],m=f.removedTargetIds||[];n=new zt(y,m,g.key,g)}else if("documentDelete"in e){e.documentDelete;var b=e.documentDelete;b.document;var w=Se(t,b.document),_=b.readTime?Ie(b.readTime):at.min(),E=new Nn(w,_),I=b.removedTargetIds||[];n=new zt([],I,E.key,E)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var A=Se(t,T.document),x=T.removedTargetIds||[];n=new zt([],x,A,null)}else{if(!("filter"in e))return h();e.filter;var S=e.filter;S.targetId;var k=S.count||0,O=new bt(k),N=S.targetId;n=new Gt(N,O)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return at.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?at.min():e.readTime?Ie(e.readTime):at.min()}(t);return this.listener.yu(e,n)},e.prototype.Vu=function(t){var e={};e.database=Ne(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=dt(r)?{documents:Pe(t,r)}:{query:Me(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=_e(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return h()}}(0,e.et);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.du(e)},e.prototype.pu=function(t){var e={};e.database=Ne(this.serializer),e.removeTarget=t,this.du(e)},e}(Ro),Co=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,a.bu=!1,a}return F.__extends(e,t),Object.defineProperty(e.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.mu=function(){this.bu&&this.Su([])},e.prototype.Ru=function(t){return this.iu.Pu("Write",t)},e.prototype.onMessage=function(t){if(l(!!t.streamToken),this.lastStreamToken=t.streamToken,this.bu){this.ys.reset();var e=function(t,e){return t&&t.length>0?(l(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ie(t.updateTime):Ie(e);n.isEqual(at.min())&&(n=Ie(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new un(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ie(t.commitTime);return this.listener.Du(n,e)}return l(!t.writeResults||0===t.writeResults.length),this.bu=!0,this.listener.Cu()},e.prototype.Nu=function(){var t={};t.database=Ne(this.serializer),this.du(t)},e.prototype.Su=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return De(e.serializer,t)}))};this.du(n)},e}(Ro),Po=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.iu=n,i.serializer=r,i.Fu=!1,i}return F.__extends(e,t),e.prototype.xu=function(){if(this.Fu)throw new i(r.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.$u=function(t,e,n){var i=this;return this.xu(),this.credentials.getToken().then((function(r){return i.iu.$u(t,e,n,r)})).catch((function(t){throw t.code===r.UNAUTHENTICATED&&i.credentials.zc(),t}))},e.prototype.ku=function(t,e,n){var i=this;return this.xu(),this.credentials.getToken().then((function(r){return i.iu.ku(t,e,n,r)})).catch((function(t){throw t.code===r.UNAUTHENTICATED&&i.credentials.zc(),t}))},e.prototype.terminate=function(){this.Fu=!1},e}((function(){})),Mo=function(){function t(t,e){this.cs=t,this.di=e,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}return t.prototype.Bu=function(){var t=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,(function(){return t.Ou=null,t.Uu("Backend didn't respond within 10 seconds."),t.qu("Offline"),Promise.resolve()})))},t.prototype.Qu=function(t){"Online"===this.state?this.qu("Unknown"):(this.Mu++,this.Mu>=1&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.qu("Offline")))},t.prototype.set=function(t){this.Wu(),this.Mu=0,"Online"===t&&(this.Lu=!1),this.qu(t)},t.prototype.qu=function(t){t!==this.state&&(this.state=t,this.di(t))},t.prototype.Uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Lu?(u(e),this.Lu=!1):s("OnlineStateTracker",e)},t.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t}(),jo=function(t,e,n,r,i){var o=this;this.ju=t,this.Ku=e,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=i,this.Xu.Zu((function(t){n.ws((function(){return F.__awaiter(o,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return Ko(this)?(s("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return F.__awaiter(this,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:return(e=p(t)).Yu.add(4),[4,Fo(e)];case 1:return n.sent(),e.th.set("Unknown"),e.Yu.delete(4),[4,Uo(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.th=new Mo(n,r)};function Uo(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n;return F.__generator(this,(function(r){switch(r.label){case 0:if(!Ko(t))return[3,4];e=0,n=t.Ju,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Fo(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n;return F.__generator(this,(function(r){switch(r.label){case 0:e=0,n=t.Ju,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Vo(t){return F.__awaiter(this,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:return e=p(t),s("RemoteStore","RemoteStore shutting down."),e.Yu.add(5),[4,Fo(e)];case 1:return n.sent(),e.Xu.Di(),e.th.set("Unknown"),[2]}}))}))}function Bo(t,e){var n=p(t);n.Hu.has(e.targetId)||(n.Hu.set(e.targetId,e),Wo(n)?Ho(n):ua(n).uu()&&zo(n,e))}function qo(t,e){var n=p(t),r=ua(n);n.Hu.delete(e),r.uu()&&Go(n,e),0===n.Hu.size&&(r.uu()?r._u():Ko(n)&&n.th.set("Unknown"))}function zo(t,e){t.eh.Ie(e.targetId),ua(t).Vu(e)}function Go(t,e){t.eh.Ie(e),ua(t).pu(e)}function Ho(t){t.eh=new Kt({qe:function(e){return t.Gu.qe(e)},Ue:function(e){return t.Hu.get(e)||null}}),ua(t).start(),t.th.Bu()}function Wo(t){return Ko(t)&&!ua(t).cu()&&t.Hu.size>0}function Ko(t){return 0===p(t).Yu.size}function Xo(t){t.eh=void 0}function Yo(t){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(e){return t.Hu.forEach((function(e,n){zo(t,e)})),[2]}))}))}function Jo(t,e){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(n){return Xo(t),Wo(t)?(t.th.Qu(e),Ho(t)):t.th.set("Unknown"),[2]}))}))}function Qo(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o;return F.__generator(this,(function(a){switch(a.label){case 0:if(t.th.set("Online"),!(e instanceof Ht&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o;return F.__generator(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.Hu.has(o)?[4,t.Gu.nh(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.Hu.delete(o),t.eh.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),s("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,$o(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof zt?t.eh.be(e):e instanceof Gt?t.eh.$e(e):t.eh.De(e),n.isEqual(at.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,vo(t.ju)];case 8:return i=a.sent(),n.L(i)>=0?[4,function(t,e){var n=t.eh.Oe(e);return n.zt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=t.Hu.get(r);i&&t.Hu.set(r,i.it(n.resumeToken,e))}})),n.Ht.forEach((function(e){var n=t.Hu.get(e);if(n){t.Hu.set(e,n.it(J.B,n.nt)),Go(t,e);var r=new mt(n.target,e,1,n.sequenceNumber);zo(t,r)}})),t.Gu.sh(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return s("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,$o(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function $o(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r=this;return F.__generator(this,(function(i){switch(i.label){case 0:if(!mr(e))throw e;return t.Yu.add(1),[4,Fo(t)];case 1:return i.sent(),t.th.set("Offline"),n||(n=function(){return vo(t.ju)}),t.cs.Cs((function(){return F.__awaiter(r,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return s("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Yu.delete(1),[4,Uo(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Zo(t,e){return e().catch((function(n){return $o(t,n,e)}))}function ta(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return F.__generator(this,(function(a){switch(a.label){case 0:e=p(t),n=ca(e),r=e.zu.length>0?e.zu[e.zu.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return Ko(t)&&t.zu.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,yo(e.ju,r)];case 3:return null===(i=a.sent())?(0===e.zu.length&&n._u(),[3,7]):(r=i.batchId,function(t,e){t.zu.push(e);var n=ca(t);n.uu()&&n.vu&&n.Su(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,$o(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return ea(e)&&na(e),[2]}}))}))}function ea(t){return Ko(t)&&!ca(t).cu()&&t.zu.length>0}function na(t){ca(t).start()}function ra(t){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(e){return ca(t).Nu(),[2]}))}))}function ia(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return F.__generator(this,(function(o){for(e=ca(t),n=0,r=t.zu;n<r.length;n++)i=r[n],e.Su(i.mutations);return[2]}))}))}function oa(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i;return F.__generator(this,(function(o){switch(o.label){case 0:return r=t.zu.shift(),i=Xr.from(r,e,n),[4,Zo(t,(function(){return t.Gu.ih(i)}))];case 1:return o.sent(),[4,ta(t)];case 2:return o.sent(),[2]}}))}))}function aa(t,e){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(n){switch(n.label){case 0:return e&&ca(t).vu?[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,i;return F.__generator(this,(function(o){switch(o.label){case 0:return wt(i=e.code)&&i!==r.ABORTED?(n=t.zu.shift(),ca(t).lu(),[4,Zo(t,(function(){return t.Gu.rh(n.batchId,e)}))]):[3,3];case 1:return o.sent(),[4,ta(t)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ea(t)&&na(t),[2]}}))}))}function sa(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n;return F.__generator(this,(function(r){switch(r.label){case 0:return n=p(t),e?(n.Yu.delete(2),[4,Uo(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Yu.add(2),[4,Fo(n)]);case 3:r.sent(),n.th.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function ua(t){var e=this;return t.oh||(t.oh=function(t,e,n){var r=p(t);return r.xu(),new Do(e,r.iu,r.credentials,r.serializer,n)}(t.Ku,t.cs,{gu:Yo.bind(null,t),Tu:Jo.bind(null,t),yu:Qo.bind(null,t)}),t.Ju.push((function(n){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return n?(t.oh.lu(),Wo(t)?Ho(t):t.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.oh.stop()];case 2:e.sent(),Xo(t),e.label=3;case 3:return[2]}}))}))}))),t.oh}function ca(t){var e=this;return t.ah||(t.ah=function(t,e,n){var r=p(t);return r.xu(),new Co(e,r.iu,r.credentials,r.serializer,n)}(t.Ku,t.cs,{gu:ra.bind(null,t),Tu:aa.bind(null,t),Cu:ia.bind(null,t),Du:oa.bind(null,t)}),t.Ju.push((function(n){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return n?(t.ah.lu(),[4,ta(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.ah.stop()];case 3:e.sent(),t.zu.length>0&&(s("RemoteStore","Stopping write stream with "+t.zu.length+" pending writes"),t.zu=[]),e.label=4;case 4:return[2]}}))}))}))),t.ah}var fa=function(t){this.key=t},ha=function(t){this.key=t},la=function(){function t(t,e){this.query=t,this.uh=e,this.hh=null,this.te=!1,this.lh=Pt(),this.Wt=Pt(),this._h=Yn(t),this.fh=new Ut(this._h)}return Object.defineProperty(t.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),t.prototype.wh=function(t,e){var n=this,r=e?e.mh:new Ft,i=e?e.fh:this.fh,o=e?e.Wt:this.Wt,a=i,s=!1,u=Pn(this.query)&&i.size===this.query.limit?i.last():null,c=Mn(this.query)&&i.size===this.query.limit?i.first():null;if(t.ht((function(t,e){var f=i.get(t),h=e instanceof On?e:null;h&&(h=Xn(n.query,h)?h:null);var l=!!f&&n.Wt.has(f.key),p=!!h&&(h.Je||n.Wt.has(h.key)&&h.hasCommittedMutations),d=!1;f&&h?f.data().isEqual(h.data())?l!==p&&(r.track({type:3,doc:h}),d=!0):n.Th(f,h)||(r.track({type:2,doc:h}),d=!0,(u&&n._h(h,u)>0||c&&n._h(h,c)<0)&&(s=!0)):!f&&h?(r.track({type:0,doc:h}),d=!0):f&&!h&&(r.track({type:1,doc:f}),d=!0,(u||c)&&(s=!0)),d&&(h?(a=a.add(h),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Pn(this.query)||Mn(this.query))for(;a.size>this.query.limit;){var f=Pn(this.query)?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),r.track({type:1,doc:f})}return{fh:a,mh:r,Eh:s,Wt:o}},t.prototype.Th=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},t.prototype.yr=function(t,e,n){var r=this,i=this.fh;this.fh=t.fh,this.Wt=t.Wt;var o=t.mh.Ut();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return h()}};return n(t)-n(e)}(t.type,e.type)||r._h(t.doc,e.doc)})),this.Ih(n);var a=e?this.Ah():[],s=0===this.lh.size&&this.te?1:0,u=s!==this.hh;return this.hh=s,0!==o.length||u?{snapshot:new Vt(this.query,t.fh,i,o,t.Wt,0===s,u,!1),Rh:a}:{Rh:a}},t.prototype.Qs=function(t){return this.te&&"Offline"===t?(this.te=!1,this.yr({fh:this.fh,mh:new Ft,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},t.prototype.gh=function(t){return!this.uh.has(t)&&!!this.fh.has(t)&&!this.fh.get(t).Je},t.prototype.Ih=function(t){var e=this;t&&(t.ee.forEach((function(t){return e.uh=e.uh.add(t)})),t.ne.forEach((function(t){})),t.se.forEach((function(t){return e.uh=e.uh.delete(t)})),this.te=t.te)},t.prototype.Ah=function(){var t=this;if(!this.te)return[];var e=this.lh;this.lh=Pt(),this.fh.forEach((function(e){t.gh(e.key)&&(t.lh=t.lh.add(e.key))}));var n=[];return e.forEach((function(e){t.lh.has(e)||n.push(new ha(e))})),this.lh.forEach((function(t){e.has(t)||n.push(new fa(t))})),n},t.prototype.Ph=function(t){this.uh=t.Fc,this.lh=Pt();var e=this.wh(t.documents);return this.yr(e,!0)},t.prototype.yh=function(){return Vt.Gt(this.query,this.fh,this.Wt,0===this.hh)},t}(),pa=function(t,e,n){this.query=t,this.targetId=e,this.view=n},da=function(t){this.key=t,this.Vh=!1},va=function(){function t(t,e,n,r,i,o){this.ju=t,this.ph=e,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new it((function(t){return Wn(t)}),Hn),this.Fh=new Map,this.xh=[],this.$h=new Et(_.i),this.kh=new Map,this.Mh=new Ao,this.Oh={},this.Lh=new Map,this.Bh=Zi.da(),this.onlineState="Unknown",this.qh=void 0}return Object.defineProperty(t.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),t}();function ga(t,e,n,r){return F.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,u,c;return F.__generator(this,(function(f){switch(f.label){case 0:return t.Qh=function(e,n,r){return function(t,e,n,r){return F.__awaiter(this,void 0,void 0,(function(){var i,o,a;return F.__generator(this,(function(s){switch(s.label){case 0:return(i=e.view.wh(n)).Eh?[4,wo(t.ju,e.query,!1).then((function(t){var n=t.documents;return e.view.wh(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.zt.get(e.targetId),a=e.view.yr(i,t.Uh,o),[2,(xa(t,e.targetId,a.Rh),a.snapshot)]}}))}))}(t,e,n,r)},[4,wo(t.ju,e,!0)];case 1:return i=f.sent(),o=new la(e,i.Fc),a=o.wh(i.documents),s=qt.Zt(n,r&&"Offline"!==t.onlineState),u=o.yr(a,t.Uh,s),xa(t,n,u.Rh),c=new pa(e,n,o),[2,(t.Nh.set(e,c),t.Fh.has(n)?t.Fh.get(n).push(e):t.Fh.set(n,[e]),u.snapshot)]}}))}))}function ya(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r;return F.__generator(this,(function(i){switch(i.label){case 0:n=p(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,go(n.ju,e)];case 2:return r=i.sent(),e.zt.forEach((function(t,e){var r=n.kh.get(e);r&&(l(t.ee.size+t.ne.size+t.se.size<=1),t.ee.size>0?r.Vh=!0:t.ne.size>0?l(r.Vh):t.se.size>0&&(l(r.Vh),r.Vh=!1))})),[4,Oa(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,To(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function ma(t,e,n){var r=p(t);if(r.Uh&&0===n||!r.Uh&&1===n){var i=[];r.Nh.forEach((function(t,n){var r=n.view.Qs(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=p(t);n.onlineState=e;var r=!1;n.Bs.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Qs(e)&&(r=!0)})),r&&Dr(n)}(r.bh,e),i.length&&r.Ch.yu(i),r.onlineState=e,r.Uh&&r.Sh.Ki(e)}}function ba(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,s,u;return F.__generator(this,(function(c){switch(c.label){case 0:return(r=p(t)).Sh.Qi(e,"rejected",n),i=r.kh.get(e),(o=i&&i.key)?(a=(a=new Et(_.i)).ot(o,new Nn(o,at.min())),s=Pt().add(o),u=new Bt(at.min(),new Map,new At(K),a,s),[4,ya(r,u)]):[3,2];case 1:return c.sent(),r.$h=r.$h.remove(o),r.kh.delete(e),ka(r),[3,4];case 2:return[4,bo(r.ju,e,!1).then((function(){return Ta(r,e,n)})).catch(To)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function wa(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i;return F.__generator(this,(function(o){switch(o.label){case 0:n=p(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,po(n.ju,e)];case 2:return i=o.sent(),Ia(n,r,null),Ea(n,r),n.Sh.ki(r,"acknowledged"),[4,Oa(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,To(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function _a(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i;return F.__generator(this,(function(o){switch(o.label){case 0:r=p(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=p(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Sr.Oo(t,e).next((function(e){return l(null!==e),r=e.keys(),n.Sr.Wo(t,e)})).next((function(){return n.Sr.zo(t)})).next((function(){return n.Cc.kr(t,r)}))}))}(r.ju,e)];case 2:return i=o.sent(),Ia(r,e,n),Ea(r,e),r.Sh.ki(e,"rejected",n),[4,Oa(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,To(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ea(t,e){(t.Lh.get(e)||[]).forEach((function(t){t.resolve()})),t.Lh.delete(e)}function Ia(t,e,n){var r=p(t),i=r.Oh[r.currentUser.ti()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Oh[r.currentUser.ti()]=i}}function Ta(t,e,n){void 0===n&&(n=null),t.Sh.Bi(e);for(var r=0,i=t.Fh.get(e);r<i.length;r++){var o=i[r];t.Nh.delete(o),n&&t.Ch.Wh(o,n)}t.Fh.delete(e),t.Uh&&t.Mh.Uc(e).forEach((function(e){t.Mh.Ho(e)||Aa(t,e)}))}function Aa(t,e){var n=t.$h.get(e);null!==n&&(qo(t.ph,n),t.$h=t.$h.remove(e),t.kh.delete(n),ka(t))}function xa(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof fa?(t.Mh.Da(o.key,e),Sa(t,o)):o instanceof ha?(s("SyncEngine","Document no longer in limbo: "+o.key),t.Mh.Na(o.key,e),t.Mh.Ho(o.key)||Aa(t,o.key)):h()}}function Sa(t,e){var n=e.key;t.$h.get(n)||(s("SyncEngine","New document in limbo: "+n),t.xh.push(n),ka(t))}function ka(t){for(;t.xh.length>0&&t.$h.size<t.Dh;){var e=t.xh.shift(),n=t.Bh.next();t.kh.set(n,new da(e)),t.$h=t.$h.ot(e,n),Bo(t.ph,new mt(Bn(Cn(e.path)),n,2,Mr.ai))}}function Oa(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a;return F.__generator(this,(function(u){switch(u.label){case 0:return r=p(t),i=[],o=[],a=[],r.Nh.m()?[3,3]:(r.Nh.forEach((function(t,s){a.push(r.Qh(s,e,n).then((function(t){if(t){r.Uh&&r.Sh.Qi(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Zr.zr(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return u.sent(),r.Ch.yu(i),[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,f,h;return F.__generator(this,(function(l){switch(l.label){case 0:n=p(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return dr.forEach(e,(function(e){return dr.forEach(e.Kr,(function(r){return n.persistence.No.Da(t,e.targetId,r)})).next((function(){return dr.forEach(e.Gr,(function(r){return n.persistence.No.Na(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!mr(r=l.sent()))throw r;return s("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],u=a.targetId,a.fromCache||(c=n.bc.get(u),f=c.nt,h=c.rt(f),n.bc=n.bc.ot(u,h));return[2]}}))}))}(r.ju,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Na(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,o;return F.__generator(this,(function(a){switch(a.label){case 0:return(n=p(t)).currentUser.isEqual(e)?[3,3]:(s("SyncEngine","User change. New user:",e.ti()),[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o;return F.__generator(this,(function(a){switch(a.label){case 0:return n=p(t),r=n.Sr,i=n.Cc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Sr.Uo(t).next((function(a){return o=a,r=n.persistence.mc(e),i=new $r(n.Dc,r,n.persistence.Ic()),r.Uo(t)})).next((function(e){for(var n=[],r=[],a=Pt(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var f=0,h=c.mutations;f<h.length;f++){var l=h[f];a=a.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.kr(t,a).next((function(t){return{jh:t,Kh:n,Gh:r}}))}))}))];case 1:return o=a.sent(),[2,(n.Sr=r,n.Cc=i,n.Vc.Nc(n.Cc),o)]}}))}))}(n.ju,e)]);case 1:return o=a.sent(),n.currentUser=e,function(t,e){t.Lh.forEach((function(t){t.forEach((function(t){t.reject(new i(r.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Lh.clear()}(n),n.Sh.ji(e,o.Kh,o.Gh),[4,Oa(n,o.jh)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function La(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i;return F.__generator(this,(function(o){switch(o.label){case 0:return[4,wo((n=p(t)).ju,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ph(r),[2,(n.Uh&&xa(n,e.targetId,i.Rh),i)]}}))}))}function Ra(t,e,n,r){return F.__awaiter(this,void 0,void 0,(function(){var i,o;return F.__generator(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=p(t),r=p(n.Sr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Lo(t,e).next((function(e){return e?n.Cc.kr(t,e):dr.resolve(null)}))}))}((i=p(t)).ju,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,ta(i.ph)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ia(i,e,r||null),Ea(i,e),function(t,e){p(p(t).Sr).Ko(e)}(i.ju,e)):h(),a.label=4;case 4:return[4,Oa(i,o)];case 5:return a.sent(),[3,7];case 6:s("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function Da(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return F.__generator(this,(function(f){switch(f.label){case 0:return Fa(n=p(t)),Va(n),!0!==e||!0===n.qh?[3,3]:(r=n.Sh.Ci(),[4,Ca(n,r.A())]);case 1:return i=f.sent(),n.qh=!0,[4,sa(n.ph,!0)];case 2:for(f.sent(),o=0,a=i;o<a.length;o++)s=a[o],Bo(n.ph,s);return[3,7];case 3:return!1!==e||!1===n.qh?[3,7]:(u=[],c=Promise.resolve(),n.Fh.forEach((function(t,e){n.Sh.qi(e)?u.push(e):c=c.then((function(){return Ta(n,e),bo(n.ju,e,!0)})),qo(n.ph,e)})),[4,c]);case 4:return f.sent(),[4,Ca(n,u)];case 5:return f.sent(),function(t){var e=p(n);e.kh.forEach((function(t,n){qo(e.ph,n)})),e.Mh.Qc(),e.kh=new Map,e.$h=new Et(_.i)}(),n.qh=!1,[4,sa(n.ph,!1)];case 6:f.sent(),f.label=7;case 7:return[2]}}))}))}function Ca(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,f,h,l,d,v,g;return F.__generator(this,(function(y){switch(y.label){case 0:n=p(t),r=[],i=[],o=0,a=e,y.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Fh.get(s))&&0!==c.length?[4,mo(n.ju,Bn(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),f=0,h=c,y.label=3;case 3:return f<h.length?(l=h[f],d=n.Nh.get(l),[4,La(n,d)]):[3,6];case 4:(v=y.sent()).snapshot&&i.push(v.snapshot),y.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,_o(n.ju,s)];case 8:return g=y.sent(),[4,mo(n.ju,g)];case 9:return u=y.sent(),[4,ga(n,Pa(g),s,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Ch.yu(i),r)]}}))}))}function Pa(t){return Dn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ma(t){var e=p(t);return p(p(e.ju).persistence).pi()}function ja(t,e,n,r){return F.__awaiter(this,void 0,void 0,(function(){var i,o,a;return F.__generator(this,(function(u){switch(u.label){case 0:return(i=p(t)).qh?(s("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Fh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Eo(i.ju)];case 3:return o=u.sent(),a=Bt.Xt(e,"current"===n),[4,Oa(i,o,a)];case 4:return u.sent(),[3,8];case 5:return[4,bo(i.ju,e,!0)];case 6:return u.sent(),Ta(i,e,r),[3,8];case 7:h(),u.label=8;case 8:return[2]}}))}))}function Ua(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,u,c,f,h,l,p;return F.__generator(this,(function(d){switch(d.label){case 0:if(!(r=Fa(t)).qh)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(a=o[i],r.Fh.has(a)?(s("SyncEngine","Adding an already active target "+a),[3,5]):[4,_o(r.ju,a)]):[3,6];case 2:return u=d.sent(),[4,mo(r.ju,u)];case 3:return c=d.sent(),[4,ga(r,Pa(u),c.targetId,!1)];case 4:d.sent(),Bo(r.ph,c),d.label=5;case 5:return i++,[3,1];case 6:f=function(t){return F.__generator(this,(function(e){switch(e.label){case 0:return r.Fh.has(t)?[4,bo(r.ju,t,!1).then((function(){qo(r.ph,t),Ta(r,t)})).catch(To)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,d.label=7;case 7:return h<l.length?(p=l[h],[5,f(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Fa(t){var e=p(t);return e.ph.Gu.sh=ya.bind(null,e),e.ph.Gu.qe=function(t,e){var n=p(t),r=n.kh.get(e);if(r&&r.Vh)return Pt().add(r.key);var i=Pt(),o=n.Fh.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Nh.get(u);i=i.kt(c.view.dh)}return i}.bind(null,e),e.ph.Gu.nh=ba.bind(null,e),e.Ch.yu=function(t,e){for(var n=p(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.Bs.get(s);if(u){for(var c=0,f=u.listeners;c<f.length;c++)f[c].Ws(a)&&(r=!0);u.Ls=a}}r&&Dr(n)}.bind(null,e.bh),e.Ch.Wh=function(t,e,n){var r=p(t),i=r.Bs.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.Bs.delete(e)}.bind(null,e.bh),e}function Va(t){var e=p(t);return e.ph.Gu.ih=wa.bind(null,e),e.ph.Gu.rh=_a.bind(null,e),e}var Ba=function(){function t(){}return t.prototype.Nc=function(t){this.zh=t},t.prototype.Lr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.on.length||1===t.on.length&&t.on[0].field.p())}(e)||n.isEqual(at.min())?this.Hh(t,e):this.zh.kr(t,r).next((function(o){var u=i.Yh(e,o);return(Pn(e)||Mn(e))&&i.Eh(e.an,u,r,n)?i.Hh(t,e):(a()<=W.LogLevel.DEBUG&&s("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Kn(e)),i.zh.Lr(t,e,n).next((function(t){return u.forEach((function(e){t=t.ot(e.key,e)})),t})))}))},t.prototype.Yh=function(t,e){var n=new At(Yn(t));return e.forEach((function(e,r){r instanceof On&&Xn(t,r)&&(n=n.add(r))})),n},t.prototype.Eh=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Hh=function(t,e){return a()<=W.LogLevel.DEBUG&&s("IndexFreeQueryEngine","Using full collection scan to execute query:",Kn(e)),this.zh.Lr(t,e,at.min())},t}(),qa=function(){function t(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Jh=1,this.Xh=new At(xo.kc)}return t.prototype.$o=function(t){return dr.resolve(0===this.Sr.length)},t.prototype.ko=function(t,e,n,r){var i=this.Jh;this.Jh++,this.Sr.length>0&&this.Sr[this.Sr.length-1];var o=new Kr(i,e,n,r);this.Sr.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.Xh=this.Xh.add(new xo(u.key,i)),this.Dr.Mo(t,u.key.path.h())}return dr.resolve(o)},t.prototype.Oo=function(t,e){return dr.resolve(this.Zh(e))},t.prototype.Bo=function(t,e){var n=e+1,r=this.tl(n),i=r<0?0:r;return dr.resolve(this.Sr.length>i?this.Sr[i]:null)},t.prototype.qo=function(){return dr.resolve(0===this.Sr.length?-1:this.Jh-1)},t.prototype.Uo=function(t){return dr.resolve(this.Sr.slice())},t.prototype.Nr=function(t,e){var n=this,r=new xo(e,0),i=new xo(e,Number.POSITIVE_INFINITY),o=[];return this.Xh.Ft([r,i],(function(t){var e=n.Zh(t.jc);o.push(e)})),dr.resolve(o)},t.prototype.Or=function(t,e){var n=this,r=new At(K);return e.forEach((function(t){var e=new xo(t,0),i=new xo(t,Number.POSITIVE_INFINITY);n.Xh.Ft([e,i],(function(t){r=r.add(t.jc)}))})),dr.resolve(this.el(r))},t.prototype.Wr=function(t,e){var n=e.path,r=n.length+1,i=n;_.F(i)||(i=i.child(""));var o=new xo(new _(i),0),a=new At(K);return this.Xh.xt((function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(a=a.add(t.jc)),!0)}),o),dr.resolve(this.el(a))},t.prototype.el=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Zh(t);null!==r&&n.push(r)})),n},t.prototype.Wo=function(t,e){var n=this;l(0===this.nl(e.batchId,"removed")),this.Sr.shift();var r=this.Xh;return dr.forEach(e.mutations,(function(i){var o=new xo(i.key,e.batchId);return r=r.delete(o),n.No.Go(t,i.key)})).next((function(){n.Xh=r}))},t.prototype.Ko=function(t){},t.prototype.Ho=function(t,e){var n=new xo(e,0),r=this.Xh.$t(n);return dr.resolve(e.isEqual(r&&r.key))},t.prototype.zo=function(t){return this.Sr.length,dr.resolve()},t.prototype.nl=function(t,e){return this.tl(t)},t.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},t.prototype.Zh=function(t){var e=this.tl(t);return e<0||e>=this.Sr.length?null:this.Sr[e]},t}(),za=function(){function t(t,e){this.Dr=t,this.sl=e,this.docs=new Et(_.i),this.size=0}return t.prototype.Er=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:a,readTime:n}),this.size+=a-o,this.Dr.Mo(t,r.path.h())},t.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Rr=function(t,e){var n=this.docs.get(e);return dr.resolve(n?n.ta:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ot();return e.forEach((function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)})),dr.resolve(r)},t.prototype.Lr=function(t,e,n){for(var r=Lt(),i=new _(e.path.child("")),o=this.docs.ft(i);o.At();){var a=o.It(),s=a.key,u=a.value,c=u.ta,f=u.readTime;if(!e.path.T(s.path))break;f.L(n)<=0||c instanceof On&&Xn(e,c)&&(r=r.ot(c.key,c))}return dr.resolve(r)},t.prototype.il=function(t,e){return dr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.ra=function(t){return new Ga(this)},t.prototype.aa=function(t){return dr.resolve(this.size)},t}(),Ga=function(t){function e(e){var n=this;return(n=t.call(this)||this).ca=e,n}return F.__extends(e,t),e.prototype.yr=function(t){var e=this,n=[];return this.wr.forEach((function(r,i){i?n.push(e.ca.Er(t,i,e.readTime)):e.ca.Ar(r)})),dr.$n(n)},e.prototype.gr=function(t,e){return this.ca.Rr(t,e)},e.prototype.Pr=function(t,e){return this.ca.getEntries(t,e)},e}(Yr),Ha=function(){function t(t){this.persistence=t,this.rl=new it((function(t){return lt(t)}),pt),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this.ol=0,this.al=new Ao,this.targetCount=0,this.cl=Zi.fa()}return t.prototype.Ce=function(t,e){return this.rl.forEach((function(t,n){return e(n)})),dr.resolve()},t.prototype.Ea=function(t){return dr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ia=function(t){return dr.resolve(this.ol)},t.prototype.wa=function(t){return this.highestTargetId=this.cl.next(),dr.resolve(this.highestTargetId)},t.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),dr.resolve()},t.prototype.ga=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cl=new Zi(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},t.prototype.Ra=function(t,e){return this.ga(e),this.targetCount+=1,dr.resolve()},t.prototype.ya=function(t,e){return this.ga(e),dr.resolve()},t.prototype.Va=function(t,e){return this.rl.delete(e.target),this.al.Uc(e.targetId),this.targetCount-=1,dr.resolve()},t.prototype.po=function(t,e,n){var r=this,i=0,o=[];return this.rl.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.rl.delete(a),o.push(r.pa(t,s.targetId)),i++)})),dr.$n(o).next((function(){return i}))},t.prototype.ba=function(t){return dr.resolve(this.targetCount)},t.prototype.va=function(t,e){var n=this.rl.get(e)||null;return dr.resolve(n)},t.prototype.Sa=function(t,e,n){return this.al.Lc(e,n),dr.resolve()},t.prototype.Ca=function(t,e,n){this.al.qc(e,n);var r=this.persistence.No,i=[];return r&&e.forEach((function(e){i.push(r.Go(t,e))})),dr.$n(i)},t.prototype.pa=function(t,e){return this.al.Uc(e),dr.resolve()},t.prototype.Fa=function(t,e){var n=this.al.Wc(e);return dr.resolve(n)},t.prototype.Ho=function(t,e){return dr.resolve(this.al.Ho(e))},t}(),Wa=function(){function t(t){var e=this;this.ul={},this.Ma=new Mr(0),this.Oa=!1,this.Oa=!0,this.No=t(this),this.Ka=new Ha(this),this.Dr=new Ri,this.vr=function(t,n){return new za(t,(function(t){return e.No.hl(t)}))}(this.Dr)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),t.prototype.Za=function(){},t.prototype.tc=function(){},t.prototype.Ic=function(){return this.Dr},t.prototype.mc=function(t){var e=this.ul[t.ti()];return e||(e=new qa(this.Dr,this.No),this.ul[t.ti()]=e),e},t.prototype.Tc=function(){return this.Ka},t.prototype.Ec=function(){return this.vr},t.prototype.runTransaction=function(t,e,n){var r=this;s("MemoryPersistence","Starting transaction:",t);var i=new Ka(this.Ma.next());return this.No.ll(),n(i).next((function(t){return r.No._l(i).next((function(){return t}))})).Fn().then((function(t){return i.br(),t}))},t.prototype.fl=function(t,e){return dr.kn(Object.values(this.ul).map((function(n){return function(){return n.Ho(t,e)}})))},t}(),Ka=function(t){function e(e){var n=this;return(n=t.call(this)||this).xa=e,n}return F.__extends(e,t),e}(Qr),Xa=function(){function t(t){this.persistence=t,this.dl=new Ao,this.wl=null}return t.ml=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw h()},enumerable:!1,configurable:!0}),t.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),dr.resolve()},t.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),dr.resolve()},t.prototype.Go=function(t,e){return this.Tl.add(e.toString()),dr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.dl.Uc(e.targetId).forEach((function(t){return n.Tl.add(t.toString())}));var r=this.persistence.Tc();return r.Fa(t,e.targetId).next((function(t){t.forEach((function(t){return n.Tl.add(t.toString())}))})).next((function(){return r.Va(t,e)}))},t.prototype.ll=function(){this.wl=new Set},t.prototype._l=function(t){var e=this,n=this.persistence.Ec().ra();return dr.forEach(this.Tl,(function(r){var i=_.D(r);return e.El(t,i).next((function(t){t||n.Ar(i)}))})).next((function(){return e.wl=null,n.apply(t)}))},t.prototype.yc=function(t,e){var n=this;return this.El(t,e).next((function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())}))},t.prototype.hl=function(t){return 0},t.prototype.El=function(t,e){var n=this;return dr.kn([function(){return dr.resolve(n.dl.Ho(e))},function(){return n.persistence.Tc().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},t}(),Ya=function(){function t(t){this.Il=t.Il,this.Al=t.Al}return t.prototype.gu=function(t){this.Rl=t},t.prototype.Tu=function(t){this.gl=t},t.prototype.onMessage=function(t){this.Pl=t},t.prototype.close=function(){this.Al()},t.prototype.send=function(t){this.Il(t)},t.prototype.yl=function(){this.Rl()},t.prototype.Vl=function(t){this.gl(t)},t.prototype.pl=function(t){this.Pl(t)},t}(),Ja={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Qa=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.W=e.W,n}return F.__extends(e,t),e.prototype.Nl=function(t,e,n,o){return new Promise((function(a,u){var c=new gt.XhrIo;c.listenOnce(gt.EventType.COMPLETE,(function(){try{switch(c.getLastErrorCode()){case gt.ErrorCode.NO_ERROR:var e=c.getResponseJson();s("Connection","XHR received:",JSON.stringify(e)),a(e);break;case gt.ErrorCode.TIMEOUT:s("Connection",'RPC "'+t+'" timed out'),u(new i(r.DEADLINE_EXCEEDED,"Request time out"));break;case gt.ErrorCode.HTTP_ERROR:var n=c.getStatus();if(s("Connection",'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0){var o=c.getResponseJson().error;if(o&&o.status&&o.message){var f=function(t){var e=o.status.toLowerCase().replace("_","-");return Object.values(r).indexOf(e)>=0?e:r.UNKNOWN}();u(new i(f,o.message))}else u(new i(r.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new i(r.UNAVAILABLE,"Connection failed."));break;default:h()}}finally{s("Connection",'RPC "'+t+'" completed.')}}));var f=JSON.stringify(o);c.send(e,"POST",f,n,15)}))},e.prototype.Pu=function(t,e){var n=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=gt.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(a.initMessageHeaders,e),V.isMobileCordova()||V.isReactNative()||V.isElectron()||V.isIE()||V.isUWP()||V.isBrowserExtension()||(a.httpHeadersOverwriteParam="$httpHeaders");var u=n.join("");s("Connection","Creating WebChannel: "+u,a);var f=o.createWebChannel(u,a),h=!1,p=!1,d=new Ya({Il:function(t){p?s("Connection","Not sending because WebChannel is closed:",t):(h||(s("Connection","Opening WebChannel transport."),f.open(),h=!0),s("Connection","WebChannel sending:",t),f.send(t))},Al:function(){return f.close()}}),v=function(t,e){f.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return v(gt.WebChannel.EventType.OPEN,(function(){p||s("Connection","WebChannel transport opened.")})),v(gt.WebChannel.EventType.CLOSE,(function(){p||(p=!0,s("Connection","WebChannel transport closed"),d.Vl())})),v(gt.WebChannel.EventType.ERROR,(function(t){p||(p=!0,c("Connection","WebChannel transport errored:",t),d.Vl(new i(r.UNAVAILABLE,"The operation could not be completed")))})),v(gt.WebChannel.EventType.MESSAGE,(function(t){var e;if(!p){var n=t.data[0];l(!!n);var o=n,a=o.error||(null===(e=o[0])||void 0===e?void 0:e.error);if(a){s("Connection","WebChannel received error:",a);var u=a.status,c=function(t){var e=vt[u];if(void 0!==e)return _t(e)}(),h=a.message;void 0===c&&(c=r.INTERNAL,h="Unknown error status: "+u+" with message "+a.message),p=!0,d.Vl(new i(c,h)),f.close()}else s("Connection","WebChannel received:",n),d.pl(n)}})),setTimeout((function(){d.yl()}),0),d},e}(function(){function t(t){this.bl=t,this.U=t.U;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return t.prototype.$u=function(t,e,n,r){var i=this.Dl(t,e);s("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(t,i,o,n).then((function(t){return s("RestConnection","Received: ",t),t}),(function(e){throw c("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.ku=function(t,e,n,r){return this.$u(t,e,n,r)},t.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",t["Content-Type"]="text/plain",e)for(var n in e.Kc)e.Kc.hasOwnProperty(n)&&(t[n]=e.Kc[n])},t.prototype.Dl=function(t,e){var n=Ja[t];return this.vl+"/v1/"+e+":"+n},t}()),$a=function(){function t(){var t=this;this.Fl=function(){return t.xl()},this.$l=function(){return t.kl()},this.Ml=[],this.Ol()}return t.prototype.Zu=function(t){this.Ml.push(t)},t.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.$l)},t.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.$l)},t.prototype.xl=function(){s("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},t.prototype.kl=function(){s("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},t.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Za=function(){function t(){}return t.prototype.Zu=function(t){},t.prototype.Di=function(){},t}();function ts(t){return new ge(t,!0)}var es="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ns=function(){function t(){}return t.prototype.initialize=function(t){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return this.Sh=this.Ll(t),this.persistence=this.Bl(t),[4,this.persistence.start()];case 1:return e.sent(),this.ql=this.Ul(t),this.ju=this.Ql(t),[2]}}))}))},t.prototype.Ul=function(t){return null},t.prototype.Ql=function(t){return e=this.persistence,n=new Ba,r=t.Wl,new lo(e,n,r);var e,n,r},t.prototype.Bl=function(t){if(t.persistenceSettings.jl)throw new i(r.FAILED_PRECONDITION,es);return new Wa(Xa.ml)},t.prototype.Ll=function(t){return new Wr},t.prototype.terminate=function(){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}}))}))},t.prototype.clearPersistence=function(t,e){throw new i(r.FAILED_PRECONDITION,es)},t}(),rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.initialize=function(e){return F.__awaiter(this,void 0,void 0,(function(){var n,r=this;return F.__generator(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Kl.fi,this.Sh instanceof Hr?(this.Sh.fi={er:Ra.bind(null,n),nr:ja.bind(null,n),sr:Ua.bind(null,n),pi:Ma.bind(null,n)},[4,this.Sh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Xa((function(t){return F.__awaiter(r,void 0,void 0,(function(){return F.__generator(this,(function(e){switch(e.label){case 0:return[4,Da(this.Kl.fi,t)];case 1:return e.sent(),this.ql&&(t&&!this.ql.Ei?this.ql.start(this.ju):t||this.ql.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Ll=function(t){if(t.persistenceSettings.jl&&t.persistenceSettings.synchronizeTabs){var e=Tr();if(!Hr.Ln(e))throw new i(r.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ho(t.bl.U,t.bl.persistenceKey);return new Hr(e,t.cs,n,t.clientId,t.Wl)}return new Wr},e}(function(t){function e(e){var n=this;return(n=t.call(this)||this).Kl=e,n}return F.__extends(e,t),e.prototype.initialize=function(e){return F.__awaiter(this,void 0,void 0,(function(){return F.__generator(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Io(this.ju)];case 2:return n.sent(),[4,this.Kl.initialize(this,e)];case 3:return n.sent(),[4,Va(this.Kl.fi)];case 4:return n.sent(),[4,ta(this.Kl.ph)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ul=function(t){var e=this.persistence.No.wo;return new ii(e,t.cs)},e.prototype.Bl=function(t){var e=ho(t.bl.U,t.bl.persistenceKey),n=ts(t.bl.U);return new ao(t.persistenceSettings.synchronizeTabs,e,t.clientId,ri.ao(t.persistenceSettings.cacheSizeBytes),t.cs,Tr(),Ar(),n,this.Sh,t.persistenceSettings.ka)},e.prototype.Ll=function(t){return new Wr},e.prototype.clearPersistence=function(t,e){return function(t){return F.__awaiter(this,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:return vr.Ln()?(e=t+"main",[4,vr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(ho(t,e))},e}(ns)),is=function(){function t(){}return t.prototype.initialize=function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n=this;return F.__generator(this,(function(r){switch(r.label){case 0:return this.ju?[3,2]:(this.ju=t.ju,this.Sh=t.Sh,this.Ku=this.Gl(e),this.ph=this.zl(e),this.bh=this.Hl(e),this.fi=this.Yl(e),this.Sh.di=function(t){return ma(n.fi,t,1)},this.ph.Gu.Jl=Na.bind(null,this.fi),[4,sa(this.ph,this.fi.Uh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.Hl=function(t){return new Nr},t.prototype.Gl=function(t){var e,n=ts(t.bl.U),r=(e=t.bl,new Qa(e));return function(t,e,n){return new Po(t,r,n)}(t.credentials,0,n)},t.prototype.zl=function(t){var e,n,r,i,o,a=this;return e=this.ju,n=this.Ku,r=t.cs,i=function(t){return ma(a.fi,t,0)},o=$a.Ln()?new $a:new Za,new jo(e,n,r,i,o)},t.prototype.Yl=function(t){return function(t,e,n,r,i,o,a){var s=new va(t,e,n,r,i,o);return a&&(s.qh=!0),s}(this.ju,this.ph,this.bh,this.Sh,t.Wl,t.Dh,!t.persistenceSettings.jl||!t.persistenceSettings.synchronizeTabs)},t.prototype.terminate=function(){return Vo(this.ph)},t}(),os=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Xl(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Xl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Zl=function(){this.muted=!0},t.prototype.Xl=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),as=function(t){!function(t,e,n,o){if(!(e instanceof Array)||e.length<1)throw new i(r.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+z(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(x("FieldPath","string",e,t[e]),0===t[e].length)throw new i(r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new w(t)},ss=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return F.__extends(e,t),e.documentId=function(){return new e(w.v().R())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","FieldPath",1,t);return this.t_.isEqual(t.t_)},e}(as),us=new RegExp("[~\\*/\\[\\]]"),cs=function(t){this.e_=t},fs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.n_=function(t){if(2!==t.s_)throw 1===t.s_?t.i_(this.e_+"() can only appear at the top level of your update data"):t.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return t.We.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(cs);function hs(t,e,n){return new Is({s_:3,r_:e.settings.r_,methodName:t.e_,o_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var ls=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.n_=function(t){return new sn(t.path,new Qe)},e.prototype.isEqual=function(t){return t instanceof e},e}(cs),ps=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return F.__extends(e,t),e.prototype.n_=function(t){var e=hs(this,t,!0),n=this.a_.map((function(t){return Os(t,e)})),r=new $e(n);return new sn(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(cs),ds=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).a_=n,r}return F.__extends(e,t),e.prototype.n_=function(t){var e=hs(this,t,!0),n=this.a_.map((function(t){return Os(t,e)})),r=new tn(n);return new sn(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(cs),vs=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).c_=n,r}return F.__extends(e,t),e.prototype.n_=function(t){var e=new nn(t.serializer,be(t.serializer,this.c_));return new sn(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(cs),gs=function(){function t(t,e){if(I("GeoPoint",arguments,2),x("GeoPoint","number",1,t),x("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new i(r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new i(r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.u_=t,this.h_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.u_===t.u_&&this.h_===t.h_},t.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},t.prototype.Y=function(t){return K(this.u_,t.u_)||K(this.h_,t.h_)},t}(),ys=function(t){this.l_=t},ms=/^__.*__$/,bs=function(t,e,n){this.__=t,this.f_=e,this.d_=n},ws=function(){function t(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}return t.prototype.w_=function(t,e){var n=[];return null!==this.We?n.push(new mn(t,this.data,this.We,e)):n.push(new yn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new wn(t,this.fieldTransforms)),n},t}(),_s=function(){function t(t,e,n){this.data=t,this.We=e,this.fieldTransforms=n}return t.prototype.w_=function(t,e){var n=[new mn(t,this.data,this.We,e)];return this.fieldTransforms.length>0&&n.push(new wn(t,this.fieldTransforms)),n},t}();function Es(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw h()}}var Is=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),t.prototype.T_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},t.prototype.E_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.T_({path:n,o_:!1});return r.I_(t),r},t.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.T_({path:n,o_:!1});return r.m_(),r},t.prototype.R_=function(t){return this.T_({path:void 0,o_:!0})},t.prototype.i_=function(t){return Ps(t,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},t.prototype.contains=function(t){return void 0!==this.We.find((function(e){return t.T(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.T(e.field)}))},t.prototype.m_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},t.prototype.I_=function(t){if(0===t.length)throw this.i_("Document fields must not be empty");if(Es(this.s_)&&ms.test(t))throw this.i_('Document fields cannot begin and end with "__"')},t}(),Ts=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||ts(t)}return t.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Is({s_:t,methodName:e,r_:n,path:w.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function As(t,e,n,o,a,s){void 0===s&&(s={});var u=t.P_(s.merge||s.mergeFields?2:0,e,n,a);Rs("Data must be an object, but it was:",u,o);var c,f,l=Ns(o,u);if(s.merge)c=new an(u.We),f=u.fieldTransforms;else if(s.mergeFields){for(var p=[],d=0,v=s.mergeFields;d<v.length;d++){var g=v[d],y=void 0;if(g instanceof as)y=g.t_;else{if("string"!=typeof g)throw h();y=Cs(e,g,n)}if(!u.contains(y))throw new i(r.INVALID_ARGUMENT,"Field '"+y+"' is specified in your field mask but missing from your input data.");Ms(p,y)||p.push(y)}c=new an(p),f=u.fieldTransforms.filter((function(t){return c.Ye(t.field)}))}else c=null,f=u.fieldTransforms;return new ws(new An(l),c,f)}function xs(t,e,n,r){var i=t.P_(1,e,n);Rs("Data must be an object, but it was:",i,r);var o=[],a=new xn;v(r,(function(t,r){var s=Cs(e,t,n),u=i.A_(s);if(r instanceof fs||r instanceof ys&&r.l_ instanceof fs)o.push(s);else{var c=Os(r,u);null!=c&&(o.push(s),a.set(s,c))}}));var s=new an(o);return new _s(a.Xe(),s,i.fieldTransforms)}function Ss(t,e,n,o,a,s){var u=t.P_(1,e,n),c=[Ds(e,o,n)],f=[a];if(s.length%2!=0)throw new i(r.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<s.length;h+=2)c.push(Ds(e,s[h])),f.push(s[h+1]);for(var l=[],p=new xn,d=c.length-1;d>=0;--d)if(!Ms(l,c[d])){var v=c[d],g=f[d],y=u.A_(v);if(g instanceof fs||g instanceof ys&&g.l_ instanceof fs)l.push(v);else{var m=Os(g,y);null!=m&&(l.push(v),p.set(v,m))}}var b=new an(l);return new _s(p.Xe(),b,u.fieldTransforms)}function ks(t,e,n,r){return void 0===r&&(r=!1),Os(n,t.P_(r?4:3,e))}function Os(t,e){if(t instanceof ys&&(t=t.l_),Ls(t))return Rs("Unsupported field value:",e,t),Ns(t,e);if(t instanceof cs)return function(t,e){if(!Es(e.s_))throw e.i_(t.e_+"() can only be used with update() and set()");if(!e.path)throw e.i_(t.e_+"() is not currently supported inside arrays");var n=t.n_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.We.push(e.path),t instanceof Array){if(e.settings.o_&&4!==e.s_)throw e.i_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Os(o[i],e.R_(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return be(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ot.fromDate(t);return{timestampValue:we(e.serializer,n)}}if(t instanceof ot){var r=new ot(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:we(e.serializer,r)}}if(t instanceof gs)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Q)return{bytesValue:_e(e.serializer,t.q)};if(t instanceof bs){var i=e.U,o=t.__;if(!o.isEqual(i))throw e.i_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Te(t.__||e.U,t.f_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.i_("Unsupported field value: "+C(t))}(t,e)}function Ns(t,e){var n={};return g(t)?e.path&&e.path.length>0&&e.We.push(e.path):v(t,(function(t,r){var i=Os(r,e.E_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ls(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ot||t instanceof gs||t instanceof Q||t instanceof bs||t instanceof cs)}function Rs(t,e,n){if(!Ls(n)||!D(n)){var r=C(n);throw"an object"===r?e.i_(t+" a custom object"):e.i_(t+" "+r)}}function Ds(t,e,n){if(e instanceof as)return e.t_;if("string"==typeof e)return Cs(t,e);throw Ps("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Cs(t,n,o){try{return function(t){if(t.search(us)>=0)throw new i(r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ss.bind.apply(ss,F.__spreadArrays([void 0],t.split("."))))}catch(e){throw new i(r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(n).t_}catch(n){throw Ps((a=n)instanceof Error?a.message:a.toString(),t,!1,void 0,o)}var a}function Ps(t,e,n,o,a){var s=o&&!o.m(),u=void 0!==a,c="Function "+e+"() called with invalid data";n&&(c+=" (via `toFirestore()`)");var f="";return(s||u)&&(f+=" (found",s&&(f+=" in field "+o),u&&(f+=" in document "+a),f+=")"),new i(r.INVALID_ARGUMENT,(c+=". ")+t+f)}function Ms(t,e){return t.some((function(t){return t.isEqual(e)}))}var js=function(){function t(t){this.Ku=t,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}return t.prototype.v_=function(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n=this;return F.__generator(this,(function(o){switch(o.label){case 0:if(this.S_(),this.mutations.length>0)throw new i(r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,s;return F.__generator(this,(function(u){switch(u.label){case 0:return n=p(t),r=Ne(n.serializer)+"/documents",i={documents:e.map((function(t){return xe(n.serializer,t)}))},[4,n.ku("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){l(!!e.found),e.found.name,e.found.updateTime;var n=Se(t,e.found.name),r=Ie(e.found.updateTime),i=new An({mapValue:{fields:e.found.fields}});return new On(n,r,i,{})}(t,e):"missing"in e?function(t,e){l(!!e.missing),l(!!e.readTime);var n=Se(t,e.missing),r=Ie(e.readTime);return new Nn(n,r)}(t,e):h()}(n.serializer,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());l(!!e),s.push(e)})),s)]}}))}))}(this.Ku,t)];case 1:return[2,((e=o.sent()).forEach((function(t){t instanceof Nn||t instanceof On?n.D_(t):h()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.w_(t,this.Ge(t))),this.b_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.w_(t,this.C_(t)))}catch(t){this.p_=t}this.b_.add(t.toString())},t.prototype.delete=function(t){this.write([new In(t,this.Ge(t))]),this.b_.add(t.toString())},t.prototype.commit=function(){return F.__awaiter(this,void 0,void 0,(function(){var t,e=this;return F.__generator(this,(function(n){switch(n.label){case 0:if(this.S_(),this.p_)throw this.p_;return t=this.y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=_.D(n);e.mutations.push(new Tn(r,e.Ge(r)))})),[4,function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i;return F.__generator(this,(function(o){switch(o.label){case 0:return n=p(t),r=Ne(n.serializer)+"/documents",i={writes:e.map((function(t){return De(n.serializer,t)}))},[4,n.$u("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Ku,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},t.prototype.D_=function(t){var e;if(t instanceof On)e=t.version;else{if(!(t instanceof Nn))throw h();e=at.min()}var n=this.y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new i(r.ABORTED,"Document version changed between two reads.")}else this.y_.set(t.key.toString(),e)},t.prototype.Ge=function(t){var e=this.y_.get(t.toString());return!this.b_.has(t.toString())&&e?cn.updateTime(e):cn.ze()},t.prototype.C_=function(t){var e=this.y_.get(t.toString());if(!this.b_.has(t.toString())&&e){if(e.isEqual(at.min()))throw new i(r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return cn.updateTime(e)}return cn.exists(!0)},t.prototype.write=function(t){this.S_(),this.mutations=this.mutations.concat(t)},t.prototype.S_=function(){},t}(),Us=function(){function t(t,e,n,r){this.cs=t,this.Ku=e,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new pr(this.cs,"transaction_retry")}return t.prototype.run=function(){this.F_()},t.prototype.F_=function(){var t=this;this.ys.gn((function(){return F.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return F.__generator(this,(function(r){return t=new js(this.Ku),(e=this.x_(t))&&e.then((function(e){n.cs.ws((function(){return t.commit().then((function(){n.ls.resolve(e)})).catch((function(t){n.k_(t)}))}))})).catch((function(t){n.k_(t)})),[2]}))}))}))},t.prototype.x_=function(t){try{var e=this.updateFunction(t);return!st(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},t.prototype.k_=function(t){var e=this;this.N_>0&&this.M_(t)?(this.N_-=1,this.cs.ws((function(){return e.F_(),Promise.resolve()}))):this.ls.reject(t)},t.prototype.M_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!wt(e)}return!1},t}(),Fs=function(){function t(t,e){this.credentials=t,this.cs=e,this.clientId=H.k(),this.O_=new lr}return t.prototype.start=function(t,e,n,r){var i=this;this.L_(),this.bl=t;var o=new lr,a=!1;return this.credentials.Hc((function(t){if(!a)return a=!0,s("FirestoreClient","Initializing. user=",t.uid),i.B_(e,n,r,t,o).then(i.O_.resolve,i.O_.reject);i.cs.Cs((function(){return function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r;return F.__generator(this,(function(i){switch(i.label){case 0:return(n=p(t)).cs.xs(),s("RemoteStore","RemoteStore received new credentials"),r=Ko(n),n.Yu.add(3),[4,Fo(n)];case 1:return i.sent(),r&&n.th.set("Unknown"),[4,n.Gu.Jl(e)];case 2:return i.sent(),n.Yu.delete(3),[4,Uo(n)];case 3:return i.sent(),[2]}}))}))}(i.ph,t)}))})),this.cs.ws((function(){return i.O_.promise})),o.promise},t.prototype.enableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue((function(){return t.persistence.tc(!0),function(t){var e=p(t);return e.Yu.delete(0),Uo(e)}(t.ph)}))},t.prototype.B_=function(t,e,n,r,i){return F.__awaiter(this,void 0,void 0,(function(){var o,a,s=this;return F.__generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),o={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:r,Dh:100,persistenceSettings:n},[4,t.initialize(o)];case 1:return u.sent(),[4,e.initialize(t,o)];case 2:return u.sent(),this.persistence=t.persistence,this.Sh=t.Sh,this.ju=t.ju,this.ql=t.ql,this.Ku=e.Ku,this.ph=e.ph,this.fi=e.fi,this.q_=e.bh,this.q_.Us=function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,s;return F.__generator(this,(function(u){switch(u.label){case 0:return n=Fa(t),(o=n.Nh.get(e))?(r=o.targetId,n.Sh.Oi(r),i=o.view.yh(),[3,4]):[3,1];case 1:return[4,mo(n.ju,Bn(e))];case 2:return a=u.sent(),s=n.Sh.Oi(a.targetId),r=a.targetId,[4,ga(n,e,r,"current"===s)];case 3:i=u.sent(),n.Uh&&Bo(n.ph,a),u.label=4;case 4:return[2,i]}}))}))}.bind(null,this.fi),this.q_.js=function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i;return F.__generator(this,(function(o){switch(o.label){case 0:return n=p(t),r=n.Nh.get(e),(i=n.Fh.get(r.targetId)).length>1?[2,(n.Fh.set(r.targetId,i.filter((function(t){return!Hn(t,e)}))),void n.Nh.delete(e))]:n.Uh?(n.Sh.Bi(r.targetId),n.Sh.Fi(r.targetId)?[3,2]:[4,bo(n.ju,r.targetId,!1).then((function(){n.Sh.Ui(r.targetId),qo(n.ph,r.targetId),Ta(n,r.targetId)})).catch(To)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ta(n,r.targetId),[4,bo(n.ju,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}.bind(null,this.fi),this.persistence.Za((function(){return F.__awaiter(s,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),i.resolve(),[3,4];case 3:if(a=u.sent(),i.reject(a),!this.U_(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.B_(new ns,new is,{jl:!1},r,i))];case 4:return[2]}}))}))},t.prototype.U_=function(t){return"FirebaseError"===t.name?t.code===r.FAILED_PRECONDITION||t.code===r.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.L_=function(){if(this.cs.ps)throw new i(r.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.L_(),this.cs.enqueue((function(){return t.persistence.tc(!1),function(t){return F.__awaiter(this,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:return(e=p(t)).Yu.add(0),[4,Fo(e)];case 1:return n.sent(),e.th.set("Offline"),[2]}}))}))}(t.ph)}))},t.prototype.terminate=function(){var t=this;this.cs.Ds();var e=new lr;return this.cs.bs((function(){return F.__awaiter(t,void 0,void 0,(function(){var t,n;return F.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Vo(this.ph)];case 1:return r.sent(),[4,this.Sh.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yc(),e.resolve(),[3,5];case 4:return t=r.sent(),n=kr(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.L_();var e=new lr;return this.cs.ws((function(){return function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a;return F.__generator(this,(function(u){switch(u.label){case 0:Ko((n=p(t)).ph)||s("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=p(n.ju);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Sr.qo(t)}))}()];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Lh.get(r)||[]).push(e),n.Lh.set(r,i),[3,4]);case 3:return o=u.sent(),a=kr(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}(t.fi,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.L_();var i=new os(n),o=new Cr(t,i,e);return this.cs.ws((function(){return Lr(r.q_,o)})),function(){i.Zl(),r.cs.ws((function(){return Rr(r.q_,o)}))}},t.prototype.Q_=function(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n=this;return F.__generator(this,(function(o){switch(o.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return o.sent(),e=new lr,[2,(this.cs.ws((function(){return function(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var o,a,s;return F.__generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(t,e){var n=p(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Cc.Cr(t,e)}))}(t,e)];case 1:return(o=u.sent())instanceof On?n.resolve(o):o instanceof Nn?n.resolve(null):n.reject(new i(r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return a=u.sent(),s=kr(a,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}}))}))}(n.ju,t,e)})),e.promise)]}}))}))},t.prototype.W_=function(t,e){return void 0===e&&(e={}),F.__awaiter(this,void 0,void 0,(function(){var n,o=this;return F.__generator(this,(function(a){switch(a.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return a.sent(),n=new lr,[2,(this.cs.ws((function(){return function(t,e,n,o,a){var s=new os({next:function(s){e.ws((function(){return Rr(t,u)}));var c=s.docs.has(n);!c&&s.fromCache?a.reject(new i(r.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&s.fromCache&&o&&"server"===o.source?a.reject(new i(r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(s)},error:function(t){return a.reject(t)}}),u=new Cr(Cn(n.path),s,{includeMetadataChanges:!0,Xs:!0});return Lr(t,u)}(o.q_,o.cs,t,e,n)})),n.promise)]}}))}))},t.prototype.j_=function(t){return F.__awaiter(this,void 0,void 0,(function(){var e,n=this;return F.__generator(this,(function(r){switch(r.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return r.sent(),e=new lr,[2,(this.cs.ws((function(){return function(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,s,u;return F.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,wo(t,e,!0)];case 1:return r=c.sent(),i=new la(e,r.Fc),o=i.wh(r.documents),a=i.yr(o,!1),n.resolve(a.snapshot),[3,3];case 2:return s=c.sent(),u=kr(s,"Failed to execute query '"+e+" against cache"),n.reject(u),[3,3];case 3:return[2]}}))}))}(n.ju,t,e)})),e.promise)]}}))}))},t.prototype.K_=function(t,e){return void 0===e&&(e={}),F.__awaiter(this,void 0,void 0,(function(){var n,o=this;return F.__generator(this,(function(a){switch(a.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return a.sent(),n=new lr,[2,(this.cs.ws((function(){return function(t,e,n,o,a){var s=new os({next:function(n){e.ws((function(){return Rr(t,u)})),n.fromCache&&"server"===o.source?a.reject(new i(r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:function(t){return a.reject(t)}}),u=new Cr(n,s,{includeMetadataChanges:!0,Xs:!0});return Lr(t,u)}(o.q_,o.cs,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.L_();var n=new lr;return this.cs.ws((function(){return function(t,e,n){return F.__awaiter(this,void 0,void 0,(function(){var r,i,o,a;return F.__generator(this,(function(s){switch(s.label){case 0:r=Va(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=p(t),i=ot.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Pt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Cc.kr(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],f=dn(c,n.get(c.key));null!=f&&a.push(new mn(c.key,f,Sn(f.proto.mapValue),cn.exists(!0)))}return r.Sr.ko(t,i,a,e)}))})).then((function(t){var e=t.lr(n);return{batchId:t.batchId,wr:e}}))}(r.ju,e)];case 2:return i=s.sent(),r.Sh.xi(i.batchId),function(t,e,n){var r=t.Oh[t.currentUser.ti()];r||(r=new Et(K)),r=r.ot(e,n),t.Oh[t.currentUser.ti()]=r}(r,i.batchId,n),[4,Oa(r,i.wr)];case 3:return s.sent(),[4,ta(r.ph)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=kr(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}(e.fi,t,n)})),n.promise},t.prototype.U=function(){return this.bl.U},t.prototype.G_=function(t){var e=this;this.L_();var n=new os(t);return this.cs.ws((function(){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(t){return[2,function(t,e){p(t).qs.add(e),e.next()}(this.q_,n)]}))}))})),function(){n.Zl(),e.cs.ws((function(){return F.__awaiter(e,void 0,void 0,(function(){return F.__generator(this,(function(t){return[2,function(t,e){p(t).qs.delete(e)}(this.q_,n)]}))}))}))}},Object.defineProperty(t.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.L_();var n=new lr;return this.cs.ws((function(){return new Us(e.cs,e.Ku,t,n).run(),Promise.resolve()})),n.promise},t}();function Vs(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Bs=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.H_=n,this.Y_=r,this.J_=i}return t.prototype.X_=function(t){switch(Zt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ae(t.integerValue||t.doubleValue);case 3:return this.Z_(t.timestampValue);case 4:return this.tf(t);case 5:return t.stringValue;case 6:return this.J_(se(t.bytesValue));case 7:return this.ef(t.referenceValue);case 8:return this.nf(t.geoPointValue);case 9:return this.sf(t.arrayValue);case 10:return this.if(t.mapValue);default:throw h()}},t.prototype.if=function(t){var e=this,n={};return v(t.fields||{},(function(t,r){n[t]=e.X_(r)})),n},t.prototype.nf=function(t){return new gs(ae(t.latitude),ae(t.longitude))},t.prototype.sf=function(t){var e=this;return(t.values||[]).map((function(t){return e.X_(t)}))},t.prototype.tf=function(t){switch(this.H_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Jt(n)?t(n):n}(t);return null==e?null:this.X_(e);case"estimate":return this.Z_(Qt(t));default:return null}},t.prototype.Z_=function(t){var e=oe(t),n=new ot(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.ef=function(t){var e=m.g(t);l(We(e));var n=new rt(e.get(1),e.get(3)),r=new _(e.u(5));return n.isEqual(this.U)||u("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(r)},t}(),qs=ri.ho,zs=function(){function t(t){var e,n,o,a,s;if(void 0===t.host){if(void 0!==t.ssl)throw new i(r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else k("settings","non-empty string","host",t.host),this.host=t.host,O("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(M("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),O("settings","object","credentials",t.credentials),this.credentials=t.credentials,O("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),O("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?u("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&u("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(o=t.ignoreUndefinedProperties)&&void 0!==o&&o,O("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ri._o;else{if(t.cacheSizeBytes!==qs&&t.cacheSizeBytes<ri.lo)throw new i(r.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ri.lo);this.cacheSizeBytes=t.cacheSizeBytes}O("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(a=t.experimentalForceLongPolling)&&void 0!==a&&a,O("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(s=t.experimentalAutoDetectLongPolling)&&void 0!==s&&s,function(t,e,n,o){if(!0===e&&!0===o)throw new i(r.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Gs=function(){function t(e,n,o,a){var s=this;if(void 0===o&&(o=new ns),void 0===a&&(a=new is),this.rf=o,this.af=a,this.cf=null,this.uf=new Sr,this.INTERNAL={delete:function(){return F.__awaiter(s,void 0,void 0,(function(){return F.__generator(this,(function(t){switch(t.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var u=e;this.cf=u,this.__=t._f(u),this.ff=u.name,this.df=new Oo(n)}else{var c=e;if(!c.projectId)throw new i(r.INVALID_ARGUMENT,"Must provide projectId");this.__=new rt(c.projectId,c.database),this.ff="[DEFAULT]",this.df=new ko}this.wf=new zs({})}return Object.defineProperty(t.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new Ts(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){I("Firestore.settings",arguments,1),x("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.wf),t)).merge;var e=new zs(t);if(this.lf&&!this.wf.isEqual(e))throw new i(r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.wf=e,void 0!==e.credentials&&(this.df=function(t){if(!t)return new ko;switch(t.type){case"gapi":var e=t.client;return l(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Lo(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new i(r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},t.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.lf)throw new i(r.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var o=!1,a=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&u("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),o=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,a=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,o&&a))throw new i(r.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:o,ka:a})},t.prototype.clearPersistence=function(){return F.__awaiter(this,void 0,void 0,(function(){var t,e=this;return F.__generator(this,(function(n){if(void 0!==this.lf&&!this.lf.z_)throw new i(r.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new lr,[2,(this.uf.bs((function(){return F.__awaiter(e,void 0,void 0,(function(){var e;return F.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.hf(),Vs(t))return this.lf.G_(t);x("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.lf.G_(e)},t.prototype.hf=function(){return this.lf||this.Ef(new ns,new is,{jl:!1}),this.lf},t.prototype.Af=function(){return new nt(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},t.prototype.Ef=function(t,e,n){var r=this.Af();return this.lf=new Fs(this.df,this.uf),this.lf.start(r,t,e,n)},t._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new i(r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new i(r.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new rt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.cf)throw new i(r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return I("Firestore.collection",arguments,1),x("Firestore.collection","non-empty string",1,t),this.hf(),new ru(m.g(t),this,null)},t.prototype.doc=function(t){return I("Firestore.doc",arguments,1),x("Firestore.doc","non-empty string",1,t),this.hf(),Ks.Rf(m.g(t),this,null)},t.prototype.collectionGroup=function(t){if(I("Firestore.collectionGroup",arguments,1),x("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new i(r.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new eu(function(t){return new Rn(m.P(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return I("Firestore.runTransaction",arguments,1),x("Firestore.runTransaction","function",1,t),this.hf().transaction((function(n){return t(new Hs(e,n))}))},t.prototype.batch=function(){return this.hf(),new Ws(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(a()){case W.LogLevel.DEBUG:return"debug";case W.LogLevel.ERROR:return"error";case W.LogLevel.SILENT:return"silent";case W.LogLevel.WARN:return"warn";case W.LogLevel.INFO:return"info";case W.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;I("Firestore.setLogLevel",arguments,1),L("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,o.setLogLevel(e)},t.prototype.gf=function(){return this.wf.timestampsInSnapshots},t.prototype.Pf=function(){return this.wf},t}(),Hs=function(){function t(t,e){this.yf=t,this.Vf=e}return t.prototype.get=function(t){var e=this;I("Transaction.get",arguments,1);var n=su("Transaction.get",t,this.yf);return this.Vf.v_([n.f_]).then((function(t){if(!t||1!==t.length)return h();var r=t[0];if(r instanceof Nn)return new Ys(e.yf,n.f_,null,!1,!1,n.d_);if(r instanceof On)return new Ys(e.yf,n.f_,r,!1,!1,n.d_);throw h()}))},t.prototype.set=function(t,e,n){A("Transaction.set",arguments,2,3);var r=su("Transaction.set",t,this.yf);n=iu("Transaction.set",n);var i=cu(r.d_,e,n),o=As(this.yf.mf,"Transaction.set",r.f_,i,null!==r.d_,n);return this.Vf.set(r.f_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof e||e instanceof ss?(T("Transaction.update",arguments,3),r=su("Transaction.update",t,this.yf),i=Ss(this.yf.mf,"Transaction.update",r.f_,e,n,o)):(I("Transaction.update",arguments,2),r=su("Transaction.update",t,this.yf),i=xs(this.yf.mf,"Transaction.update",r.f_,e)),this.Vf.update(r.f_,i),this},t.prototype.delete=function(t){I("Transaction.delete",arguments,1);var e=su("Transaction.delete",t,this.yf);return this.Vf.delete(e.f_),this},t}(),Ws=function(){function t(t){this.yf=t,this.pf=[],this.bf=!1}return t.prototype.set=function(t,e,n){A("WriteBatch.set",arguments,2,3),this.vf();var r=su("WriteBatch.set",t,this.yf);n=iu("WriteBatch.set",n);var i=cu(r.d_,e,n),o=As(this.yf.mf,"WriteBatch.set",r.f_,i,null!==r.d_,n);return this.pf=this.pf.concat(o.w_(r.f_,cn.ze())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.vf(),"string"==typeof e||e instanceof ss?(T("WriteBatch.update",arguments,3),r=su("WriteBatch.update",t,this.yf),i=Ss(this.yf.mf,"WriteBatch.update",r.f_,e,n,o)):(I("WriteBatch.update",arguments,2),r=su("WriteBatch.update",t,this.yf),i=xs(this.yf.mf,"WriteBatch.update",r.f_,e)),this.pf=this.pf.concat(i.w_(r.f_,cn.exists(!0))),this},t.prototype.delete=function(t){I("WriteBatch.delete",arguments,1),this.vf();var e=su("WriteBatch.delete",t,this.yf);return this.pf=this.pf.concat(new In(e.f_,cn.ze())),this},t.prototype.commit=function(){return this.vf(),this.bf=!0,this.pf.length>0?this.yf.hf().write(this.pf):Promise.resolve()},t.prototype.vf=function(){if(this.bf)throw new i(r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ks=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.__,e,r)||this).f_=e,i.firestore=n,i.d_=r,i.lf=i.firestore.hf(),i}return F.__extends(e,t),e.Rf=function(t,n,o){if(t.length%2!=0)throw new i(r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new e(new _(t),n,o)},Object.defineProperty(e.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new ru(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(I("DocumentReference.collection",arguments,1),x("DocumentReference.collection","non-empty string",1,t),!t)throw new i(r.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=m.g(t);return new ru(this.f_.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.f_.isEqual(t.f_)&&this.d_===t.d_},e.prototype.set=function(t,e){A("DocumentReference.set",arguments,1,2),e=iu("DocumentReference.set",e);var n=cu(this.d_,t,e),r=As(this.firestore.mf,"DocumentReference.set",this.f_,n,null!==this.d_,e);return this.lf.write(r.w_(this.f_,cn.ze()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof ss?(T("DocumentReference.update",arguments,2),n=Ss(this.firestore.mf,"DocumentReference.update",this.f_,t,e,r)):(I("DocumentReference.update",arguments,1),n=xs(this.firestore.mf,"DocumentReference.update",this.f_,t)),this.lf.write(n.w_(this.f_,cn.exists(!0)))},e.prototype.delete=function(){return I("DocumentReference.delete",arguments,0),this.lf.write([new In(this.f_,cn.ze())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];A("DocumentReference.onSnapshot",arguments,1,4);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Vs(i[s])||(M("DocumentReference.onSnapshot",a=i[s],["includeMetadataChanges"]),O("DocumentReference.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),s++);var u={includeMetadataChanges:a.includeMetadataChanges};if(Vs(i[s])){var c=i[s];i[s]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[s+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[s+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else x("DocumentReference.onSnapshot","function",s,i[s]),S("DocumentReference.onSnapshot","function",s+1,i[s+1]),S("DocumentReference.onSnapshot","function",s+2,i[s+2]);var f={next:function(t){i[s]&&i[s](r.Sf(t))},error:i[s+1],complete:i[s+2]};return this.lf.listen(Cn(this.f_.path),u,f)},e.prototype.get=function(t){var e=this;A("DocumentReference.get",arguments,0,1),au("DocumentReference.get",t);var n=this.firestore.hf();return t&&"cache"===t.source?n.Q_(this.f_).then((function(t){return new Ys(e.firestore,e.f_,t,!0,t instanceof On&&t.Je,e.d_)})):n.W_(this.f_,t).then((function(t){return e.Sf(t)}))},e.prototype.withConverter=function(t){return new e(this.f_,this.firestore,t)},e.prototype.Sf=function(t){var e=t.docs.get(this.f_);return new Ys(this.firestore,this.f_,e,t.fromCache,t.hasPendingWrites,this.d_)},e}(bs),Xs=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Ys=function(){function t(t,e,n,r,i,o){this.yf=t,this.f_=e,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}return t.prototype.data=function(t){var e=this;if(A("DocumentSnapshot.data",arguments,0,1),t=ou("DocumentSnapshot.data",t),this.Df){if(this.d_){var n=new Js(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,t)}return new Bs(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",(function(t){return new Ks(t,e.yf,null)}),(function(t){return new tt(t)})).X_(this.Df.rn())}},t.prototype.get=function(t,e){var n=this;if(A("DocumentSnapshot.get",arguments,1,2),e=ou("DocumentSnapshot.get",e),this.Df){var r=this.Df.data().field(Ds("DocumentSnapshot.get",t,this.f_));if(null!==r)return new Bs(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",(function(t){return new Ks(t,n.yf,n.d_)}),(function(t){return new tt(t)})).X_(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ks(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Xs(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw j("isEqual","DocumentSnapshot",1,e);return this.yf===e.yf&&this.Cf===e.Cf&&this.f_.isEqual(e.f_)&&(null===this.Df?null===e.Df:this.Df.isEqual(e.Df))&&this.d_===e.d_},t}(),Js=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Ys);function Qs(t,e,n){if("string"==typeof n){if(""===n)throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fn(e)&&-1!==n.indexOf("/"))throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var o=e.path.child(m.g(n));if(!_.F(o))throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+o+"' is not because it has an odd number of segments ("+o.length+").");return ue(t,new _(o))}if(n instanceof bs)return ue(t,n.f_);throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+C(n)+".")}function $s(t,e){if(!Array.isArray(t)||0===t.length)throw new i(r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new i(r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new i(r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new i(r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Zs(t,e,n){if(!n.isEqual(e))throw new i(r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function tu(t){if(Mn(t)&&0===t.on.length)throw new i(r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var eu=function(){function t(t,e,n){this.Ff=t,this.firestore=e,this.d_=n}return t.prototype.where=function(e,n,o){I("Query.where",arguments,3),P("Query.where",3,o);var a=L("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),s=Ds("Query.where",e),u=function(t,e,n,o,a,s,u){var c;if(a.p()){if("array-contains"===s||"array-contains-any"===s)throw new i(r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s+"' queries on FieldPath.documentId().");if("in"===s||"not-in"===s){$s(u,s);for(var f=[],h=0,l=u;h<l.length;h++){var p=l[h];f.push(Qs(o,t,p))}c={arrayValue:{values:f}}}else c=Qs(o,t,u)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||$s(u,s),c=ks(n,"Query.where",u,"in"===s||"not-in"===s);var d=Jn.create(a,s,c);return function(t,e){if(e.hn()){var n=Un(t);if(null!==n&&!n.isEqual(e.field))throw new i(r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var o=jn(t);null!==o&&Zs(0,e.field,o)}var a=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==a)throw a===e.op?new i(r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new i(r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}(t,d),d}(this.Ff,0,this.firestore.mf,this.firestore.__,s,a,o);return new t(function(t,e){var n=t.filters.concat([e]);return new Rn(t.path,t.collectionGroup,t.on.slice(),n,t.limit,t.an,t.startAt,t.endAt)}(this.Ff,u),this.firestore,this.d_)},t.prototype.orderBy=function(e,n){var o;if(A("Query.orderBy",arguments,1,2),S("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)o="asc";else{if("desc"!==n)throw new i(r.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");o="desc"}var a=Ds("Query.orderBy",e),s=function(t,e,n){if(null!==t.startAt)throw new i(r.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new i(r.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var o=new cr(e,n);return function(t,e){if(null===jn(t)){var n=Un(t);null!==n&&Zs(0,n,e.field)}}(t,o),o}(this.Ff,a,o);return new t(function(t,e){var n=t.on.concat([e]);return new Rn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.an,t.startAt,t.endAt)}(this.Ff,s),this.firestore,this.d_)},t.prototype.limit=function(e){return I("Query.limit",arguments,1),x("Query.limit","number",1,e),U("Query.limit",1,e),new t(qn(this.Ff,e,"F"),this.firestore,this.d_)},t.prototype.limitToLast=function(e){return I("Query.limitToLast",arguments,1),x("Query.limitToLast","number",1,e),U("Query.limitToLast",1,e),new t(qn(this.Ff,e,"L"),this.firestore,this.d_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];T("Query.startAt",arguments,1);var i=this.xf("Query.startAt",e,n,!0);return new t(zn(this.Ff,i),this.firestore,this.d_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];T("Query.startAfter",arguments,1);var i=this.xf("Query.startAfter",e,n,!1);return new t(zn(this.Ff,i),this.firestore,this.d_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];T("Query.endBefore",arguments,1);var i=this.xf("Query.endBefore",e,n,!0);return new t(Gn(this.Ff,i),this.firestore,this.d_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];T("Query.endAt",arguments,1);var i=this.xf("Query.endAt",e,n,!1);return new t(Gn(this.Ff,i),this.firestore,this.d_)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw j("isEqual","Query",1,e);return this.firestore===e.firestore&&Hn(this.Ff,e.Ff)&&this.d_===e.d_},t.prototype.withConverter=function(e){return new t(this.Ff,this.firestore,e)},t.prototype.xf=function(t,e,n,o){if(P(t,1,e),e instanceof Ys)return I(t,F.__spreadArrays([e],n),1),function(t,e,n,o,a){if(!o)throw new i(r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var s=[],u=0,c=Vn(t);u<c.length;u++){var f=c[u];if(f.field.p())s.push(ue(e,o.key));else{var h=o.field(f.field);if(Jt(h))throw new i(r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===h){var l=f.field.R();throw new i(r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}s.push(h)}}return new or(s,a)}(this.Ff,this.firestore.__,t,e.Df,o);var a=[e].concat(n);return function(t,e,n,o,a,s){var u=t.on;if(a.length>u.length)throw new i(r.INVALID_ARGUMENT,"Too many arguments provided to "+o+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var c=[],f=0;f<a.length;f++){var h=a[f];if(u[f].field.p()){if("string"!=typeof h)throw new i(r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+o+"(), but got a "+typeof h);if(!Fn(t)&&-1!==h.indexOf("/"))throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+o+"() must be a plain document ID, but '"+h+"' contains a slash.");var l=t.path.child(m.g(h));if(!_.F(l))throw new i(r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+o+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var p=new _(l);c.push(ue(e,p))}else{var d=ks(n,o,h);c.push(d)}}return new or(c,s)}(this.Ff,this.firestore.__,this.firestore.mf,t,a,o)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];A("Query.onSnapshot",arguments,1,4);var a={},s=0;if("object"!=typeof i[s]||Vs(i[s])||(M("Query.onSnapshot",a=i[s],["includeMetadataChanges"]),O("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),s++),Vs(i[s])){var u=i[s];i[s]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[s+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[s+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)}else x("Query.onSnapshot","function",s,i[s]),S("Query.onSnapshot","function",s+1,i[s+1]),S("Query.onSnapshot","function",s+2,i[s+2]);var c={next:function(t){i[s]&&i[s](new nu(r.firestore,r.Ff,t,r.d_))},error:i[s+1],complete:i[s+2]};return tu(this.Ff),this.firestore.hf().listen(this.Ff,a,c)},t.prototype.get=function(t){var e=this;A("Query.get",arguments,0,1),au("Query.get",t),tu(this.Ff);var n=this.firestore.hf();return(t&&"cache"===t.source?n.j_(this.Ff):n.K_(this.Ff,t)).then((function(t){return new nu(e.firestore,e.Ff,t,e.d_)}))},t}(),nu=function(){function t(t,e,n,r){this.yf=t,this.$f=e,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new Xs(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;A("QuerySnapshot.forEach",arguments,1,2),x("QuerySnapshot.forEach","function",1,t),this.kf.docs.forEach((function(r){t.call(e,n.Lf(r,n.metadata.fromCache,n.kf.Wt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new eu(this.$f,this.yf,this.d_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(M("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),O("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.kf.Kt)throw new i(r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===e||(this.Mf=function(t,e,n){if(t.Qt.m()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Wt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Qt;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Wt.has(e.doc.key)),o=-1,a=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(a=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:uu(e.type),doc:r,oldIndex:o,newIndex:a}}))}(this.kf,e,this.Lf.bind(this)),this.Of=e),this.Mf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw j("isEqual","QuerySnapshot",1,e);return this.yf===e.yf&&Hn(this.$f,e.$f)&&this.kf.isEqual(e.kf)&&this.d_===e.d_},t.prototype.Lf=function(t,e,n){return new Js(this.yf,t.key,t,e,n,this.d_)},t}(),ru=function(t){function e(e,n,o){var a=this;if((a=t.call(this,Cn(e),n,o)||this).Bf=e,e.length%2!=1)throw new i(r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.R()+" has "+e.length);return a}return F.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Ff.path.h();return t.m()?null:new Ks(new _(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){A("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=H.k()),x("CollectionReference.doc","non-empty string",1,t);var e=m.g(t);return Ks.Rf(this.Ff.path.child(e),this.firestore,this.d_)},e.prototype.add=function(t){I("CollectionReference.add",arguments,1);var e=this.d_?this.d_.toFirestore(t):t;x("CollectionReference.add","object",1,e);var n=this.doc();return new Ks(n.f_,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Bf,this.firestore,t)},e}(eu);function iu(t,e){if(void 0===e)return{merge:!1};if(M(t,e,["merge","mergeFields"]),O(t,"boolean","merge",e.merge),function(t,e,n,o,a){void 0!==o&&function(t,e,n,o,a){if(!(o instanceof Array))throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+C(o));for(var s=0;s<o.length;++s)if(!a(o[s]))throw new i(r.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+s+" was: "+C(o[s]))}(t,"mergeFields",0,o,(function(t){return"string"==typeof t||t instanceof ss}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new i(r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ou(t,e){return void 0===e?{}:(M(t,e,["serverTimestamps"]),N(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function au(t,e){S(t,"object",1,e),e&&(M(t,e,["source"]),N(t,0,"source",e.source,["default","server","cache"]))}function su(t,e,n){if(e instanceof bs){if(e.firestore!==n)throw new i(r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw j(t,"DocumentReference",1,e)}function uu(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return h()}}function cu(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var fu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F.__extends(e,t),e.serverTimestamp=function(){E("FieldValue.serverTimestamp",arguments);var t=new ls("serverTimestamp");return t.e_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){E("FieldValue.delete",arguments);var t=new fs("deleteField");return t.e_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];T("FieldValue.arrayUnion",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("arrayUnion()",arguments,1),new ps("arrayUnion",t)}.apply(void 0,t);return r.e_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];T("FieldValue.arrayRemove",arguments,1);var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return T("arrayRemove()",arguments,1),new ds("arrayRemove",t)}.apply(void 0,t);return r.e_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){x("FieldValue.increment","number",1,t),I("FieldValue.increment",arguments,1);var n=function(t){return new vs("increment",t)}(t);return n.e_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.l_.isEqual(t.l_)},e}(ys),hu={Firestore:Gs,GeoPoint:gs,Timestamp:ot,Blob:tt,Transaction:Hs,WriteBatch:Ws,DocumentReference:Ks,DocumentSnapshot:Ys,Query:eu,QueryDocumentSnapshot:Js,QuerySnapshot:nu,CollectionReference:ru,FieldPath:ss,FieldValue:fu,setLogLevel:Gs.setLogLevel,CACHE_SIZE_UNLIMITED:qs};function lu(t){!function(t,e){t.INTERNAL.registerComponent(new B.Component("firestore",(function(t){return function(t,e){var n=new is,r=new rs(n);return new Gs(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},hu)))}(t),t.registerVersion("@firebase/firestore","1.18.0")}lu(n.default),Rt.__PRIVATE_registerFirestore=lu}).call(this)}).call(this,bt);var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});var Ct,Pt=(Ct=et)&&"object"==typeof Ct&&"default"in Ct?Ct:{default:Ct},Mt=function(){function t(t,e){this.code_=ee(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return ee(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.serverResponse_?this.message_+"\n"+this.serverResponse_:this.message_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!1,configurable:!0}),t}(),jt="unknown",Ut="object-not-found",Ft="quota-exceeded",Vt="unauthenticated",Bt="unauthorized",qt="retry-limit-exceeded",zt="canceled",Gt="invalid-url",Ht="invalid-default-bucket",Wt="cannot-slice-blob",Kt="server-file-wrong-size",Xt="no-download-url",Yt="invalid-argument",Jt="invalid-argument-count",Qt="app-deleted",$t="invalid-root-operation",Zt="invalid-format",te="internal-error";function ee(t){return"storage/"+t}function ne(){return new Mt(jt,"An unknown error occurred, please check the error payload for server response.")}function re(){return new Mt(zt,"User canceled the upload/download.")}function ie(){return new Mt(Wt,"Cannot slice blob for upload. Please retry the upload.")}function oe(t,e,n){return new Mt(Yt,"Invalid argument in `"+e+"` at index "+t+": "+n)}function ae(){return new Mt(Qt,"The Firebase app was deleted.")}function se(t,e){return new Mt(Zt,"String does not match format '"+t+"': "+e)}function ue(t){throw new Mt(te,"Internal error: "+t)}var ce={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function fe(t){switch(t){case ce.RAW:case ce.BASE64:case ce.BASE64URL:case ce.DATA_URL:return;default:throw"Expected one of the event types: ["+ce.RAW+", "+ce.BASE64+", "+ce.BASE64URL+", "+ce.DATA_URL+"]."}}var he=function(t,e){this.data=t,this.contentType=e||null};function le(t,e){switch(t){case ce.RAW:return new he(pe(e));case ce.BASE64:case ce.BASE64URL:return new he(de(t,e));case ce.DATA_URL:return new he((n=new ge(e)).base64?de(ce.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(d){throw se(ce.DATA_URL,"Malformed data URL.")}return pe(e)}(n.rest),new ge(e).contentType)}var n;throw ne()}function pe(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function de(t,e){switch(t){case ce.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw se(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case ce.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw se(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(d){throw se(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var ve,ge=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw se(ce.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},ye={STATE_CHANGED:"state_changed"},me="running",be="pausing",we="paused",_e="success",Ee="canceling",Ie="canceled",Te="error",Ae={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function xe(t){switch(t){case me:case be:case Ee:return Ae.RUNNING;case we:return Ae.PAUSED;case _e:return Ae.SUCCESS;case Ie:return Ae.CANCELED;case Te:default:return Ae.ERROR}}function Se(t){return null!=t}function ke(t){return void 0!==t}function Oe(t){return"function"==typeof t}function Ne(t){return"object"==typeof t}function Le(t){return Ne(t)&&null!==t}function Re(t){return"string"==typeof t||t instanceof String}function De(t){return Ce(t)&&Number.isInteger(t)}function Ce(t){return"number"==typeof t||t instanceof Number}function Pe(t){return Me()&&t instanceof Blob}function Me(){return"undefined"!=typeof Blob}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(ve||(ve={}));var je=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ve.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=ve.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=ve.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw ue("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),Se(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return Se(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw ue("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw ue("cannot .getStatus() before sending");try{return this.xhr_.status}catch(d){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw ue("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){Se(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){Se(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Ue=function(){function t(){}return t.prototype.createXhrIo=function(){return new je},t}();function Fe(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}var Ve=function(){function t(t,e){var n=0,r="";Pe(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Pe(this.data_)){var r=(o=e,a=n,(i=this.data_).webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Me()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Fe();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Me())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}.apply(null,r))}var i=e.map((function(t){return Re(t)?le(ce.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Be=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(d){return new t(e,"")}if(""===n.path)return n;throw new Mt(Ht,"Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function i(t){t.path_=decodeURIComponent(t.path)}for(var o="firebasestorage.googleapis.com".replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/([A-Za-z0-9.\\-_]+)/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:i}],s=0;s<a.length;s++){var u=a[s],c=u.regex.exec(e);if(c){var f=c[u.indices.bucket],h=c[u.indices.path];h||(h=""),n=new t(f,h),u.postModify(n);break}}if(null==n)throw function(t){return new Mt(Gt,"Invalid URL '"+t+"'.")}(e);return n},t}();function qe(t){var e,n;try{e=JSON.parse(t)}catch(d){return null}return Ne(n=e)&&!Array.isArray(n)?e:null}function ze(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Ge(t){return"https://firebasestorage.googleapis.com/v0"+t}function He(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}function We(t,e){return e}var Ke=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||We},Xe=null;function Ye(t,e,n){var r=qe(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Be(n,r);return e.makeStorageReference(i)}})}(r,t),r}(t,r,n)}function Je(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function Qe(t){if(!Ne(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!Ne(n))throw"Expected object for 'customMetadata' mapping."}else if(Le(n))throw"Mapping for '"+e+"' cannot be an object."}}function $e(t){if(!Ne(t)||!t)throw"Expected ListOptions object.";for(var e in t)if("maxResults"===e){if(!De(t.maxResults)||t.maxResults<=0)throw"Expected maxResults to be a positive number.";if(t.maxResults>1e3)throw"Expected maxResults to be less than or equal to 1000."}else{if("pageToken"!==e)throw"Unknown option: "+e;if(t.pageToken&&!Re(t.pageToken))throw"Expected pageToken to be string."}}var Ze=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function tn(t){if(!t)throw ne()}function en(t,e){return function(n,r){var i=Ye(t,r,e);return tn(null!==i),i}}function nn(t,e){return function(n,r){var i=Ye(t,r,e);return tn(null!==i),function(t,e){var n=qe(e);if(null===n)return null;if(!Re(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.bucket,r=t.fullPath;return Ge("/b/"+i(n)+"/o/"+i(r))+He({alt:"media",token:e})}))[0]}(i,r)}}function rn(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new Mt(Vt,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Mt(Ft,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Mt(Bt,"User does not have permission to access '"+i+"'.")):r=n,r.setServerResponseProp(n.serverResponseProp()),r}}function on(t){var e=rn(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Mt(Ut,"Object '"+i+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function an(t,e,n){var r=Ge(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Ze(r,"GET",en(t,n),i);return o.errorHandler=on(e),o}function sn(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Ge(e.bucketOnlyServerUrl()),s=t.maxOperationRetryTime,u=new Ze(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=qe(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t.makeStorageReference(new Be(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var f=c[u];s=t.makeStorageReference(new Be(e,f.name)),r.items.push(s)}return r}(t,e,r)}(t,e,r);return tn(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=rn(e),u}function un(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var cn=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function fn(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(d){tn(!1)}return tn(!!n&&-1!==(e||["active"]).indexOf(n)),n}var hn=function(t,e,n){if(Oe(t)||Se(e)||Se(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},ln=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function pn(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a,s,u,c,f,h;if(!(r<=n.length&&n.length<=i))throw a=r,s=i,u=t,c=n.length,a===s?(f=a,h=1===a?"argument":"arguments"):(f="between "+a+" and "+s,h="arguments"),new Mt(Jt,"Invalid argument count in `"+u+"`: Expected "+f+" "+h+", received "+c+".");for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(d){throw d instanceof Error?oe(o,t,d.message):oe(o,t,d)}}var dn=function(t,e){var n=this;this.validator=function(e){n.optional&&!ke(e)||t(e)},this.optional=!!e};function vn(t,e){function n(t){if(!Re(t))throw"Expected string."}var r,i,o;return t?(i=n,o=t,r=function(t){i(t),o(t)}):r=n,new dn(r,e)}function gn(){return new dn((function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Me()&&t instanceof Blob))throw"Expected Blob or File."}))}function yn(t){return new dn(Qe,t)}function mn(){return new dn((function(t){if(!(Ce(t)&&t>=0))throw"Expected a number 0 or greater."}))}function bn(t,e){return new dn((function(e){if(!(null===e||Se(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)}),e)}function wn(t){return new dn((function(t){if(null!==t&&!Oe(t))throw"Expected a Function."}),t)}function _n(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var En=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.service_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=me,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(zt)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(Te))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(zt)?a.completeTransitions_():(a.error_=t,a.transition_(Te))},this.promise_=new Promise((function(t,e){a.resolve_=t,a.reject_=e,a.start_()})),this.promise_.then(null,(function(){}))}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===me&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.service_.getAuthToken().then((function(n){switch(e.state_){case me:t(n);break;case Ee:e.transition_(Ie);break;case be:e.transition_(we)}}))},t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=un(e,r,i),s={name:a.fullPath},u=Ge(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},f=Je(a,n),h=t.maxUploadRetryTime,l=new Ze(u,"POST",(function(t){var e;fn(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(d){tn(!1)}return tn(Re(e)),e}),h);return l.urlParams=s,l.headers=c,l.body=f,l.errorHandler=rn(e),l}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new Ze(n,"POST",(function(t){var e=fn(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(d){tn(!1)}n||tn(!1);var i=Number(n);return tn(!isNaN(i)),new cn(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=rn(e),o}(t.service_,t.location_,e,t.blob_),i=t.service_.makeRequest(r,n);t.request_=i,i.getPromise().then((function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new cn(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=function(t,e,n,r,i,o,a,s){var u=new cn(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Mt(Kt,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,f=c;i>0&&(f=Math.min(f,i));var h=u.current,l=h+f,p={"X-Goog-Upload-Command":f===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,l);if(null===d)throw ie();var v=e.maxUploadRetryTime,g=new Ze(n,"POST",(function(t,n){var i,a=fn(t,["active","final"]),s=u.current+f,c=r.size();return i="final"===a?en(e,o)(t,n):null,new cn(s,c,"final"===a,i)}),v);return g.headers=p,g.body=d.uploadData(),g.progressCallback=s||null,g.errorHandler=rn(t),g}(t.location_,t.service_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(d){return t.error_=d,void t.transition_(Te)}var a=t.service_.makeRequest(o,i);t.request_=a,a.getPromise().then((function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(_e)):t.completeTransitions_()}),t.errorHandler_)}))},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=an(t.service_,t.location_,t.mappings_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.transition_(_e)}),t.metadataErrorHandler_)}))},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=un(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Je(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",f="\r\n--"+s+"--",h=Ve.getBlob(c,r,f);if(null===h)throw ie();var l={name:u.fullPath},p=Ge(o),d=t.maxUploadRetryTime,v=new Ze(p,"POST",en(t,n),d);return v.urlParams=l,v.headers=a,v.body=h.uploadData(),v.errorHandler=rn(e),v}(t.service_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.service_.makeRequest(n,e);t.request_=r,r.getPromise().then((function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(_e)}),t.errorHandler_)}))},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case Ee:case be:this.state_=t,null!==this.request_&&this.request_.cancel();break;case me:var e=this.state_===we;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case we:this.state_=t,this.notifyObservers_();break;case Ie:this.error_=re(),this.state_=t,this.notifyObservers_();break;case Te:case _e:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case be:this.transition_(we);break;case Ee:this.transition_(Ie);break;case me:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=xe(this.state_);return new ln(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i="Expected a function or an Object with one of `next`, `error`, `complete` properties.",o=wn(!0).validator,a=bn(null,!0).validator;function s(t){try{return void o(t)}catch(d){}try{if(a(t),!(ke(t.next)||ke(t.error)||ke(t.complete)))throw"";return}catch(d){throw i}}pn("on",[vn((function(){if(t!==ye.STATE_CHANGED)throw"Expected one of the event types: ["+ye.STATE_CHANGED+"]."})),bn(s,!0),wn(!0),wn(!0)],arguments);var u=this;function c(t){return function(e,n,i){null!==t&&pn("on",t,arguments);var o=new hn(e,n,r);return u.addObserver_(o),function(){u.removeObserver_(o)}}}var f=[bn((function(t){if(null===t)throw i;s(t)})),wn(!0),wn(!0)];return ke(e)||ke(n)||ke(r)?c(null)(e,n,r):c(f)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach((function(e){t.notifyObserver_(e)}))},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(xe(this.state_)){case Ae.SUCCESS:_n(this.resolve_.bind(null,this.snapshot))();break;case Ae.CANCELED:case Ae.ERROR:_n(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(xe(this.state_)){case Ae.RUNNING:case Ae.PAUSED:t.next&&_n(t.next.bind(t,this.snapshot))();break;case Ae.SUCCESS:t.complete&&_n(t.complete.bind(t))();break;case Ae.CANCELED:case Ae.ERROR:t.error&&_n(t.error.bind(t,this.error_))();break;default:t.error&&_n(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){pn("resume",[],arguments);var t=this.state_===we||this.state_===be;return t&&this.transition_(me),t},t.prototype.pause=function(){pn("pause",[],arguments);var t=this.state_===me;return t&&this.transition_(be),t},t.prototype.cancel=function(){pn("cancel",[],arguments);var t=this.state_===me||this.state_===be;return t&&this.transition_(Ee),t},t}(),In=function(){function t(t,e){this.service=t,this.location=e instanceof Be?e:Be.makeFromUrl(e)}return t.prototype.toString=function(){return pn("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return function(){if(Xe)return Xe;var t=[];t.push(new Ke("bucket")),t.push(new Ke("generation")),t.push(new Ke("metageneration")),t.push(new Ke("name","fullPath",!0));var e=new Ke("name");e.xform=function(t,e){return function(t){return!Re(t)||t.length<2?t:ze(t)}(e)},t.push(e);var n=new Ke("size");return n.xform=function(t,e){return Se(e)?Number(e):e},t.push(n),t.push(new Ke("timeCreated")),t.push(new Ke("updated")),t.push(new Ke("md5Hash",null,!0)),t.push(new Ke("cacheControl",null,!0)),t.push(new Ke("contentDisposition",null,!0)),t.push(new Ke("contentEncoding",null,!0)),t.push(new Ke("contentLanguage",null,!0)),t.push(new Ke("contentType",null,!0)),t.push(new Ke("metadata","customMetadata",!0)),Xe=t}()},t.prototype.child=function(t){pn("child",[vn()],arguments);var e=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new Be(this.location.bucket,e);return this.newRef(this.service,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new Be(this.location.bucket,t);return this.newRef(this.service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new Be(this.location.bucket,"");return this.newRef(this.service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return ze(this.location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.service},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),pn("put",[gn(),yn(!0)],arguments),this.throwIfRoot_("put"),new En(this,this.service,this.location,this.mappings(),new Ve(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=ce.RAW),pn("putString",[vn(),vn(fe,!0),yn(!0)],arguments),this.throwIfRoot_("putString");var r=le(e,t),i=Object.assign({},n);return!Se(i.contentType)&&Se(r.contentType)&&(i.contentType=r.contentType),new En(this,this.service,this.location,this.mappings(),new Ve(r.data,!0),i)},t.prototype.delete=function(){var t=this;return pn("delete",[],arguments),this.throwIfRoot_("delete"),this.service.getAuthToken().then((function(e){var n=function(t,e){var n=Ge(e.fullServerUrl()),r=t.maxOperationRetryTime,i=new Ze(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=on(e),i}(t.service,t.location);return t.service.makeRequest(n,e).getPromise()}))},t.prototype.listAll=function(){pn("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))},t.prototype.listAllHelper=function(t,e){return F.__awaiter(this,void 0,void 0,(function(){var n,r,i,o;return F.__generator(this,(function(a){switch(a.label){case 0:return n={pageToken:e},[4,this.list(n)];case 1:return r=a.sent(),(i=t.prefixes).push.apply(i,r.prefixes),(o=t.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,this.listAllHelper(t,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))},t.prototype.list=function(t){var e;pn("list",[(e=!0,new dn($e,e))],arguments);var n=this;return this.service.getAuthToken().then((function(e){var r=t||{},i=sn(n.service,n.location,"/",r.pageToken,r.maxResults);return n.service.makeRequest(i,e).getPromise()}))},t.prototype.getMetadata=function(){var t=this;return pn("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.service.getAuthToken().then((function(e){var n=an(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise()}))},t.prototype.updateMetadata=function(t){var e=this;return pn("updateMetadata",[yn()],arguments),this.throwIfRoot_("updateMetadata"),this.service.getAuthToken().then((function(n){var r=function(t,e,n,r){var i=Ge(e.fullServerUrl()),o=Je(n,r),a=t.maxOperationRetryTime,s=new Ze(i,"PATCH",en(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=on(e),s}(e.service,e.location,t,e.mappings());return e.service.makeRequest(r,n).getPromise()}))},t.prototype.getDownloadURL=function(){var t=this;return pn("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.service.getAuthToken().then((function(e){var n=function(t,e,n){var r=Ge(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Ze(r,"GET",nn(t,n),i);return o.errorHandler=on(e),o}(t.service,t.location,t.mappings());return t.service.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new Mt(Xt,"The given file does not have any download URLs.");return t}))}))},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new Mt($t,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Tn=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),An=function(){function t(t,e,n,r,i,o,a,s,u,c,f){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=f,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());ke(s)?i(s):i()}catch(d){o(d)}else null!==a?((r=ne()).setServerResponseProp(a.getResponseText()),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?ae():re()):o(r=new Mt(qt,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new xn(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function f(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new xn(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===ve.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new xn(a,n))}else{var s=n.getErrorCode()===ve.ABORT;e(!1,new xn(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}(l,u())}),e)}function l(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];c||(t||u()||a?f.call.apply(f,F.__spreadArrays([null,t],n)):(i<64&&(i*=2),1===s?(s=2,e=0):e=1e3*(i+Math.random()),h(e)))}var p=!1;function d(t){p||(p=!0,c||(null!==o?(t||(s=2),clearTimeout(o),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,d(!0)}),r),d}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),xn=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};var Sn=function(){function t(e,n,r,i){var o;this.bucket_=null,this.appId_=null,this.deleted_=!1,this.app_=e,this.authProvider_=n,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e5,this.requests_=new Set,this.pool_=r,this.bucket_=null!=i?Be.makeFromBucketSpec(i):t.extractBucket_(null===(o=this.app_)||void 0===o?void 0:o.options),this.internals_=new kn(this)}return t.extractBucket_=function(t){var e=null==t?void 0:t.storageBucket;return null==e?null:Be.makeFromBucketSpec(e)},t.prototype.getAuthToken=function(){return F.__awaiter(this,void 0,void 0,(function(){var t,e;return F.__generator(this,(function(n){switch(n.label){case 0:return(t=this.authProvider_.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requests_.forEach((function(t){return t.cancel()})),this.requests_.clear()},t.prototype.makeStorageReference=function(t){return new In(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this.deleted_)return new Tn(ae());var r=function(t,e,n,r){var i=He(t.urlParams),o=t.url+i,a=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(a,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(a,n),function(t){var e=void 0!==Pt.default?Pt.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(a),new An(o,t.method,a,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this.appId_,e,this.pool_);return this.requests_.add(r),r.getPromise().then((function(){return n.requests_.delete(r)}),(function(){return n.requests_.delete(r)})),r},t.prototype.ref=function(t){if(pn("ref",[vn((function(t){if("string"!=typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}),!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new In(this,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return pn("refFromURL",[vn((function(t){if("string"!=typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{Be.makeFromUrl(t)}catch(d){throw"Expected valid full URL but got an invalid one."}}),!1)],arguments),new In(this,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.maxUploadRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){pn("setMaxUploadRetryTime",[mn()],arguments),this.maxUploadRetryTime_=t},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.maxOperationRetryTime_},enumerable:!1,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){pn("setMaxOperationRetryTime",[mn()],arguments),this.maxOperationRetryTime_=t},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!1,configurable:!0}),t}(),kn=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.deleteApp(),Promise.resolve()},t}();function On(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new Sn(n,r,new Ue,e)}function Nn(t){var e={TaskState:Ae,TaskEvent:ye,StringFormat:ce,Storage:Sn,Reference:In};t.INTERNAL.registerComponent(new B.Component("storage",On,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.3.43")}Nn(Pt.default),Dt.registerStorage=Nn;var Ln={};dt.initializeApp({apiKey:"AIzaSyCAkGTaD3O0NgAFJ892lgFFYTu57zOkGPM",authDomain:"babelgallery-lab.firebaseapp.com",databaseURL:"https://babelgallery-lab-default-rtdb.europe-west1.firebasedatabase.app",projectId:"babelgallery-lab",storageBucket:"babelgallery-lab.appspot.com",messagingSenderId:"311401082382",appId:"1:311401082382:web:d465a89bf8494fc7a3165f"});var Rn=dt.auth(),Dn=dt.firestore();dt.storage();Rn.setPersistence(dt.auth.Auth.Persistence.SESSION).then((function(){console.log("Persistance de session configur\xe9e.")})).catch((function(t){console.error("Erreur de configuration de la persistance :",t)})),Ln={auth:Rn,db:Dn};var Cn,Pn,Mn=u(h),jn=u(l),Un=(Ln.auth,Ln.db),Fn=function(){var t=(0,jn.default)(Mn.default.mark((function t(e){var n,r;return Mn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],console.log("Tentative de r\xe9cup\xe9ration des images pour l'utilisateur ID: ".concat(e)),t.prev=2,t.next=5,Un.collection("images").where("userId","==",e).get();case 5:r=t.sent,console.log("Nombre d'images r\xe9cup\xe9r\xe9es: ".concat(r.size)),r.forEach((function(t){var e=t.data();console.log("Image trouv\xe9e: ID ".concat(t.id,", URL ").concat(e.imageUrl)),n.push({id:t.id,imageUrl:e.imageUrl,description:e.description,userId:e.userId,createdAt:e.createdAt})})),0===n.length?console.log("Aucune image trouv\xe9e pour cet utilisateur."):console.log("".concat(n.length," image(s) r\xe9cup\xe9r\xe9e(s) pour l'utilisateur.")),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error("Erreur lors de la r\xe9cup\xe9ration des images:",t.t0);case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),Vn={fetchList:(Pn=(0,jn.default)(Mn.default.mark((function t(e){return Mn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fn(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(t){return Pn.apply(this,arguments)}),fetchImage:(Cn=(0,jn.default)(Mn.default.mark((function t(e){return Mn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.warn("fetchImage n'est pas utilis\xe9 dans cette impl\xe9mentation."),t.abrupt("return",null);case 2:case"end":return t.stop()}}),t)}))),function(t){return Cn.apply(this,arguments)})},Bn=u(h),qn=u(l),zn=u(P);function Gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Hn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gn(Object(n),!0).forEach((function(e){(0,zn.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wn,Kn=[{title:"Bonnard_AI (26)",file:"Bonnard_AI (26).png"}].map((function(t,e){return Hn(Hn({},t),{},{image_id:e})})),Xn=(function(){var t=(0,qn.default)(Bn.default.mark((function t(e,n){return Bn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Kn.slice(e,e+n));case 1:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,qn.default)(Bn.default.mark((function t(e,n){var r,i;return Bn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="images/"+e.file,t.next=3,fetch(r).then((function(t){return t.blob()}));case 3:return i=t.sent,t.abrupt("return",{title:e.title,image:i});case 5:case"end":return t.stop()}}),t)})))}(),{artic:Vn}),Yn=u(h),Jn=u(l),Qn=document.createElement("canvas"),$n=Qn.width=Qn.height=1024,Zn=Qn.getContext("2d");function tr(){return(tr=(0,Jn.default)(Yn.default.mark((function t(){var e;return Yn.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new FontFace("CalSans","url(fonts/CalSans-SemiBold.ttf)"),t.next=3,e.load();case 3:document.fonts.add(e),Zn.font="22px 'CalSans', sans-serif";case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function er(t){return t.replace(/^[^:]*:\s*/,"")}!function(){tr.apply(this,arguments)}(),Zn.mozImageSmoothingEnabled=!1,Zn.webkitImageSmoothingEnabled=!1,Zn.textBaseline="bottom",Zn.fillStyle="#aaa",Wn={init:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$n,r=[];!function(t,e,n,r){var i=e.replace(/\*\*/g,""),o=i.indexOf("Description");-1!==o&&(i=i.substring(0,o).trim());var a=i.split(/\s(?=\w+\s?:)/).map((function(t){return t.trim()})),s=0;a.forEach((function(e){var i=t.measureText(e).width;if(i>n){var o="";if(e.split(" ").forEach((function(e){var i=o+(o?" ":"")+e;t.measureText(i).width>n&&o?(o=er(o),r.push(o),o=e):o=i})),o){o=er(o),r.push(o);var a=t.measureText(o).width;a>s&&(s=a)}}else e=er(e),r.push(e),i>s&&(s=i)}))}(Zn,e,Math.min(n*$n,$n),r),Zn.clearRect(0,0,Qn.width,Qn.height);for(var i=0;i<r.length;i++)Zn.fillText(r[i],0,Qn.height-22*(Math.max(r.length,3)-i));return t({data:Qn,min:"mipmap",mipmap:"nice",flipY:!0})},draw:function(t){return t({frag:"\n            precision mediump float;\n            uniform sampler2D tex;\n            varying vec2 uv;\n        \n            void main () {\n                float c = texture2D(tex, uv).r;\n                gl_FragColor = vec4(0,0,0, c);\n            }",vert:"\n            precision highp float;\n            uniform mat4 proj, view, model;\n            uniform float yScale;\n            attribute vec2 pos;\n            varying vec2 uv;\n            void main () {\n                uv = pos;\n                vec4 mpos = model * vec4(pos, 0.001, 1);\n                mpos.y *= yScale;\n                gl_Position = proj * view * mpos;\n            }",attributes:{pos:[0,0,1,0,0,1,1,1,0,1,1,0]},uniforms:{model:t.prop("textmodel"),tex:t.prop("text")},count:6,blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"one minus src alpha",dstRGB:"one minus src alpha",dstAlpha:1},color:[0,0,0,0]}})}};var nr=u(h),rr=u(I),ir=u(P),or=u(l);function ar(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function sr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ar(Object(n),!0).forEach((function(e){(0,ir.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ur(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return cr(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cr(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var fr=Ln.auth,hr={},lr=[],pr=document.createElement("canvas");pr.width=pr.height=2048;var dr=pr.getContext("2d");dr.mozImageSmoothingEnabled=!1,dr.webkitImageSmoothingEnabled=!1;var vr=!1,gr=function(t){return[(lr.pop()||t.texture)([[[200,200,200]]]),function(e){return(lr.pop()||t.texture)([[[0,0,0,0]]])},1]};function yr(t,e){return mr.apply(this,arguments)}function mr(){return(mr=(0,or.default)(nr.default.mark((function t(e,n){var r,i,o,a;return nr.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!1===vr&&(vr=e.hasExtension("EXT_texture_filter_anisotropic")?e._gl.getParameter(e._gl.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0),t.prev=1,(r=new Image).crossOrigin="anonymous",i=new Promise((function(t,e){r.onload=function(){return t(r)},r.onerror=function(t){console.error("Erreur lors du chargement de l'image:",t),e(new Error("Erreur de chargement de l'image"))}})),console.log("Tentative de chargement de l'image:",n.imageUrl),r.src=n.imageUrl,t.next=9,i;case 9:if(o=t.sent,console.log("Image charg\xe9e avec succ\xe8s, dimensions:",o.width,"x",o.height),0!==o.width&&0!==o.height){t.next=13;break}throw new Error("Image invalide - dimensions nulles");case 13:if(dr.clearRect(0,0,pr.width,pr.height),dr.drawImage(o,0,0,pr.width,pr.height),a=(lr.pop()||e.texture)({data:pr,min:"mipmap",mipmap:"nice",aniso:vr,flipY:!0,premultiplyAlpha:!0})){t.next=18;break}throw new Error("\xc9chec de cr\xe9ation de la texture");case 18:return console.log("Texture cr\xe9\xe9e avec succ\xe8s"),t.abrupt("return",[a,function(t){return Wn.init(lr.pop()||e.texture,n.description||"",t)},o.width/o.height]);case 22:return t.prev=22,t.t0=t.catch(1),console.error("Erreur d\xe9taill\xe9e lors du chargement de l'image:",{url:n.imageUrl,error:t.t0.message,stack:t.t0.stack}),t.abrupt("return",gr(e));case 26:case"end":return t.stop()}}),t,null,[[1,22]])})))).apply(this,arguments)}function br(t,e){return wr.apply(this,arguments)}function wr(){return(wr=(0,or.default)(nr.default.mark((function t(e,n){var r,i,o;return nr.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(r=fr.currentUser)){t.next=11;break}return t.next=5,r.getIdToken(!0);case 5:return i=t.sent,(o=new URL(e)).searchParams.delete("token"),o.searchParams.set("alt","media"),o.searchParams.set("token",i),t.abrupt("return",o.toString());case 11:return t.abrupt("return",e);case 14:return t.prev=14,t.t0=t.catch(0),console.error("Erreur lors du rafra\xeechissement de l'URL:",t.t0),t.abrupt("return",e);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))).apply(this,arguments)}var _r,Er={fetch:(_r=(0,or.default)(nr.default.mark((function t(e,n,r){var i,o,a,s,u,c,f,h,l,p,d,v,g,y;return nr.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=fr.currentUser){t.next=5;break}return console.error("Aucun utilisateur connect\xe9"),r(),t.abrupt("return");case 5:return t.prev=5,console.log("D\xe9but de la r\xe9cup\xe9ration de la liste"),t.next=9,Xn.artic.fetchList(i.uid);case 9:if(o=t.sent,a=o.length,console.log("".concat(a," peintures trouv\xe9es")),0!==a){t.next=16;break}return console.log("Aucune peinture \xe0 afficher"),r(),t.abrupt("return");case 16:s=a,u=[],c=ur(o),t.prev=19,c.s();case 21:if((f=c.n()).done){t.next=60;break}if(h=f.value,t.prev=23,h.id&&h.imageUrl){t.next=26;break}throw new Error("Donn\xe9es de peinture invalides: id=".concat(h.id,", url=").concat(h.imageUrl));case 26:if(!hr[h.id]){t.next=31;break}return console.log("Utilisation du cache pour ".concat(h.id)),n(sr(sr({},h),{},{tex:hr[h.id].tex})),0==--s&&r(),t.abrupt("continue",58);case 31:return t.next=33,br(h.imageUrl,i.uid);case 33:if(l=t.sent){t.next=36;break}throw new Error("URL invalide pour ".concat(h.id));case 36:return console.log("Chargement de l'image ".concat(h.id," depuis ").concat(l)),t.next=39,yr(e,sr(sr({},h),{},{imageUrl:l}));case 39:if(p=t.sent,d=(0,rr.default)(p,3),v=d[0],g=d[1],y=d[2],v){t.next=46;break}throw new Error("Texture non cr\xe9\xe9e pour ".concat(h.id));case 46:hr[h.id]={tex:v},console.log("Image ".concat(h.id," charg\xe9e avec succ\xe8s")),n(sr(sr({},h),{},{tex:v,textGen:g,aspect:y})),t.next=55;break;case 51:t.prev=51,t.t0=t.catch(23),console.error("Erreur pour l'image ".concat(h.id,":"),t.t0),u.push({id:h.id,error:t.t0.message});case 55:return t.prev=55,0==--s&&(u.length>0&&console.warn("Erreurs de chargement:",u),r()),t.finish(55);case 58:t.next=21;break;case 60:t.next=65;break;case 62:t.prev=62,t.t1=t.catch(19),c.e(t.t1);case 65:return t.prev=65,c.f(),t.finish(65);case 68:t.next=74;break;case 70:t.prev=70,t.t2=t.catch(5),console.error("Erreur globale:",t.t2),r();case 74:case"end":return t.stop()}}),t,null,[[5,70],[19,62,65,68],[23,51,55,58]])}))),function(t,e,n){return _r.apply(this,arguments)}),load:function(t,e){e.tex||e.loading||(e.loading=!0,yr(t,e).then((function(t){var n=(0,rr.default)(t,2),r=n[0],i=n[1];e.loading=!1,e.tex=r,e.text=i(e.width)})))},unload:function(t){t.tex&&(lr.push(t.tex),t.tex=void 0),t.text&&(lr.push(t.text),t.text=void 0)}},Ir=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Tr=Ir,Ar=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],h=e[9],l=e[10],p=e[11],d=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,w=n*c-o*a,_=r*u-i*s,E=r*c-o*s,I=i*c-o*u,T=f*v-h*d,A=f*g-l*d,x=f*y-p*d,S=h*g-l*v,k=h*y-p*v,O=l*y-p*g,N=m*O-b*k+w*S+_*x-E*A+I*T;return N?(N=1/N,t[0]=(s*O-u*k+c*S)*N,t[1]=(i*k-r*O-o*S)*N,t[2]=(v*I-g*E+y*_)*N,t[3]=(l*E-h*I-p*_)*N,t[4]=(u*x-a*O-c*A)*N,t[5]=(n*O-i*x+o*A)*N,t[6]=(g*w-d*I-y*b)*N,t[7]=(f*I-l*w+p*b)*N,t[8]=(a*k-s*x+c*T)*N,t[9]=(r*x-n*k-o*T)*N,t[10]=(d*E-v*w+y*m)*N,t[11]=(h*w-f*E-p*m)*N,t[12]=(s*A-a*S-u*T)*N,t[13]=(n*S-r*A+i*T)*N,t[14]=(v*b-d*_-g*m)*N,t[15]=(f*_-h*b+l*m)*N,t):null},xr=function(t,e,n){var r,i,o,a,s,u,c,f,h,l,p,d,v=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],f=e[7],h=e[8],l=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=f,t[8]=h,t[9]=l,t[10]=p,t[11]=d,t[12]=r*v+s*g+h*y+e[12],t[13]=i*v+u*g+l*y+e[13],t[14]=o*v+c*g+p*y+e[14],t[15]=a*v+f*g+d*y+e[15]),t},Sr=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},kr=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],h=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+f*r,t[6]=s*i+h*r,t[7]=u*i+l*r,t[8]=c*i-o*r,t[9]=f*i-a*r,t[10]=h*i-s*r,t[11]=l*i-u*r,t},Or=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],f=e[9],h=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-f*r,t[2]=s*i-h*r,t[3]=u*i-l*r,t[8]=o*r+c*i,t[9]=a*r+f*i,t[10]=s*r+h*i,t[11]=u*r+l*i,t},Nr=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Lr=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},Rr=u(h),Dr=u(l),Cr=u(P);function Pr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pr(Object(n),!0).forEach((function(e){(0,Cr.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var jr,Ur,Fr=Ln.auth,Vr=Math.PI/32,Br="high",qr=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},zr=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},Gr=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},Hr=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},Wr=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},Kr=((Ur=new Float32Array(3))[0]=0,Ur[1]=0,Ur[2]=0,{copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},sub:qr,scale:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},dist:zr,len:Gr,normalize:Hr,dot:Wr,transformMat4:function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},rotateX:function(t,e,n,r){var i=n[1],o=n[2],a=e[1]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=e[0],t[1]=i+a*c-s*u,t[2]=o+a*u+s*c,t},rotateY:function(t,e,n,r){var i=n[0],o=n[2],a=e[0]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=i+s*u+a*c,t[1]=e[1],t[2]=o+s*c-a*u,t}}),Xr={},Yr=Object.create||function(t){var e=function(){};return e.prototype=t,new e},Jr=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},Qr=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function $r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=Yr(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}Xr=$r,$r.EventEmitter=$r,$r.prototype._events=void 0,$r.prototype._maxListeners=void 0;var Zr,ti=10;try{var ei={};Object.defineProperty&&Object.defineProperty(ei,"x",{value:0}),Zr=0===ei.x}catch(Lo){Zr=!1}function ni(t){return void 0===t._maxListeners?$r.defaultMaxListeners:t._maxListeners}function ri(t,e,n,r){var i,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=t._events)?(o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]):(o=t._events=Yr(null),t._eventsCount=0),a){if("function"==typeof a?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(i=ni(t))&&i>0&&a.length>i){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else a=o[e]=n,++t._eventsCount;return t}function ii(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function oi(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=Qr.call(ii,r);return i.listener=n,r.wrapFn=i,i}function ai(t,e,n){var r=t._events;if(!r)return[];var i=r[e];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):ui(i,i.length):[]}function si(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function ui(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Zr?Object.defineProperty($r,"defaultMaxListeners",{enumerable:!0,get:function(){return ti},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');ti=t}}):$r.defaultMaxListeners=ti,$r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},$r.prototype.getMaxListeners=function(){return ni(this)},$r.prototype.emit=function(t){var e,n,r,i,o,a,s="error"===t;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var u=new Error('Unhandled "error" event. ('+e+")");throw u.context=e,u}if(!(n=a[t]))return!1;var c="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=ui(t,r),o=0;o<r;++o)i[o].call(n)}(n,c,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=ui(t,i),a=0;a<i;++a)o[a].call(n,r)}(n,c,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,a=ui(t,o),s=0;s<o;++s)a[s].call(n,r,i)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var a=t.length,s=ui(t,a),u=0;u<a;++u)s[u].call(n,r,i,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=ui(t,i),a=0;a<i;++a)o[a].apply(n,r)}(n,c,this,i)}return!0},$r.prototype.addListener=function(t,e){return ri(this,t,e,!1)},$r.prototype.on=$r.prototype.addListener,$r.prototype.prependListener=function(t,e){return ri(this,t,e,!0)},$r.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,oi(this,t,e)),this},$r.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,oi(this,t,e)),this},$r.prototype.removeListener=function(t,e){var n,r,i,o,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Yr(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),r.removeListener&&this.emit("removeListener",t,a||e)}return this},$r.prototype.removeAllListeners=function(t){var e,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=Yr(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=Yr(null):delete n[t]),this;if(0===arguments.length){var i,o=Jr(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Yr(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},$r.prototype.listeners=function(t){return ai(this,t,!0)},$r.prototype.rawListeners=function(t){return ai(this,t,!1)},$r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):si.call(t,e)},$r.prototype.listenerCount=si,$r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ci={};ci="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}};var fi={};(function(t){(function(){"use strict";fi=void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?{nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick((function(){e.apply(null,o)}))}}}:t}).call(this)}).call(this,bt);for(var hi={}.toString,li=Array.isArray||function(t){return"[object Array]"==hi.call(t)},pi=Xr.EventEmitter,di={toByteArray:function(t){var e,n,r=_i(t),i=r[0],o=r[1],a=new yi(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),s=0,u=o>0?i-4:i;for(n=0;n<u;n+=4)e=gi[t.charCodeAt(n)]<<18|gi[t.charCodeAt(n+1)]<<12|gi[t.charCodeAt(n+2)]<<6|gi[t.charCodeAt(n+3)],a[s++]=e>>16&255,a[s++]=e>>8&255,a[s++]=255&e;return 2===o&&(e=gi[t.charCodeAt(n)]<<2|gi[t.charCodeAt(n+1)]>>4,a[s++]=255&e),1===o&&(e=gi[t.charCodeAt(n)]<<10|gi[t.charCodeAt(n+1)]<<4|gi[t.charCodeAt(n+2)]>>2,a[s++]=e>>8&255,a[s++]=255&e),a},fromByteArray:function(t){for(var e,n=t.length,r=n%3,i=[],o=0,a=n-r;o<a;o+=16383)i.push(Ei(t,o,o+16383>a?a:o+16383));return 1===r?(e=t[n-1],i.push(vi[e>>2]+vi[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(vi[e>>10]+vi[e>>4&63]+vi[e<<2&63]+"=")),i.join("")}},vi=[],gi=[],yi="undefined"!=typeof Uint8Array?Uint8Array:Array,mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bi=0,wi=mi.length;bi<wi;++bi)vi[bi]=mi[bi],gi[mi.charCodeAt(bi)]=bi;function _i(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function Ei(t,e,n){for(var r,i,o=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(vi[(i=r)>>18&63]+vi[i>>12&63]+vi[i>>6&63]+vi[63&i]);return o.join("")}gi["-".charCodeAt(0)]=62,gi["_".charCodeAt(0)]=63;var Ii={read:function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,f=-7,h=n?i-1:0,l=n?-1:1,p=t[e+h];for(h+=l,o=p&(1<<-f)-1,p>>=-f,f+=s;f>0;o=256*o+t[e+h],h+=l,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=r;f>0;a=256*a+t[e+h],h+=l,f-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},write:function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,f=(1<<c)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?l/u:l*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=f?(s=0,a=f):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*v}},Ti={},Ai=s({}),xi=Ai.Buffer;function Si(t,e){for(var n in t)e[n]=t[n]}function ki(t,e,n){return xi(t,e,n)}function Oi(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}xi.from&&xi.alloc&&xi.allocUnsafe&&xi.allocUnsafeSlow?Ti=Ai:(Si(Ai,Ti),Ti.Buffer=ki),Si(xi,ki),ki.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return xi(t,e,n)},ki.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=xi(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},ki.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return xi(t)},ki.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return Ai.SlowBuffer(t)};var Ni={};(function(t){(function(){function e(t){return Object.prototype.toString.call(t)}Ni.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===e(t)},Ni.isBoolean=function(t){return"boolean"==typeof t},Ni.isNull=function(t){return null===t},Ni.isNullOrUndefined=function(t){return null==t},Ni.isNumber=function(t){return"number"==typeof t},Ni.isString=function(t){return"string"==typeof t},Ni.isSymbol=function(t){return"symbol"==typeof t},Ni.isUndefined=function(t){return void 0===t},Ni.isRegExp=function(t){return"[object RegExp]"===e(t)},Ni.isObject=function(t){return"object"==typeof t&&null!==t},Ni.isDate=function(t){return"[object Date]"===e(t)},Ni.isError=function(t){return"[object Error]"===e(t)||t instanceof Error},Ni.isFunction=function(t){return"function"==typeof t},Ni.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},Ni.isBuffer=t.isBuffer}).call(this)}).call(this,{isBuffer:function(t){return null!=t&&(Oi(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Oi(t.slice(0,0))}(t)||!!t._isBuffer)}});var Li={},Ri={},Di=Ti.Buffer;function Ci(t,e){t.emit("error",e)}Ri=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return Di.alloc(0);for(var e,n,r=Di.allocUnsafe(t>>>0),i=this.head,o=0;i;)e=r,n=o,i.data.copy(e,n),o+=i.data.length,i=i.next;return r},t}(),Li&&Li.inspect&&Li.inspect.custom&&(Ri.prototype[Li.inspect.custom]=function(){var t=Li.inspect({length:this.length});return this.constructor.name+" "+t});var Pi={destroy:function(t,e){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,fi.nextTick(Ci,this,t)):fi.nextTick(Ci,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted||(n._writableState.errorEmitted=!0,fi.nextTick(Ci,n,t)):fi.nextTick(Ci,n,t):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},Mi={};(function(t){(function(){function e(e){try{if(!t.localStorage)return!1}catch(r){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}Mi=function(t,n){if(e("noDeprecation"))return t;var r=!1;return function(){if(!r){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),r=!0}return t.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ji=Bi,Ui=i({}),Fi=Object.create(Ni);function Vi(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Bi(t){if(!(this instanceof Bi))return new Bi(t);Ui.call(this,t),this._transformState={afterTransform:Vi.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",qi)}function qi(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){zi(t,e,n)})):zi(this,null,null)}function zi(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}Fi.inherits=ci,Fi.inherits(Bi,Ui),Bi.prototype.push=function(t,e){return this._transformState.needTransform=!1,Ui.prototype.push.call(this,t,e)},Bi.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},Bi.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Bi.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},Bi.prototype._destroy=function(t,e){var n=this;Ui.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))};var Gi=Wi,Hi=Object.create(Ni);function Wi(t){if(!(this instanceof Wi))return new Wi(t);ji.call(this,t)}Hi.inherits=ci,Hi.inherits(Wi,ji),Wi.prototype._transform=function(t,e,n){n(null,t)};var Ki={};(Ki=Ki=n({})).Stream=Ki,Ki.Readable=Ki,Ki.Writable=o({}),Ki.Duplex=i({}),Ki.Transform=ji,Ki.PassThrough=Gi;var Xi=o({}),Yi=i({}),Ji=Ki.Transform,Qi=Ki.PassThrough,$i=to,Zi=Xr.EventEmitter;function to(){Zi.call(this)}ci(to,Zi),to.Readable=Ki,to.Writable=Xi,to.Duplex=Yi,to.Transform=Ji,to.PassThrough=Qi,to.Stream=to,to.prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",s));var o=!1;function a(){o||(o=!0,t.end())}function s(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(c(),0===Zi.listenerCount(this,"error"))throw t}function c(){n.removeListener("data",r),t.removeListener("drain",i),n.removeListener("end",a),n.removeListener("close",s),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),t.removeListener("close",c)}return n.on("error",u),t.on("error",u),n.on("end",c),n.on("close",c),t.on("close",c),t.emit("pipe",n),t};var eo={};eo=io,io.available=function(){return!!oo(document.body)};var no=Xr.EventEmitter,ro=$i.Stream;function io(t){var e,n,r,i=t.addEventListener||t.attachEvent,o=t.removeEventListener||t.detachEvent,a=t.ownerDocument,s=a.body,u=oo(t),c={dx:0,dy:0,dt:0},f=new no,h=null,l=!1;i.call(t,"mousedown",g,!1),i.call(t,"mouseup",y,!1),i.call(s,"mousemove",_,!1);for(var p=["","webkit","moz","ms","o"],d=0,v=p.length;d<v;++d)i.call(a,p[d]+"pointerlockchange",m),i.call(a,p[d]+"pointerlockerror",b);return f.release=w,f.target=E,f.request=g,f.destroy=function(){o.call(t,"mouseup",y,!1),o.call(t,"mousedown",g,!1),o.call(t,"mousemove",_,!1)},oo||setTimeout((function(){f.emit("error",new Error("pointer lock is not supported"))}),0),f;function g(e){E()||(r=+new Date,u.call(t))}function y(t){l&&(f.emit("needs-fullscreen"),l=!1)}function m(t){E()?((h=new ro).readable=!0,h.initial={x:e,y:n,t:Date.now()},f.emit("attain",h)):h&&w()}function b(t){+new Date-r<100?l=!0:(f.emit("error"),h&&h.emit("error",t),h=null)}function w(){f.emit("release"),h&&(h.emit("end"),h.readable=!1,h.emit("close"),h=null),E()&&(a.exitPointerLock||a.mozExitPointerLock||a.webkitExitPointerLock||a.msExitPointerLock||a.oExitPointerLock).call(a)}function _(t){e=t.pageX,n=t.pageY,h&&(c.dx=t.movementX||t.webkitMovementX||t.mozMovementX||t.msMovementX||t.oMovementX||0,c.dy=t.movementY||t.webkitMovementY||t.mozMovementY||t.msMovementY||t.oMovementY||0,c.dt=Date.now()-h.initial.t,f.emit("data",c),h.emit("data",c))}function E(){return a.pointerLockElement||a.mozPointerLockElement||a.webkitPointerLockElement||a.msPointerLockElement||a.oPointerLockElement||null}}function oo(t){return t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock||t.msRequestPointerLock||t.oRequestPointerLock||null}var ao=u(I),so=u(S);function uo(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return co(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?co(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function co(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var fo=Math.PI/4,ho=Math.PI/6,lo=function(t,e,n,r,i){var o=Kr.sub(r,t,e),a=Kr.sub(i,n,e),s=Math.max(Math.min(Kr.dot(o,a)/Kr.dot(a,a),1),0);return Kr.dist(o,Kr.scale(a,a,s))},po=function(t,e,n){var r=-(Kr.dot(t,n)-n[3])/Kr.dot(e,n),i=Kr.scale([],e,r);return Kr.add(i,i,t),{dist:r,intersection:i}},vo=function(t,e,n){return(1-t)*e+t*n},go=u(h),yo=u(l),mo=!0,bo=function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},wo=function(){return bo(window.innerWidth/window.innerHeight,16/9,9/16,1.7,Math.PI/3)};navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)&&(mo=!1,wo=function(){return bo(window.innerWidth/window.innerHeight,16/9,9/16,1.5,Math.PI/3)});var _o,Eo,Io,To,Ao,xo,So=new v;So.showPanel(0),_o=y({extensions:["OES_element_index_uint","OES_standard_derivatives"],optionalExtensions:["EXT_texture_filter_anisotropic"],attributes:{alpha:!1}}),Eo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=e*Math.pow(2,t),a=L(t+1,n,r).map((function(t){return[t[0]*o,t[1]*o]}));console.time("gen mesh");var s=a.slice(0,-1).map((function(t,e){return[t,a[e+1]]})),u=s.map((function(t){var e=(0,k.default)(t,2),n=(0,k.default)(e[0],2),r=n[0],i=n[1],o=(0,k.default)(e[1],2),a=o[0],s=o[1];return[Math.sign(i-s),0,Math.sign(a-r)]})).flatMap((function(t){return Array(4).fill(t)})),c=s.flat().flatMap((function(t){var e=(0,k.default)(t,2),n=e[0],r=e[1];return[[n,0,r],[n,i,r]]})),f=D(s,t,e),h=f.getAreaIndex,l=f.getGridSegments,p=f.getGridParts,d=f.placements;u.push([0,-1,0],[0,-1,0],[0,-1,0],[0,-1,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0]),c.push([0,i,0],[0,i,o],[o,i,0],[o,i,o],[0,0,0],[o,0,0],[0,0,o],[o,0,o]);var v=Array(c.length/4).fill().flatMap((function(t,e){return[4*e,4*e+2,4*e+1,4*e+1,4*e+2,4*e+3]}));return console.timeEnd("gen mesh"),console.log(d.length+" available painting placements"),{placements:d,getAreaIndex:h,getGridSegments:l,getGridParts:p,position:c,normal:u,elements:v}}(),Io=function(t,e,n){var r=t.texture(),i=t.texture();return U(r,"res/wall.jpg"),U(i,"res/floor.jpg"),t({frag:"\n        precision lowp float;\n        varying vec3 v_pos, v_relativepos, v_normal;\n        uniform sampler2D wallTexture;\n        uniform sampler2D floorTexture;\n\n        vec3 hue2rgb(float h) {\n            vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n            vec3 p = abs(fract(vec3(h) + K.xyz) * 6.0 - K.www);\n            return mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), 0.08);\n        }\n\n        void main() {\n\t\t\tvec3 wallLight = texture2D(wallTexture, vec2(v_pos.x + v_pos.z, 10.0-v_pos.y)/12.0).rgb;\n\t\t\tfloat brightnessFactor = 1.3;\n\t\t\tvec3 totalLight = wallLight * brightnessFactor;\n\t\t\tfloat dist = length(v_relativepos);\n\t\t\tvec3 ceilingColor = vec3(0.85, 0.85, 0.85);\n\t\t\ttotalLight = mix(totalLight, ceilingColor, step(9.99, v_pos.y));\n\t\t\ttotalLight *= mix(0.7, 1.0, smoothstep(0.1, 0.12, v_pos.y));\n\t\t\ttotalLight *= abs(v_normal.x)/64.0 + 1.0;\n\t\t\tif(v_normal.y > 0.0) {\n\t\t\t\tvec3 floorLight = texture2D(floorTexture, v_pos.xz / 8.0).rgb;\n\t\t\t\tfloat lightingFactor = 1.0; \n\t\t\t\ttotalLight = floorLight * lightingFactor;\n\t\t\t}\n\t\t\ttotalLight *= (0.5 + 0.5*hue2rgb(0.5 + (v_pos.x + v_pos.z) / 160.0)); // Variation de couleur\n\t\t\tgl_FragColor = vec4(totalLight, 1.0);\n\t\t}",vert:"\n        precision highp float;\n        uniform mat4 proj, view;\n        attribute vec3 position, normal;\n        varying vec3 v_pos, v_relativepos, v_normal;\n        uniform float yScale;\n        void main() {\n            vec3 pos = position;\n            v_pos = pos;\n            v_relativepos = (view * vec4(pos, 1)).xyz;\n            pos.y *= yScale;\n            v_normal = normal;\n            gl_Position = proj * view * vec4(pos, 1);\n        }",attributes:{position:e.position,normal:e.normal},blend:n?{enable:!0,func:{src:"src alpha",dst:"one minus src alpha"}}:{},uniforms:{wallTexture:r,floorTexture:i},elements:new Uint32Array(e.elements)})}(_o,Eo,mo),To=function(t,e){var n,r=e.placements,i=e.getAreaIndex,o=[],a=[],s=!0,u=function(t){if(Fr.currentUser){console.log("D\xe9but loadPainting:");var e=r[o.length],n=[e[1][0]-e[0][0],e[1][1]-e[0][1]],i=[e[1][1]-e[0][1],e[0][0]-e[1][0]],a=Math.hypot(n[0],n[1]),s=4.5/(3+t.aspect);s=Math.min(s,a/t.aspect/2.2),s=Math.min(s,2/1.2);var u=[(e[0][0]+e[1][0])/2,2.1-s,(e[0][1]+e[1][1])/2];console.log("Position de la peinture:",u);var c=Math.atan2(n[1],n[0]),f=Math.abs(c%3)<1?1:0,h=1-f,l=s*t.aspect,p=[2*l*f+.1*h,2*s,2*l*h+.1*f],d=t.textGen(l),v=l/a,g=.005/Math.hypot(i[0],i[1]),y=[[u[0]-n[0]*v*2,u[2]-n[1]*v],[u[0]+n[0]*v*2,u[2]+n[1]*v]];u[0]-=n[0]*v+i[0]*g,u[2]-=n[1]*v+i[1]*g;var m=[];Nr(m,u),Sr(m,m,p),Or(m,m,-c);var b=[];Nr(b,[u[0],1.7-s,u[2]]),Sr(b,b,[2,2,2]),Or(b,b,-c),o.push(Mr(Mr({},t),{},{vseg:y,angle:c,model:m,textmodel:b,text:d,width:l,textGen:null})),console.log("Peinture ajout\xe9e au batch. Taille du batch:",o.length)}else console.error("Aucun utilisateur connect\xe9. Impossible de charger les peintures.")};return Fr.onAuthStateChanged((n=(0,Dr.default)(Rr.default.mark((function e(n){return Rr.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n?(console.log("Utilisateur connect\xe9 dans placement.js:",n.email),console.log("Appel de texture.fetch"),Er.fetch(t,u,(function(){s=!1,console.log("Tous les tableaux ont \xe9t\xe9 r\xe9cup\xe9r\xe9s dans placement.js")}))):console.log("Aucun utilisateur connect\xe9 dans placement.js.");case 1:case"end":return e.stop()}}),e)}))),function(t){return n.apply(this,arguments)})),console.log("Appel de texture.fetch"),Er.fetch(t,u,(function(){s=!1,console.log("Tous les tableaux ont \xe9t\xe9 r\xe9cup\xe9r\xe9s dans placement.js")})),{update:function(e,n,r){var c=i(e[0],e[2],4);-1!==c&&(o.slice(0,Math.max(0,c-40)).map((function(t){return Er.unload(t)})),o.slice(c+40).map((function(t){return Er.unload(t)})),(a=o.slice(Math.max(0,c-20),c+20)).map((function(e){return Er.load(t,e,Br)})),a=a.filter((function(t){return t.tex&&function(t,e,n,r){for(var i=r.vseg,o=r.angle,a=i[0][0]-t[0],s=i[0][1]-t[2],u=i[1][0]-t[0],c=i[1][1]-t[2],f=0,h=[o,e-n/2-Vr+Math.PI/2,e+n/2+Vr-Math.PI/2];f<h.length;f++){var l=h[f],p=Math.sin(l),d=-Math.cos(l);if(p*a+d*s<0&&p*u+d*c<0)return!1}return!0}(e,n,r,t)})),c<=o.length-20||(s||(Er.fetch(t,10,Br,u,(function(){return s=!1})),s=!0),Br="low",jr&&clearTimeout(jr),jr=setTimeout((function(){return Br="high"}),3e3)))},batch:function(){return a}}}(_o,Eo),Ao=function(t){var e=Wn.draw(t),n=t({frag:"\n\tprecision lowp float;\n\tuniform sampler2D tex;\n\tvarying vec3 uv;\n\n\t// http://madebyevan.com/shaders/fast-rounded-rectangle-shadows/\n\t// This approximates the error function, needed for the gaussian integral\n\tvec4 erf(vec4 x) {\n\t\tvec4 s = sign(x), a = abs(x);\n\t\tx = 1.0 + (0.278393 + (0.230389 + 0.078108 * (a * a)) * a) * a;\n\t\tx *= x;\n\t\treturn s - s / (x * x);\n\t}\n\n\t// Return the mask for the shadow of a box from lower to upper\n\tfloat boxShadow(vec2 lower, vec2 upper, vec2 point, float sigma) {\n\t\tvec4 query = vec4(point - lower, upper - point);\n\t\tvec4 integral = 0.5 + 0.5 * erf(query * (sqrt(0.5) / sigma));\n\t\treturn (integral.z - integral.x) * (integral.w - integral.y);\n\t}\n\n\tvoid main () {\n\t\tfloat frontMask = smoothstep(0.9, 1.0, uv.z);\n\t\tfloat paintingMask = step(0.001, uv.z);\n\t\tfloat shadowAlpha = boxShadow(vec2(.5), vec2(.7), abs(uv.xy-vec2(.5)), 0.02);\n\t\tfloat wrapping = 0.005 * sign(uv.x-.5) * (1.-uv.z);\n\t\tfloat sideShading = pow(uv.z/4.0, 0.1);\n\t\tvec3 col = texture2D(tex, uv.xy - vec2(wrapping, 0.)).rgb;\n\t\tcol *= mix(sideShading, 1., frontMask);\n\t\tgl_FragColor = mix(vec4(0.,0.,0.,shadowAlpha), vec4(col,1.), paintingMask);\n\t}",vert:"\n\tprecision highp float;\n\tuniform mat4 proj, view, model;\n\tuniform float yScale;\n\tattribute vec3 pos;\n\tvarying vec3 uv;\n\tvoid main () {\n\t\tuv = pos;\n\t\tvec4 mpos = model * vec4(pos, 1);\n\t\tmpos.y *= yScale;\n\t\tgl_Position = proj * view * mpos;\n\t}",attributes:{pos:[0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,1,0,0,0,1,0,1,1,0,-.1,-.1,0,1.1,-.1,0,-.1,1.1,0,1.1,1.1,0]},elements:[0,1,2,3,2,1,1,0,5,4,5,0,3,1,7,5,7,1,0,2,4,6,4,2,8,9,4,5,4,9,9,11,5,7,5,11,11,10,7,6,7,10,10,8,6,4,6,8],uniforms:{model:t.prop("model"),tex:t.prop("tex")},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"one minus src alpha",dstRGB:"one minus src alpha",dstAlpha:1},color:[0,0,0,0]}});return function(t){n(t),e(t)}}(_o),xo=function(t,e){var n=t.getGridSegments,r=t.getGridParts,i=[0,3*Math.PI/4],o=[0,3*Math.PI/4],a=[0,0,0],s=[2,2,2],u=[.707,0,.707],c=[0,1,0],f=[0,0,0],h=.5,l=Tr([]),p=Tr([]),d=!1,v=[0,0,0],g=[0,0,0],y=1,m=function(t,e,n){t=Math.max(Math.min(t,100),-100),e=Math.max(Math.min(e,100),-100);var r=1;Math.abs(i[0])>ho&&Math.sign(i[0])==Math.sign(e)&&(r=(fo-Math.abs(i[0]))/(fo-ho)),i[0]+=r*e*n,i[1]+=t*n},b=eo(document.body);b.on("attain",(function(t){t.on("data",(function(t){m(t.dx,t.dy,.002)}))}));var w=!1,_=!1,E=0,I=function(t){if(t.preventDefault(),b&&(b.destroy(),b=!1),"touchstart"===t.type)w=_=t.touches[0],E=t.timeStamp;else if("touchend"===t.type){var e=Math.hypot(w.pageX-_.pageX,w.pageY-_.pageY);if(t.timeStamp-E<300&&e<20){var i=[],o=[],a=[],u=[2*_.pageX/window.innerWidth-1,1-2*_.pageY/window.innerHeight,0];Kr.transformMat4(u,u,Ar(i,p)),Kr.transformMat4(u,u,Ar(i,l)),Kr.sub(u,u,s),Kr.normalize(u,u);var c=po(s,u,[0,1,0,0]),f=c.intersection,h=c.dist,d=po(s,u,[0,1,0,5]).dist,I=s[0],T=s[2],A=u[0],x=u[2];A/=Math.hypot(A,x),x/=Math.hypot(A,x);for(var S=n(I,T),k=0;k<10;k++)I+=4*A,T+=4*x,S=[].concat((0,so.default)(S),(0,so.default)(n(I,T)));console.log((0,so.default)(new Set(S)));var O=(0,so.default)(new Set(S)).map((function(t){var e=(0,ao.default)(t,2),n=e[0],r=e[1];return function(t,e,n,r){var i=n[0]-r[0],o=n[1]-r[1],a=-o,s=i,u=n[0]*a+n[1]*s,c=po(t,e,[a,0,s,u]),f=c.dist,h=c.intersection,l=n[0]*i+n[1]*o,p=r[0]*i+r[1]*o,d=h[0]*i+h[2]*o;return(d>l)+(d>p)!==1&&(f=1/0),{a:n,b:r,dist:f,intersection:h}}(s,u,n,r)})).filter((function(t){var e=t.dist;return e>0&&e<Math.max(h,d)&&e<40}));if(O.sort((function(t,e){return t.dist-e.dist})),0!==O.length){var N,L=(0,ao.default)(O[0].intersection,3),R=L[0],D=L[2],C=uo(r(R,D));try{for(C.s();!(N=C.n()).done;){var P=(0,ao.default)(N.value,2),M=P[0],j=P[1],U=(M[0]+j[0])/2,F=(M[1]+j[1])/2;if(Math.hypot(R-U,D-F)<1.3){R=U,D=F;break}}}catch(Lo){C.e(Lo)}finally{C.f()}Kr.copy(v,s),Kr.set(g,R,s[1],D)}else{if(!(h>0))return;Kr.copy(v,s),Kr.set(g,f[0],s[1],f[2])}var V=n(g[0],g[2]).map((function(t){var e=(0,ao.default)(t,2),n=(0,ao.default)(e[0],2),r=n[0],i=n[1],o=(0,ao.default)(e[1],2);return[[r,2,i],[o[0],2,o[1]]]})).map((function(t){var e=(0,ao.default)(t,2),n=e[0],r=e[1];return{a:n,b:r,dist:lo(g,n,r,o,a)}})).filter((function(t){return t.dist<3}));if(V.sort((function(t,e){return t.dist-e.dist})),0!==V.length){var B,q=uo(V);try{for(q.s();!(B=q.n()).done;){var z=B.value,G=z.a,H=z.b,W=3-lo(g,G,H,o,a);if(!(W<0)){var K=Kr.sub(o,H,G).reverse();K[0]=-K[0],Kr.normalize(K,K),Kr.scale(K,K,W),Kr.add(g,g,K)}}}catch(Lo){q.e(Lo)}finally{q.f()}}y=0}w=_=!1}else"touchmove"===t.type&&_&&(m(t.touches[0].pageX-_.pageX,t.touches[0].pageY-_.pageY,.008),_=t.touches[0])};window.addEventListener("touchstart",I,{passive:!1}),window.addEventListener("touchmove",I,{passive:!1}),window.addEventListener("touchend",I,{passive:!1});var T={},A=function(t){if(!(t.defaultPrevented||t.ctrlKey||t.altKey||t.metaKey)){T[t.code]="keydown"===t.type,d=t.shiftKey;var e=T.KeyA||T.ArrowLeft?1:0,n=T.KeyD||T.ArrowRight?1:0,r=T.KeyW||T.ArrowUp?1:0,i=T.KeyS||T.ArrowDown?1:0;a=[n-e,0,i-r],t.preventDefault()}};window.addEventListener("keydown",A),window.addEventListener("keyup",A);var x=0;return{pos:s,fmouse:o,forward:u,up:c,view:function(){return l},proj:function(){return Lr(p,e(),window.innerWidth/window.innerHeight,.1,100),p},tick:function(t){var e=t.time,r=e-x;x=e;var p=[0,0,0],m=[];Kr.set(u,1,0,0),Kr.set(c,0,1,0),Kr.rotateY(f,a,p,-i[1]),Kr.rotateY(u,u,p,-i[1]),Kr.rotateX(u,u,p,-i[0]),Kr.rotateX(c,c,p,-i[0]),Kr.normalize(f,f);var b=d?12:7;Kr.scale(f,f,b*r),s[1]=2;var w=Kr.add([],s,f),_=n(w[0],w[2]).map((function(t){var e=(0,ao.default)(t,2),n=(0,ao.default)(e[0],2),r=n[0],i=n[1],o=(0,ao.default)(e[1],2);return[[r,2,i],[o[0],2,o[1]]]})).filter((function(t){var e=(0,ao.default)(t,2),n=e[0],r=e[1];return lo(w,n,r,p,m)<.5}));if(0!==_.length){var E,I=uo(_);try{for(I.s();!(E=I.n()).done;){var T=(0,ao.default)(E.value,2),A=T[0],S=T[1],k=.5-lo(w,A,S,p,m),O=Kr.sub(p,S,A).reverse();O[0]=-O[0],Kr.normalize(O,O),Kr.scale(O,O,k),Kr.add(f,f,O)}}catch(Lo){I.e(Lo)}finally{I.f()}}var N,L=Kr.len(f);if(0===L&&.25!==h&&(.01+(h=.8*(Math.abs((h+.5)%1-.5)-.25)+.25))%.25<.02&&(h=.25),h+=L/(d?5:3.6),s[1]=2+.03*Math.cos(2*Math.PI*h),Kr.add(s,s,f),y<1){y+=r/1;var R=(N=y=Math.min(y,1))<.5?2*N*N:1-Math.pow(-2*N+2,2)/2;Kr.set(s,vo(R,v[0],g[0]),s[1],vo(R,v[2],g[2]))}o[0]=.95*i[0]+(1-.95)*o[0],o[1]=.95*i[1]+(1-.95)*o[1],Tr(l),kr(l,l,o[0]),Or(l,l,o[1]),xr(l,l,Kr.scale(p,s,-1))}}}(Eo,(function(){return 2*Math.atan(Math.tan(.5*wo())*window.innerHeight/window.innerWidth)}));var ko=_o({cull:{enable:!0,face:"back"},uniforms:{view:xo.view,proj:xo.proj,yScale:1}}),Oo=_o({cull:{enable:!0,face:"front"},uniforms:{yScale:-1}});Ln.auth.onAuthStateChanged(function(){var t=(0,yo.default)(go.default.mark((function t(e){return go.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e?console.log("Utilisateur connect\xe9:",e.email):console.log("Aucun utilisateur connect\xe9. Veuillez vous connecter.");case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),_o.frame((function(t){var e=t.time;So.begin(),xo.tick({time:e}),To.update(xo.pos,xo.fmouse[1],wo()),_o.clear({color:[0,0,0,1],depth:1}),ko((function(){mo&&Oo((function(){Io(),Ao(To.batch())})),Io(),Ao(To.batch())})),So.end()})),document.addEventListener("DOMContentLoaded",(function(){var t=e({}).handleLogin;console.log("handleLogin import\xe9:",t);var n=document.createElement("button");n.textContent="Se connecter avec Google",n.style.zIndex="1000",n.style.position="absolute",n.style.top="10px",n.style.right="10px",n.style.padding="10px 20px",n.style.fontSize="16px",n.style.cursor="pointer",n.style.backgroundColor="#4CAF50",n.style.color="white",n.addEventListener("click",t),n.addEventListener("touchstart",(function(e){e.preventDefault(),t()})),document.body.appendChild(n),console.log("Ajout du bouton de connexion")}))}();</script>
  </body>
</html>